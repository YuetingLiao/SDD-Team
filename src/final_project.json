[{"id":"c0a64af3.88a468","type":"subflow","name":"SDD Final Stage","info":"","category":"","in":[],"out":[],"env":[],"color":"#DDAA99"},{"id":"10cd7362.7a63ad","type":"comment","z":"c0a64af3.88a468","name":"Landin","info":"","x":70,"y":40,"wires":[]},{"id":"fde0213c.2f0bd","type":"http in","z":"c0a64af3.88a468","name":"","url":"/landin","method":"get","upload":false,"swaggerDoc":"","x":90,"y":320,"wires":[["1d950622.f016aa"]]},{"id":"fe1cb06c.54492","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":1210,"y":320,"wires":[]},{"id":"f28f65e2.f55b78","type":"template","z":"c0a64af3.88a468","name":"HTML","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<html>\n    <head>\n    <script src=\"http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js\"></script>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\">\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"/landin_template.css\">\n    </head>\n    <body>\n        <div class=\"landinMain\">\n            <div id=\"mainTitle\" class=\"header\">\n                <h2 style=\"font-size:50px;\" margin=\"center;\" >2Cool2Cook</h2>\n            </div>\n            <div class=\"topright\">\n                <a href=\"register\" class=\"accountBtn\" >Register</a> <br/>\n                <a href=\"login\" style=\"{{disp}}\" class=\"accountBtn\"> Login </a> <br/>\n                <a href=\"logout\" class=\"accountBtn\" >Logout</a>\n            </div>\n            \n            <div id=\"subTitle\" class=\"header\">\n                <a href=\"/menu\"class=\"titleBtn\">Menu</a>\n                <a href=\"/farmers_market\"class=\"titleBtn\">Farmers Market</a>\n                <a href=\"/user_profile\"class=\"titleBtn\">User Profile</a>\n            </div>\n\n        </div>\n        \n        \n        <input type =\"text\" id = \"recipeText\" placeholder=\"Search...\">\n        \n    \n        <button id=\"recipeBtn\" class=\"searchBtn\"  onclick=\"searchFunction()\"> Search </button>\n        <br/>\n    \n        <div style=\"width: max-content; margin: auto;\">\n        <table border = 1px id = \"table\" margin-left=\"100px;\">\n\t    </table>\n        </div>\n\n        <div style=\"display: auto;display: -webkit-inline-box;margin: auto;\">\n\t    <button onclick=\"prev()\" id=\"prev\" class=\"pageBtn\" >Prev</button>\n\t    <button onclick=\"next()\" id=\"next\" class=\"pageBtn\" >Next</button>\n        </div>\n\n\n    </body>\n</html>\n\n<script>\n    {{{payload.script}}}\n    var search_info = document.getElementById(\"recipeText\");\n    search_info.addEventListener(\"keyup\", function(event) {\n        if (event.keyCode === 13) {\n            event.preventDefault();\n            document.getElementById(\"recipeBtn\").click();\n        }\n        \n    });\n</script>","output":"str","x":1020,"y":320,"wires":[["fe1cb06c.54492"]]},{"id":"1d950622.f016aa","type":"function","z":"c0a64af3.88a468","name":"Load Cookies","func":"var a = Object.keys(msg.req.cookies);\nvar redirect = true;\nfor (var i in a) {\n  if(a[i] == \"id\"){\n      redirect = false;\n  }\n}\n\nvar select=\"SELECT * from recipes order by id asc\";\nmsg.topic = util.format(select);\n\nif(redirect){\n    //msg.headers = {};\n    //msg.headers.location = \"/login\";\n    //msg.statusCode = 302;\n    msg.name = msg.req.cookies.id;\n    msg.disp = \"\";\n    msg.disp1 = \"display:none\";\n}else{\n    //var b = global.get(msg.req.cookies.id);\n    msg.disp1 = \"display:none\";\n    msg.name = \" \" + msg.req.cookies.id;\n    if(msg.req.cookies.id == \"admin\"){\n        msg.disp1 = \"\";\n    }\n    msg.disp = \"display:none\";\n    //msg[\"personal_info\"] = b.personal_info;\n    //msg[\"letter\"] = \"\";\n    //msg.letter = msg.personal_info.first_name[0];\n    //msg.persona_image = global.get(msg.personal_info.first_name);\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":300,"y":320,"wires":[["642707d7.879c98"]]},{"id":"ad8ec685.7c16c8","type":"template","z":"c0a64af3.88a468","name":"Javascript","field":"payload.script","fieldType":"msg","format":"javascript","syntax":"mustache","template":"var title = \"{{title}}\".split(\",\");\nvar id = \"{{id}}\".split(\",\");\nvar obj = \"{{obj}}\".split(\",\");\nvar cur = 1;\nvar titleSSelected = [];\nvar idSelected = [];\nHTML = \"\";\n\nfor( i = 0; i < title.length; i++){\n    title[i] = title[i].replace(/@/g, \",\");\n}\nfunction prev(){\n    cur -= 1;\n    if(cur == 1){\n        document.getElementById(\"prev\").style=\"display:none;\";\n    }\n    document.getElementById(\"next\").style=\"display:block;\";\n    HTML = \"\";\n    tableHeader();\n\n    var start = (cur-1)*20;\n    var num = start+1;\n    if(start + 20 >= titleSSelected.length){\n        for(i=start; i < title.length; i++){\n            HTML += \"<tr>\" \n            + \"<td>\" + num.toString() + \"</td>\" \n            + \"<td>\"  + \"<a href = /recipe/\" + idSelected[i] + \"> \"+ titleSSelected[i] + \"</a></td>\"\n            + \"</tr>\";\n            num += 1;\n        }\n    }\n    else{\n        for(i=start; i < start+20; i++){\n            HTML += \"<tr>\" \n            + \"<td>\" + num.toString() + \"</td>\" \n            + \"<td>\"  + \"<a href = /recipe/\" + idSelected[i] + \"> \"+ titleSSelected[i] + \"</a></td>\"\n            + \"</tr>\";\n            num += 1;\n        }\n    }\n    document.getElementById(\"table\").innerHTML=HTML;\n}\n\nfunction next(){\n    \n    cur += 1;\n    if(cur*20 >= titleSSelected.length){\n        document.getElementById(\"next\").style=\"display:none;\";\n    }\n    document.getElementById(\"prev\").style=\"display:block;\";\n    HTML = \"\";\n    tableHeader();\n\n    var start = (cur-1)*20;\n    var num = start+1;\n    if(start + 20 >= titleSSelected.length){\n        for(i=start; i < titleSSelected.length; i++){\n            HTML += \"<tr>\" \n            + \"<td>\" + num.toString() + \"</td>\" \n            + \"<td>\"  + \"<a href = /recipe/\" + idSelected[i] + \"> \"+ titleSSelected[i] + \"</a></td>\"\n            + \"</tr>\";\n            num += 1;\n        }\n    }\n    else{\n        for(i=start; i < start+20; i++){\n            HTML += \"<tr>\" \n            + \"<td>\" + num.toString() + \"</td>\" \n            + \"<td>\"  + \"<a href = /recipe/\" + idSelected[i] + \"> \"+ titleSSelected[i] + \"</a></td>\"\n            + \"</tr>\";\n            num += 1;\n        }\n    }\n    document.getElementById(\"table\").innerHTML=HTML;\n}\n\nfunction searchFunction(){\n    \n    titleSSelected= [];\n    idSelected = [];\n    HTML= \"\";\n    tableHeader();\n    var search_info = document.getElementById(\"recipeText\").value.toLowerCase();\n    const name = \"title\";\n    var num = 1;\n    for(i=0; i < title.length; i++){\n        console.log(title[i] + \" ----> \" + id[i]);\n        if(title[i] == \"Myrnas Tuna Mouse\"){\n            // console.log(obj.keys(name));\n            // console.log(obj[i][0].title);\n            // console.log(obj[i][0][name]);\n\n        }\n        var value = title[i].toLowerCase();\n        if(value.search(search_info) != -1 ){\n            titleSSelected.push(title[i]);\n            idSelected.push(id[i]);\n            \n        }\n    }\n    if(titleSSelected.length > 0 && titleSSelected.length <= 20){\n        \n        for(i=0; i<titleSSelected.length; i++){\n            //console.log(\"-> \" + idSelected[i]);\n            HTML += \"<tr>\" \n            + \"<td>\" + num.toString() + \"</td>\" \n            + \"<td>\"  + \"<a href = /recipe/\" + idSelected[i] + \"> \"+ titleSSelected[i] + \"</a></td>\"\n            + \"</tr>\";\n            num += 1;\n        }\n        document.getElementById(\"table\").style = \"display: block;\";\n        document.getElementById(\"table\").innerHTML=HTML;\n        document.getElementById(\"prev\").style=\"display:none\";\n        document.getElementById(\"next\").style=\"display:none\";\n    }\n    else if(titleSSelected.length <= 0){\n        document.getElementById(\"table\").style = \"display: none;\";\n        document.getElementById(\"prev\").style=\"display:none\";\n        document.getElementById(\"next\").style=\"display:none\";\n    }\n    else{\n        num = 1;\n        for(i=0; i<20; i++){\n            //console.log(titleSSelected[i] + \"-> \" + idSelected[i]);\n            HTML += \"<tr>\"  \n            + \"<td>\" + num.toString() + \"</td>\" \n            + \"<td>\"  + \"<a href = /recipe/\" + idSelected[i] + \"> \"+ titleSSelected[i] + \"</a></td>\"\n            + \"</tr>\";\n            num += 1;\n        }\n        document.getElementById(\"table\").style = \"display: block;\";\n        document.getElementById(\"table\").innerHTML=HTML;\n        document.getElementById(\"next\").style=\"display:block;\";\n    }\n}\n\nfunction tableHeader(){\n    HTML = \"<thead>\"\n        + \"<th> No </th>\"\n        + \"<th> Recipe Name </th>\"\n        + \"</thead>\";\n}\n    ","output":"str","x":840,"y":320,"wires":[["f28f65e2.f55b78","22dc6726.6d22d8"]]},{"id":"22dc6726.6d22d8","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":960,"y":220,"wires":[]},{"id":"642707d7.879c98","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":470,"y":320,"wires":[["3033d8ee.610318","b3327bce.99eb68"]]},{"id":"3033d8ee.610318","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":620,"y":220,"wires":[]},{"id":"b3327bce.99eb68","type":"function","z":"c0a64af3.88a468","name":"","func":"msg.title = []\nmsg.id = []\nmsg.obj = []\nfor(var i in msg.payload){\n    msg.title.push(msg.payload[i]['title'].replace(/,/g, \"@\"));\n    msg.id.push(msg.payload[i]['id']);\n    msg.obj.push(msg.payload[i]);\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":650,"y":320,"wires":[["ad8ec685.7c16c8"]]},{"id":"40a5db88.07cc34","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{"content-type":"text/css"},"x":570,"y":140,"wires":[]},{"id":"276d31aa.ce633e","type":"template","z":"c0a64af3.88a468","name":"Landin CSS","field":"payload","fieldType":"msg","format":"css","syntax":"mustache","template":"body {\n  font-family: \"Lato\", sans-serif;\n}\n\n.center {\n  margin-left: auto;\n  margin-right: auto;\n}\n\n/* Style the header */\n.header {\n  background-color: #f44336;\n  color: white;\n  text-align: center;\n  width: 100%;\n  height: 14%;\n  font-size: 62px;\n    \n}\n\n.topright {\n  position: absolute;\n  padding-top: 10px;\n  top: 8px;\n  right: 16px;\n  font-size: 18px;\n}\n\n\n\n.accountBtn {\n    display: flex;\n    justify-content: space-around;\n    background-color: #f44336; /* Red */\n    border: #f000000;\n    color: white;\n    padding: 15px 32px;\n    text-align: center;\n    text-decoration: none;\n    display: inline-block;\n    font-size: 16px;\n    margin: 4px 2px;\n    cursor: pointer;\n\n}\n\n/* On mouse-over */\n.accountBtn:hover {\n  color: #f1f1f1;\n}\n\n/* Clear floats after the header */\n.header:after {\n  content: \"\";\n  display: table;\n  clear: both;\n}\n\n\ninput[type=text] {\n  margin-left:40%;\n  width: 200px;\n  box-sizing: border-box;\n  border: 2px solid #ccc;\n  border-radius: 4px;\n  font-size: 16px;\n  background-color: white;\n  background-position: 10px 10px; \n  background-repeat: no-repeat;\n  padding: 12px 20px 12px 40px;\n  -webkit-transition: width 0.4s ease-in-out;\n  transition: width 0.4s ease-in-out;\n}\n\ninput[type=text]:focus {\n  width: 30%;\n}\n\n\n.searchBtn {\n    display: flex;\n    justify-content: space-around;\n    background-color: #818181;\n    border: #f000000;\n    color: white;\n    padding: 15px 32px;\n    text-align: center;\n    text-decoration: none;\n    display: inline-block;\n    font-size: 16px;\n    margin: 4px 2px;\n    cursor: pointer;\n\n}\n\n/* On mouse-over */\n.searchBtn:hover {\n  color: #f1f1f1;\n}\n\n.pageBtn {\n  justify-content: center;\n    background-color: #818181;\n    border: #f000000;\n    color: white;\n    padding: 15px 32px;\n    text-align: center;\n    text-decoration: none;\n    display:none;\n    font-size: 16px;\n    margin: 4px 2px;\n    cursor: pointer;\n    margin-left: auto;\n    margin-right: auto;\n\n}\n\n/* On mouse-over */\n.pageBtn:hover {\n  color: #f1f1f1;\n}\n\n\n\n/* landin Main content */\n.landinMain {\n  font-size: 20px; /* Increased text to enable scrolling */\n  width: 100%;\n\n}\n\n\n\n.titleBtn {\n  background-color: #f44336; /* Red */\n  border: none;\n  color: white;\n  padding: 15px 32px;\n  text-align: center;\n  text-decoration: none;\n  display: inline-block;\n  font-size: 20px;\n  margin: 4px 2px;\n  cursor: pointer;\n}\n\n\n.title {\n    color: white;\n    display: flex;\n    justify-content: space-between;\n\n}\n\n/* On mouse-over */\n.title:hover {\n  color: #f1f1f1;\n}\n\n\n#table {\n  font-family: Arial, Helvetica, sans-serif;\n  border-collapse: collapse;\n  width: 100%;\n}\n\n#table td, #table th {\n  border: 2px solid #ddd;\n  padding: 8px;\n\n\n}\n\n#table tr:nth-child(even){background-color: #f2f2f2;}\n\n#table tr:hover {background-color: #ddd;}\n\n#table th {\n  padding-top: 12px;\n  padding-bottom: 12px;\n  text-align: left;\n  background-color: #ffad33;\n  color: white;\n}\na {\n    color: black;\n    text-decoration: none;\n}\n","output":"str","x":310,"y":140,"wires":[["40a5db88.07cc34"]]},{"id":"645d1e07.c7326","type":"http in","z":"c0a64af3.88a468","name":"landin template","url":"/landin_template.css","method":"get","upload":false,"swaggerDoc":"","x":100,"y":140,"wires":[["276d31aa.ce633e"]]},{"id":"b2ee09e4.092188","type":"http in","z":"c0a64af3.88a468","name":"","url":"/login","method":"get","upload":false,"swaggerDoc":"","x":80,"y":440,"wires":[["65d741c2.ca4fd"]]},{"id":"362119c1.eea986","type":"http in","z":"c0a64af3.88a468","name":"","url":"/verify_account","method":"post","upload":false,"swaggerDoc":"","x":120,"y":740,"wires":[["65f802e2.bf3b4c","a579aec3.ca659"]]},{"id":"65d741c2.ca4fd","type":"function","z":"c0a64af3.88a468","name":"msg.url = \"verify_account\"","func":"msg.url = \"verify_account\";\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":440,"wires":[["8e8011f.f6187f"]]},{"id":"f95f9755.5a6dc8","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":660,"y":700,"wires":[]},{"id":"af2f6467.a0c9a8","type":"http response","z":"c0a64af3.88a468","name":"","x":1080,"y":740,"wires":[]},{"id":"28b8a6fe.68450a","type":"template","z":"c0a64af3.88a468","name":"CSS","field":"payload.style","fieldType":"msg","format":"css","syntax":"mustache","template":"input[type=password], select {\n    width: 100%;\n    padding: 12px 20px;\n    margin: 8px 0;\n    display: inline-block;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    box-sizing: border-box;\n}\n\ninput[type=text], select {\n    width: 100%;\n    padding: 12px 20px;\n    margin: 8px 0;\n    display: inline-block;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    box-sizing: border-box;\n}\n\ninput[type=submit] {\n    width: 100%;\n    background-color: #4CAF50;\n    color: white;\n    padding: 14px 20px;\n    margin: 8px 0;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n}\n\ninput[type=submit]:hover {\n    background-color: #45a049;\n}\n\ndiv {\n    border-radius: 5px;\n    background-color: #f2f2f2;\n    padding: 20px;\n}","x":750,"y":440,"wires":[["72454585.d70a9c"]]},{"id":"8e8011f.f6187f","type":"template","z":"c0a64af3.88a468","name":"JavaScript","field":"payload.script","fieldType":"msg","format":"javascript","syntax":"plain","template":"function redirect(returnhtml) {\n    window.location = returnhtml;\n}\n\n$(document).ready(function(e) {\n    \n    $(\"form[ajax=true]\").submit(function(e) {\n        \n        e.preventDefault();\n        \n        var form_data = $(this).serialize();\n        var form_url = $(this).attr(\"action\");\n        var form_method = $(this).attr(\"method\").toUpperCase();\n        \n        $(\"#loadingimg\").show();\n        \n        $.ajax({\n            url: form_url, \n            type: form_method,      \n            data: form_data,     \n            cache: false,\n            success: function(returnhtml){   \n                redirect(returnhtml);\n                //$(\"#result\").html(returnhtml); \n                //$(\"#loadingimg\").hide();                    \n            }           \n        });    \n        \n    });\n    \n});","x":590,"y":440,"wires":[["28b8a6fe.68450a","c9218a78.6f5938"]]},{"id":"b809bb30.fa1038","type":"http response","z":"c0a64af3.88a468","name":"","x":1030,"y":440,"wires":[]},{"id":"72454585.d70a9c","type":"template","z":"c0a64af3.88a468","name":"HTML","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<html>\n  <head>\n    <title>My Site</title>\n    <meta name=\"viewport\" content=\"initial-scale=1.0, user-scalable=no\">\n    <meta charset=\"utf-8\">\n    <script src=\"http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js\"></script>\n    <style>{{{payload.style}}}</style>\n  </head>\n  \n\n    <h2 style=\"text-align:center\">Login to your Account!</h2>\n\n<div style=\"width:500px;margin:auto\">\n  <form method=\"post\" action=\"/{{url}}\" ajax=\"true\">\n    <label for=\"fname\">Username</label>\n    <input type=\"text\" id=\"fname\" name=\"firstname\">\n\n    <label for=\"lname\">Password</label>\n    <input type=\"password\" id=\"lname\" name=\"lastname\">\n  \n    <input type=\"submit\" value=\"Login\">\n  </form>\n</div>\n\n</body>\n</html>\n<script>{{{payload.script}}}</script>","x":890,"y":440,"wires":[["b809bb30.fa1038"]]},{"id":"37567bfa.fe6a64","type":"function","z":"c0a64af3.88a468","name":"return msg.payload to client","func":"if(msg.payload.length !== 0){\n    var json = JSON.parse(msg.payload[0]);\n    msg.payload = '/landin';//'The following data was submitted and available in the msg.payload: ' + json[\"name\"] + \" \" + json[\"password\"];\n    msg.cookies = { };\n    msg.cookies[\"id\"] = json[\"username\"];\n}else{\n    msg.payload = '/login';//'Error!';\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":870,"y":740,"wires":[["af2f6467.a0c9a8"]]},{"id":"23bceace.3c2f76","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":480,"y":740,"wires":[["a13621cf.449f9","f95f9755.5a6dc8"]]},{"id":"65f802e2.bf3b4c","type":"function","z":"c0a64af3.88a468","name":"test","func":"var select=\"SELECT * from users WHERE username = '%s' and password = '%s'\";\n\nmsg.topic = util.format(select, msg.payload.firstname, msg.payload.lastname);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":320,"y":740,"wires":[["23bceace.3c2f76"]]},{"id":"a13621cf.449f9","type":"json","z":"c0a64af3.88a468","name":"","property":"payload[0]","action":"","pretty":false,"x":640,"y":740,"wires":[["37567bfa.fe6a64"]]},{"id":"a579aec3.ca659","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":300,"y":680,"wires":[]},{"id":"b68f7d65.cb514","type":"http in","z":"c0a64af3.88a468","name":"","url":"/register","method":"get","upload":false,"swaggerDoc":"","x":90,"y":480,"wires":[["1a8d3613.dd4b8a"]]},{"id":"1a8d3613.dd4b8a","type":"function","z":"c0a64af3.88a468","name":"msg.url = \"create_account\"","func":"msg.url = \"create_account\";\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":480,"wires":[["bde12b97.305978"]]},{"id":"6c1b3b80.c632a4","type":"template","z":"c0a64af3.88a468","name":"CSS","field":"payload.style","fieldType":"msg","format":"css","syntax":"mustache","template":"input[type=password], select {\n    width: 100%;\n    padding: 12px 20px;\n    margin: 8px 0;\n    display: inline-block;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    box-sizing: border-box;\n}\n\ninput[type=text], select {\n    width: 100%;\n    padding: 12px 20px;\n    margin: 8px 0;\n    display: inline-block;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    box-sizing: border-box;\n}\n\ninput[type=submit] {\n    width: 100%;\n    background-color: #4CAF50;\n    color: white;\n    padding: 14px 20px;\n    margin: 8px 0;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n}\n\ninput[type=submit]:hover {\n    background-color: #45a049;\n}\n\ndiv {\n    border-radius: 5px;\n    background-color: #f2f2f2;\n    padding: 20px;\n}","x":750,"y":480,"wires":[["d5d28047.48bd3"]]},{"id":"bde12b97.305978","type":"template","z":"c0a64af3.88a468","name":"JavaScript","field":"payload.script","fieldType":"msg","format":"javascript","syntax":"plain","template":"function redirect(returnhtml) {\n    window.location = returnhtml;\n}\n\n$(document).ready(function(e) {\n    \n    $(\"form[ajax=true]\").submit(function(e) {\n        \n        e.preventDefault();\n        \n        var form_data = $(this).serialize();\n        var form_url = $(this).attr(\"action\");\n        var form_method = $(this).attr(\"method\").toUpperCase();\n        \n        $(\"#loadingimg\").show();\n        \n        $.ajax({\n            url: form_url, \n            type: form_method,      \n            data: form_data,     \n            cache: false,\n            success: function(returnhtml){   \n                redirect(returnhtml);\n                //$(\"#result\").html(returnhtml); \n                //$(\"#loadingimg\").hide();                    \n            }           \n        });    \n        \n    });\n    \n});","x":590,"y":480,"wires":[["6c1b3b80.c632a4"]]},{"id":"4bbc9735.422348","type":"http response","z":"c0a64af3.88a468","name":"","x":1030,"y":480,"wires":[]},{"id":"d5d28047.48bd3","type":"template","z":"c0a64af3.88a468","name":"HTML","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<html>\n  <head>\n    <title>My Site</title>\n    <meta name=\"viewport\" content=\"initial-scale=1.0, user-scalable=no\">\n    <meta charset=\"utf-8\">\n    <script src=\"http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js\"></script>\n    <style>{{{payload.style}}}</style>\n  </head>\n  \n\n    <h2 style=\"text-align:center\">Register New Account!</h2>\n\n<div style=\"width:500px;margin:auto\">\n  <form method=\"post\" action=\"/{{url}}\" ajax=\"true\">\n    <label for=\"fname\">Username</label>\n    <input type=\"text\" id=\"fname\" name=\"firstname\">\n\n    <label for=\"lname\">Password</label>\n    <input type=\"password\" id=\"lname\" name=\"lastname\">\n  \n    <input type=\"submit\" value=\"Register\">\n  </form>\n</div>\n\n</body>\n</html>\n<script>{{{payload.script}}}</script>","x":890,"y":480,"wires":[["4bbc9735.422348"]]},{"id":"8f317c23.2f172","type":"http in","z":"c0a64af3.88a468","name":"","url":"/create_account","method":"post","upload":false,"swaggerDoc":"","x":120,"y":580,"wires":[["b8e35afb.d76ad8","40314e8b.bb524"]]},{"id":"368850d9.a07b8","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":800,"y":540,"wires":[]},{"id":"11f79551.8bd35b","type":"http response","z":"c0a64af3.88a468","name":"","x":1980,"y":560,"wires":[]},{"id":"5a404cfb.24f544","type":"function","z":"c0a64af3.88a468","name":"return msg.payload to client","func":"//var json = JSON.parse(msg.payload[0]);\nvar insert=\"INSERT INTO users VALUES ('%s', '%s')\";\nmsg.topic = util.format(insert, msg.name, msg.pwd);\n\nreturn msg;","outputs":1,"noerr":0,"x":1190,"y":600,"wires":[["c6c817a5.fe7178"]]},{"id":"9f6b53aa.19f44","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":600,"y":580,"wires":[["bdafd734.91eb38","368850d9.a07b8"]]},{"id":"b8e35afb.d76ad8","type":"function","z":"c0a64af3.88a468","name":"test","func":"var insertOneStudent=\"INSERT INTO students VALUES (5, '%s', '%s', '%s', '%s')\";\nvar select=\"SELECT * from users WHERE username = '%s'\";\n\nmsg.topic = util.format(select, msg.payload.firstname);\n\nmsg.name = msg.payload.firstname;\nmsg.pwd = msg.payload.lastname;\n\nmsg.assert = 1;\nif(msg.name === \"\" || msg.pwd === \"\" || msg.pwd.length > 16 || msg.name.length > 25){\n    msg.assert = 0;\n}\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":320,"y":580,"wires":[["ee247e29.f281c"]]},{"id":"bdafd734.91eb38","type":"json","z":"c0a64af3.88a468","name":"","property":"payload[0]","action":"","pretty":false,"x":760,"y":580,"wires":[["bc865a82.74f568"]]},{"id":"40314e8b.bb524","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":300,"y":520,"wires":[]},{"id":"bc865a82.74f568","type":"switch","z":"c0a64af3.88a468","name":"","property":"payload","propertyType":"msg","rules":[{"t":"nempty"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":950,"y":580,"wires":[["f6880214.8848d"],["5a404cfb.24f544"]]},{"id":"f6880214.8848d","type":"function","z":"c0a64af3.88a468","name":"return back","func":"msg.payload = '/register';\nreturn msg;","outputs":1,"noerr":0,"x":1140,"y":560,"wires":[["11f79551.8bd35b"]]},{"id":"e2a28351.775b7","type":"function","z":"c0a64af3.88a468","name":"return msg.payload to client","func":"msg.payload = '/landin';//'Error!';\nmsg.cookies = { };\nmsg.cookies[\"id\"] = msg.name;\n\nreturn msg;","outputs":1,"noerr":0,"x":1770,"y":600,"wires":[["11f79551.8bd35b"]]},{"id":"c6c817a5.fe7178","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1400,"y":600,"wires":[["33f5da30.0ac3d6"]]},{"id":"33f5da30.0ac3d6","type":"json","z":"c0a64af3.88a468","name":"","property":"payload[0]","action":"","pretty":false,"x":1540,"y":600,"wires":[["e2a28351.775b7"]]},{"id":"c9218a78.6f5938","type":"debug","z":"c0a64af3.88a468","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":790,"y":380,"wires":[]},{"id":"ee247e29.f281c","type":"switch","z":"c0a64af3.88a468","name":"","property":"assert","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":460,"y":580,"wires":[["9f6b53aa.19f44"],["6a2fc44.479453c"]]},{"id":"6a2fc44.479453c","type":"change","z":"c0a64af3.88a468","name":"Redirect to /landin","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.location","pt":"msg","to":"/register","tot":"str"},{"t":"set","p":"statusCode","pt":"msg","to":"302","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":640,"y":640,"wires":[["7181ab32.9d3884"]]},{"id":"7181ab32.9d3884","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":820,"y":640,"wires":[]},{"id":"7054200f.7e45c","type":"http in","z":"c0a64af3.88a468","name":"","url":"/logout","method":"get","upload":false,"swaggerDoc":"","x":90,"y":800,"wires":[["563f2cb0.7f0f94"]]},{"id":"563f2cb0.7f0f94","type":"function","z":"c0a64af3.88a468","name":"Clear cookies","func":"// Find demo cookies and clear them\nmsg.cookies = {};\nmsg.cookies[\"id\"] = null;\n\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":800,"wires":[["44e805a5.8e3f5c"]]},{"id":"c0bef1cd.eb1da","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":1040,"y":800,"wires":[]},{"id":"44e805a5.8e3f5c","type":"change","z":"c0a64af3.88a468","name":"Redirect to /landin","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.location","pt":"msg","to":"/landin","tot":"str"},{"t":"set","p":"statusCode","pt":"msg","to":"302","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":620,"y":800,"wires":[["c0bef1cd.eb1da"]]},{"id":"b28d555b.393668","type":"comment","z":"c0a64af3.88a468","name":"Menu","info":"","x":70,"y":2040,"wires":[]},{"id":"f795dd39.d4c65","type":"comment","z":"c0a64af3.88a468","name":"User profile page","info":"","x":100,"y":880,"wires":[]},{"id":"f00272d4.ee4b1","type":"http in","z":"c0a64af3.88a468","name":"","url":"/user_profile","method":"get","upload":false,"swaggerDoc":"","x":100,"y":1180,"wires":[["bdff1562.8ec978"]]},{"id":"1384ec29.12fb74","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":1170,"y":1180,"wires":[]},{"id":"ab6b1a92.308038","type":"template","z":"c0a64af3.88a468","name":"HTML","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<html>\n    <head>\n        <script src=\"http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js\"></script>\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n        <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/template.css\">\n    </head>\n\t<body onload='preferences();allergies()'>\n\t    <div class=\"sidenav\">\n            <!--<a href=\"/menu\">Daily Menu</a>\n            <a href=\"/menu/ingredients\">Ingredient List</a>\n            <a href=\"/menu/nutrients\">Nutrients</a>\n            <a href=\"/menu/instructions\">Instructions</a>-->\n            <a href=\"/menu\">Menu</a>\n            <a href=\"/landin\">Recipe Search</a>\n            <a href=\"/farmers_market\">Market Search</a>\n        </div>\n\t    <div class=\"main\">\n\t    <div id=\"myDIV\" class=\"header\">\n            <h2 style=\"font-size:35px;margin:5px\">{{req.cookies.id}}</h2>\n        </div>\n        \n        <div id=\"myDIV\" class=\"header\" style=\"padding-top:0px\">\n            <p style=\"font-size:25px; font-weight:bold; margin:0; float:left; margin-left:20%\">Preference</p>\n            <p style=\"font-size:25px; font-weight:bold; margin:0; float:right; margin-right:20%\">Allergy</p>\n        </div>\n\n\t\t<!--<table border=\"5px\" style=\"width: 500px; font-size: 30px;\" id = \"table1\">\n\t\t</table>-->\n\t\t\n\t\t{{!-- add by preference and allergy --}}\n\t\t<div style=\"padding-top:10px\">\n\t\t    <div style=\"width:750px; display:inline-block\">\n        <input  style=\"padding-top: 10px;margin-top: 5px;border: solid;\" align = \"center\" type=\"text\" id=\"preferenceText\" name=\"preference\" placeholder=\"Add a preference\" class = \"preferenceAdd\" style=\"display: inline;\">\n        <button style=\"height:50px;margin-left: 15px;\" id=\"addPreferenceBtn\" onclick=\"inputBox('preference')\" class = \"searchBtn\"> Add a preference </button>\n            </div>\n        <div style=\"width:750px;display:inline-block\">\n        <input style=\"padding-top: 10px;margin-top: 5px;border: solid;\" align = \"center\" type=\"text\" id=\"allergyText\" name=\"allergy\" placeholder=\"Add an allergy\" class = \"allergyAdd\" style=\"display: inline;\">\n        <button style=\"height:50px;margin-left: 15px;\" id=\"addAllergyBtn\" onclick=\"inputBox('allergy')\" class = \"searchBtn\"> Add an allergy </button>\n        </div>\n        </div>\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t<div style=\"padding-top:10px\">\n\t\t<table border=\"5px\" style=\"width: 750px; font-size: 30px;float:left\" id = \"table2\">\n\t\t</table>\n\t\t\n\t\t<table border=\"5px\" style=\"width: 750px; font-size: 30px;\" id = \"table3\">\n\t\t</table>\n        </div>\n    \t<script>{{{payload.script}}}</script>\n\t\t</div>\n\t\t\n\t</body>\n\t\n\t\n</html>","output":"str","x":1030,"y":1180,"wires":[["1384ec29.12fb74"]]},{"id":"31fb4512.f7e49a","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":430,"y":1180,"wires":[["fe2e885c.245a58"]]},{"id":"76f7d1d9.588e6","type":"function","z":"c0a64af3.88a468","name":"test","func":"var select=\"SELECT username, password FROM users\";\nmsg.topic = util.format(select);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":270,"y":1180,"wires":[["31fb4512.f7e49a"]]},{"id":"a6c875c3.e2bca8","type":"template","z":"c0a64af3.88a468","name":"Javascript","field":"payload.script","fieldType":"msg","format":"javascript","syntax":"mustache","template":"\nvar array = \"{{data}}\"; //\nvar array = array.split(\",\"); \n\nvar array2 = \"{{data2}}\"; //\nvar array2 = array2.split(\",\"); \nvar loginname=\"{{name}}\";\n\nvar arrayP = \"{{dataP}}\"; //\nvar arrayP = arrayP.split(\",\");\nvar arrayA = \"{{dataA}}\"; //\nvar arrayA = arrayA.split(\",\");\n\nfunction userdata(){\n    HTML = \"<thread><th>\" + \"USERNAME\" +  \n        \"</th</thread>\";\n    for(i=0; i < array.length; i++){\n        if (loginname==array[i]){\n            HTML += \"<tr><td>\" + array[i] + \"</td></tr>\";\n        }\n    }\n    document.getElementById(\"table1\").innerHTML=HTML;\n}\n\nfunction inputBox(btnName){\n    console.log(\"\\ninputBox\");\n    if(btnName == \"none\") return; // init the page\n    var search_info;\n    // determine which add bar user used\n    switch(btnName){\n        case \"preference\":\n            search_info = document.getElementById(\"preferenceText\").value;\n            break;\n        case \"allergy\":\n            search_info = document.getElementById(\"allergyText\").value;\n            break;\n    }\n    if(search_info === \"\" || search_info === null) return;\n    // Add input into dietary preference database\n    $.ajax({\n            url: \"/create_preference\", \n            type: \"post\",      \n            data: {\"ingredient\":search_info,\"cases\":btnName},     \n            cache: false,\n            success: function(returnhtml){   \n                window.location=\"/user_profile\";\n                //location.reload();\n\n                //$(\"#result\").html(returnhtml); \n                //$(\"#loadingimg\").hide();                    \n            }           \n    });   \n    \n}   \n\nfunction preferences(){\n    HTML = \"<thread><th>\" + \"PREFERENCES\" + \"</th></thread>\";\n    for(i=0; i < arrayP.length; i++){\n        HTML += \"<tr><td>\" + arrayP[i] + \"</td></tr>\";\n    }\n    document.getElementById(\"table2\").innerHTML=HTML;\n}\n\nfunction allergies(){\n    HTML = \"<thread><th>\"+\"ALLERGIES\"+\"</th></thread>\";\n    for(i=0; i < arrayA.length; i++){\n        HTML += \"<tr><td>\" + arrayA[i] + \"</td></tr>\";\n    }\n    document.getElementById(\"table3\").innerHTML=HTML;\n}","output":"str","x":840,"y":1180,"wires":[["ab6b1a92.308038"]]},{"id":"fe2e885c.245a58","type":"function","z":"c0a64af3.88a468","name":"format data","func":"\nmsg.data = []\nmsg.data2 = []\nmsg.dataP = []\nmsg.dataA = []\nmsg.name=[]\nfor(var i in msg.payload){\n        msg.data.push(msg.payload[i]['username']);\n        msg.data2.push(msg.payload[i]['password']);\n}\nmsg.name.push(msg.req.cookies.id);\n\n\n\nreturn msg;","outputs":1,"noerr":0,"x":610,"y":1180,"wires":[["6652d85b.186588"]]},{"id":"2c54b2ea.3871be","type":"http in","z":"c0a64af3.88a468","name":"","url":"/create_preference","method":"post","upload":false,"swaggerDoc":"","x":130,"y":1300,"wires":[["2f3d13ea.96601c","f78b024b.eb189"]]},{"id":"f78b024b.eb189","type":"function","z":"c0a64af3.88a468","name":"return msg.payload to client","func":"var insert1=\"INSERT INTO preferences VALUES ('%s', '%s')\";\nvar insert2=\"INSERT INTO allergies VALUES ('%s', '%s')\";\n\nif (msg.payload.cases==\"preference\"){\n    msg.topic = util.format(insert1, msg.req.cookies.id, msg.payload.ingredient);\n}\nelse if (msg.payload.cases==\"allergy\"){\n    msg.topic = util.format(insert2, msg.req.cookies.id, msg.payload.ingredient);\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":500,"y":1300,"wires":[["ed7afc6b.ab883"]]},{"id":"2f3d13ea.96601c","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":370,"y":1240,"wires":[]},{"id":"ed7afc6b.ab883","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":710,"y":1300,"wires":[["913138a7.5c3b38"]]},{"id":"913138a7.5c3b38","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":850,"y":1300,"wires":[]},{"id":"da5c994c.546a68","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":430,"y":1120,"wires":[["7ca43981.d7a8d8"]]},{"id":"6652d85b.186588","type":"function","z":"c0a64af3.88a468","name":"test","func":"\nvar select1=\"SELECT ingredient FROM preferences WHERE username='%s'\";\nmsg.topic = util.format(select1,msg.req.cookies.id);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":270,"y":1120,"wires":[["da5c994c.546a68"]]},{"id":"7ca43981.d7a8d8","type":"function","z":"c0a64af3.88a468","name":"format data","func":"\n\nmsg.dataP = []\n\n\nfor(var j in msg.payload){\n        msg.dataP.push(msg.payload[j]['ingredient']);\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":610,"y":1120,"wires":[["cb1617b1.fd9c58"]]},{"id":"6f567eeb.d1ce2","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":430,"y":1060,"wires":[["c7cf60c7.56e7b"]]},{"id":"cb1617b1.fd9c58","type":"function","z":"c0a64af3.88a468","name":"test","func":"\nvar select2=\"SELECT ingredient FROM allergies WHERE username='%s'\";\nmsg.topic = util.format(select2,msg.req.cookies.id);\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":270,"y":1060,"wires":[["6f567eeb.d1ce2"]]},{"id":"c7cf60c7.56e7b","type":"function","z":"c0a64af3.88a468","name":"format data","func":"\n\nmsg.dataA = []\n\n\nfor(var k in msg.payload){\n        msg.dataA.push(msg.payload[k]['ingredient']);\n}\nreturn msg;","outputs":1,"noerr":0,"x":610,"y":1060,"wires":[["a6c875c3.e2bca8"]]},{"id":"bdff1562.8ec978","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"//breakfast\n\nvar insert = \"SELECT username from users\";\n\nmsg.topic = insert;\n\nreturn msg;","outputs":1,"noerr":0,"x":270,"y":920,"wires":[["c761717a.db126"]]},{"id":"c761717a.db126","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":430,"y":920,"wires":[["cdcef36e.d3852"]]},{"id":"cdcef36e.d3852","type":"function","z":"c0a64af3.88a468","name":"check user","func":"msg.users = [];\nmsg.assert = 0\nfor(var i in msg.payload){\n    if(msg.req.cookies.id === msg.payload[i]['username']) {\n        msg.assert = 1;\n        break;\n    }\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":590,"y":920,"wires":[["627016d2.5cb328"]]},{"id":"627016d2.5cb328","type":"switch","z":"c0a64af3.88a468","name":"","property":"assert","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":790,"y":920,"wires":[["76f7d1d9.588e6"],["e7fc976a.047d78"]]},{"id":"317a953e.56d3ea","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":890,"y":980,"wires":[]},{"id":"e7fc976a.047d78","type":"change","z":"c0a64af3.88a468","name":"Redirect to /menu","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.location","pt":"msg","to":"/landin","tot":"str"},{"t":"set","p":"statusCode","pt":"msg","to":"302","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":710,"y":980,"wires":[["317a953e.56d3ea"]]},{"id":"c67e6a22.2987a8","type":"comment","z":"c0a64af3.88a468","name":"Recipe","info":"","x":70,"y":1400,"wires":[]},{"id":"44c20266.d635cc","type":"http in","z":"c0a64af3.88a468","name":"","url":"/recipe/:id","method":"get","upload":false,"swaggerDoc":"","x":100,"y":1480,"wires":[["7a354343.10561c"]]},{"id":"74ee2b97.b38d64","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":1310,"y":1480,"wires":[]},{"id":"27cb0c30.a6b094","type":"template","z":"c0a64af3.88a468","name":"HTML","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<html>\n    <head>\n        <script src=\"http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js\"></script>\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n        <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/template.css\">\n    </head>\n\t\n\t<title>Recipe</title>\n\t\n\t\n\t<body onload='tag_l(); ing_l(); pr(); barChart();'>\n\t    <div class=\"sidenav\">\n            <!--<a href=\"/menu\">Daily Menu</a>\n            <a href=\"/menu/ingredients\">Ingredient List</a>\n            <a href=\"/menu/nutrients\">Nutrients</a>\n            <a href=\"/menu/instructions\">Instructions</a>-->\n            <a href=\"/menu\">Menu</a>\n            <a href=\"/user_profile\">User Profile</a>\n            <a href=\"/landin\">Recipe Search</a>\n            <a href=\"/farmers_market\">Market Search</a>\n        </div>\n        \n        <div class=\"main\">\n\n    \t\t<!--<table border=\"5px\" style=\"width: 500px; font-size: 30px;\" id = \"table\">\n    \t\t</table>-->\n    \t\t<div id=\"myDIV\" class=\"header\">\n                <h2 style=\"font-size:35px;margin:5px\">{{rTitle}}</h2>\n            </div>\n            \n            <div id=\"myDIV\" class=\"header\" style=\"margin:0px;padding:0px;padding-bottom:10px\">\n                <div style=\"width:70%;margin:auto\">\n                    <ul id = \"tagl\" style=\"display:inline-block\">\n                    </ul>\n                </div>\n            </div>\n            \n            <div id=\"myDIV\" class=\"header\" style=\"padding-top:0px;padding-left:0px\">\n                <div class=\"dropdown\">\n        \t\t    <button class=\"dropbtn\" style=\"font-size:25px; font-weight:bold; width:120px; color:white\">View<i class=\"fa fa-caret-down\"></i></button>\n        \t\t    <div class=\"dropdown-content\" id = \"drops\">\n                        <a style = \"font-size:20px; cursor:pointer\" onclick=\"ing_l()\"><u>Ingredients</u></a>\n                        <a style = \"font-size:20px; cursor:pointer\" onclick=\"list()\"><u>Instructions</u></a>\n                    </div>\n                </div>\n                <p id=\"name\" style=\"font-size:25px; font-weight:bold; margin:0; float:left; margin-left:10px; margin-right:15px\"></p>\n                <div style=\"display:inline-block\">\n                    <p style=\"font-size:25px; font-weight:bold; margin:0; float:left; margin-left:10px; margin-right:15px\">Serving per Recipe: {{ser_p}}</p>\n                </div>\n                <div class=\"dropdown\" style=\"float:right\">\n                <button class=\"dropbtn\" style=\"font-size:25px; font-weight:bold; width:200px; color:white\">Add to Menu\n                    <i class=\"fa fa-caret-down\"></i>\n                </button>\n                <div class=\"dropdown-content\">\n                    <a style = \"font-size:20px; cursor:pointer\" onclick=\"addtomenub('{{req.params.id}}');\"><u>Breakfast</u></a>\n                    <a style = \"font-size:20px; cursor:pointer\" onclick=\"addtomenul('{{req.params.id}}');\"><u>Lunch</u></a>\n                    <a style = \"font-size:20px; cursor:pointer\" onclick=\"addtomenud('{{req.params.id}}');\"><u>Dinner</u></a>\n                </div>\n        </div>\t\n            </div>\n            <div>\n                <div style=\"float:left; min-height:500px\">\n            \t\t<table border=\"5px\" style=\"width: 700px; font-size: 30px\" id = \"table\">\n        \t\t    </table>\n            \t\t\n            \t\t<div style=\"padding-top:20px\"></div>\n            \t\t\n            \t\t<table border=\"5px\" style=\"width: 700px; font-size: 30px;\" id = \"p1\">\n        \t\t    </table>\n        \t\t    \n        \t\t    <div style=\"padding-top:20px\"></div>\n        \t\t</div>\n        \n        \t\t\n        \t\t<div style=\"width:750px\">\n        \t\t    <div id=\"chartContainer\" style=\"height: 400px; width: 750px;\"></div>\n        \t\t    <div id=\"chartContainer1\" style=\"height: 360px; width: 100%;\"></div>\n        \t\t    <div style=\"padding-top:20px\"></div>\n        \t\t</div>\n                <script src=\"https://canvasjs.com/assets/script/canvasjs.min.js\"></script>\n            </div>\n            \n            <div style=\"padding-left:20px;display:inline-block;width:100%\">\n                <textarea style=\"width:90%;float:left\" class=\"comment\" cols=\"80\" id=\"msg\" rows=\"5\" placeholder=\"Comment on this Recipe\" class=\"ipt-txt\"></textarea>\n                <div style=\"padding-right:20px\"></div>\n                <button style=\"margin-left:10px\" id=\"id_enter\" onclick=\"submit()\" class=\"comment_submit\">Comment</button>\n            </div>\n            \n            <table border=\"5px\" style=\"width: 100%; font-size: 30px; margin-top:20px\" id = \"comment\">\n        \t</table>\n    \t\t\n    \t\t<script>{{{payload.script}}}</script>\n\t\t</div>\n\t</body>\n\t\n</html>","x":1170,"y":1480,"wires":[["74ee2b97.b38d64"]]},{"id":"fcbb675f.401788","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":610,"y":1480,"wires":[["b779d815.da2188"]]},{"id":"7a354343.10561c","type":"function","z":"c0a64af3.88a468","name":"test","func":"msg.select=\"SELECT  distinct instructions.instruction, instructions.instruction_number, recipes.title, recipes.url, ingredient.ingredients, tags.tags, recipes.calories, recipes.cholesterol, recipes.fat_cals, recipes.fat_per100g, recipes.fiber, recipes.protein, recipes.salt_per100g, recipes.saturated_fat, recipes.saturates_per100g,recipes.serving_size, recipes.servings_per_recipe, recipes.sodium, recipes.sugar, recipes.sugar_per100g, recipes.total_carbohydrates, recipes.total_fat FROM sdd.instructions, sdd.recipes, sdd.ingredient, sdd.tags Where instructions.id = '\"\nvar recipeid = msg.req.params.id;\nmsg.select += String(recipeid)\nmsg.select += \"' AND instructions.id = recipes.id AND ingredient.id = recipes.id AND tags.id = instructions.id Order by instructions.instruction_number asc;\"\n\nmsg.topic = util.format(msg.select);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":290,"y":1480,"wires":[["fcbb675f.401788","1d03045b.02fa2c"]]},{"id":"f54ab2e7.94609","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":830,"y":1560,"wires":[]},{"id":"48fbf98f.bfa358","type":"template","z":"c0a64af3.88a468","name":"Javascript","field":"payload.script","fieldType":"msg","format":"javascript","syntax":"mustache","template":"var array = \"{{data}}\"; //\nvar array = array.split(\",\"); \n\nvar array2 = \"{{data2}}\"; //\nvar array2 = array2.split(\",\"); \n\nvar tags = \"{{tag1}}\";\nvar tags = tags.split(\",\");\n\nvar ings = \"{{ing1}}\";\nvar ings = ings.split(\",\");\n\nvar recipe = \"{{req.params.id}}\";\n\nvar cal = Number(\"{{cal}}\");\nvar fat_c = Number(\"{{fat_c}}\");\nvar to_cal = Number(\"{{to_car}}\");\nvar fiber = Number(\"{{fiber}}\");\nvar to_fat = Number(\"{{to_fat}}\");\nvar sat_f = Number(\"{{sat_f}}\");\nvar cho = Number(\"{{cho}}\");\nvar protein = Number(\"{{protein}}\");\nvar sod = Number(\"{{sod}}\");\nvar sug_p = Number(\"{{sug_p}}\");\nvar sat_p = Number(\"{{sat_p}}\");\nvar salt_p = Number(\"{{salt_p}}\");\nvar fat_p = Number(\"{{fat_p}}\");\nvar data = [sug_p, sat_p, salt_p, fat_p];\n \n//HTML = \"<thread><td>\" + \"{{rTitle}}\" +  \"</td></thread>\";\n//HTML += \"<tr><td>\" + array + \"</td></tr>\";\n\n$(document).ready(function() {\n\t nutrients_piechart(data);\n\t load_comment(recipe);\n\t enterbutton();\n});\n\nfunction enterbutton(){\n\n    $(function() {\n        $(\"input\").keypress(function (e) {\n        if ((e.which && e.which == 13) || (e.keyCode && e.keyCode == 13)) {\n             $('#id_enter').click();\n             return false;\n        } else {\n       return true;\n\t }\n     });\n    });\n\n}\n\nfunction listb(response){\n    HTML2 = \"<tr><th colspan='3'>Comments</th></tr>\";\n    for(i=0; i < response[\"time\"].length; i++){\n        HTML2 += \"<tr><td>\" + response[\"username\"][i] + \"</td>\";\n        HTML2 += \"<td>\" + response[\"comment\"][i] + \"</td>\";\n        HTML2 += \"<td>\" + response[\"time\"][i] + \"</td></tr>\"\n    }\n    document.getElementById(\"comment\").innerHTML=HTML2;\n}\n\nfunction load_comment(id) {\n    function list_comment(response) {\n        listb(response);\n    }\n    $.ajax({\n        type: 'POST',\n        url: \"/load\",\n        data: {\"recipe\": recipe},\n        success: list_comment\n   });\n}\n\nfunction submit(){\n    if(\"{{req.cookies.id}}\" == \"\"){\n        confirm(\"Please login to comment!\");\n    }else{\n    message = document.getElementById(\"msg\").value;\n        $.ajax({\n            type: 'POST',\n            url: \"/insert_comment\",\n            data: {\"comment\": message, \"recipe\": recipe},\n            success: function(returnhtml){\n                load_comment(recipe);\n                //window.location = \"/recipe/\" + recipe;\n                //$(\"#result\").html(returnhtml);\n                //$(\"#loadingimg\").hide();\n            }\n       });\n    }\n}\n\n\nfunction list(){\n    HTML = \"<tr><th colspan='2'>Recipe Instructions</th></tr>\";\n    for(i=0; i < array2.length; i++){\n        HTML += \"<tr><td>\" + array[i] + \"</td>\";\n        HTML += \"<td>\" + array2[i] + \"</td></tr>\";\n    }\n    HTML += \"</tr>\";\n    document.getElementById(\"table\").innerHTML=HTML;\n    document.getElementById(\"name\").innerHTML=\"Instructions\";\n}\n\nHTML2 = \"\";\nfunction tag_l(){\n    /*for(j=0; j< (tags.length)/4; j++){\n        HTML2 += \"<tr><td>\" + tags[4*j] + \"</td>\";\n        HTML2 += \"<td>\" + tags[4*j+1] +\"</td>\";\n        HTML2 += \"<td>\" + tags[4*j+2] +\"</td>\";\n        HTML2 += \"<td>\" + tags[4*j+3] +\"</td></tr>\";\n    }*/\n    for(j=0; j< (tags.length)/4; j++){\n        HTML2 += \"<li class='tag'>\" + tags[4*j] + \"</li>\";\n        HTML2 += \"<li class='tag'>\" + tags[4*j+1] +\"</li>\";\n        HTML2 += \"<li class='tag'>\" + tags[4*j+2] +\"</li>\";\n        HTML2 += \"<li class='tag'>\" + tags[4*j+3] +\"</li>\";\n    }\n    document.getElementById(\"tagl\").innerHTML = HTML2;\n}\n\n\nfunction ing_l(){\n    HTML3 = \"<tr><th>Recipe Ingredients</th></tr>\";\n    for(k=0; k< ings.length; k++){\n        HTML3 += \"<tr><td>\" + ings[k] + \"</td></tr>\";\n    }\n    document.getElementById(\"table\").innerHTML = HTML3;\n    document.getElementById(\"name\").innerHTML=\"Ingredients\";\n}\n\nfunction pr(){\n    HTML4 = \"<tr><th colspan='2'>Recipe Nutrition Info</th></tr>\";\n    HTML4 += \"<tr><td>\"+\"calories\" +\"</td><td>\"+ \"{{cal}}\"+ \"</td></tr>\";\n    HTML4 += \"<tr><td>\"+\"fat calories\" +\"</td><td>\"+ \"{{fat_c}}\"+ \"</td></tr>\";\n    HTML4 += \"<tr><td>\"+\"total carbohydrates\" +\"</td><td>\"+ \"{{to_car}}\"+ \"</td></tr>\";\n    HTML4 += \"<tr><td>\"+\"fiber\" +\"</td><td>\"+ \"{{fiber}}\"+ \"</td></tr>\";\n    HTML4 += \"<tr><td>\"+\"total fat\" +\"</td><td>\"+ \"{{to_fat}}\"+ \"</td></tr>\";\n    HTML4 += \"<tr><td>\"+\"saturated fat\" +\"</td><td>\"+ \"{{sat_f}}\"+ \"</td></tr>\";\n    HTML4 += \"<tr><td>\"+\"cholesterol\" +\"</td><td>\"+ \"{{cho}}\"+ \"</td></tr>\";\n    HTML4 += \"<tr><td>\"+\"protein\" +\"</td><td>\"+ \"{{protein}}\"+ \"</td></tr>\";\n    HTML4 += \"<tr><td>\"+\"sodium\" +\"</td><td>\"+ \"{{sod}}\"+ \"</td></tr>\";\n    HTML4 += \"<tr><td>\"+ \"sugar per 100g\"+\"</td><td>\" + \"{{sug_p}}\"+\"</td></tr>\";\n    HTML4 += \"<tr><td>\"+\"saturated fat per 100g\" +\"</td><td>\"+ \"{{sat_p}}\"+ \"</td></tr>\";\n    HTML4 += \"<tr><td>\"+\"salt per 100g\" +\"</td><td>\"+ \"{{salt_p}}\"+ \"</td></tr>\";\n    HTML4 += \"<tr><td>\"+\"fat per 100g\" +\"</td><td>\"+ \"{{fat_p}}\"+ \"</td></tr>\";\n    document.getElementById(\"p1\").innerHTML = HTML4;\n}\n\nfunction addtomenub(id){\n    message = id;\n    $.ajax({\n        type: 'POST',\n        url: \"/addToMenu\",\n        data: {\"name\": message, \"type\": \"b\"},\n        success: function(returnhtml){\n            window.location = \"/recipe/\"+id;\n            //$(\"#result\").html(returnhtml);\n            //$(\"#loadingimg\").hide();\n        }\n   });\n}\n\nfunction addtomenul(id){\n    message = id;\n    $.ajax({\n        type: 'POST',\n        url: \"/addToMenu\",\n        data: {\"name\": message, \"type\": \"l\"},\n        success: function(returnhtml){\n            window.location = \"/recipe/\"+id;\n            //$(\"#result\").html(returnhtml);\n            //$(\"#loadingimg\").hide();\n        }\n   });\n}\n\nfunction addtomenud(id){\n    message = id;\n    $.ajax({\n        type: 'POST',\n        url: \"/addToMenu\",\n        data: {\"name\": message, \"type\": \"d\"},\n        success: function(returnhtml){\n            window.location = \"/recipe/\"+id;\n            //$(\"#result\").html(returnhtml);\n            //$(\"#loadingimg\").hide();\n        }\n   });\n}\n\n\n\nfunction barChart() {\n\t\nvar chart = new CanvasJS.Chart(\"chartContainer\", {\n    theme: \"light2\",\n\tanimationEnabled: true,\n\ttitle: {\n\t\ttext: \"Recipe Nutrition Info\",\n\t\tfontSize: 25\n\t},\n\taxisX: {\n\t\tinterval: 1,\n\t\tlabelFontSize: 15\n\t},\n\taxisY: {\n\t\ttitle: \"Values\",\n\t\ttitleFontSize: 15,\n\t\tincludeZero: true,\n\t\tlabelFontSize: 15,\n\t\tminimum: 0,\n\t\tscaleBreaks: {\n\t\t\ttype: \"wavy\",\n\t\t\tcustomBreaks: [{\n\t\t\t\tstartValue: 25,\n\t\t\t\tendValue: 35\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tstartValue: 40,\n\t\t\t\t\tendValue: 600\n\t\t\t\t}\n\t\t]}\n\t},\n\tdataPointWidth: 20,\n\theight:400,\n\tdata: [{\n\t\ttype: \"bar\",\n\t\tdataPoints: [\n\t\t\t{ label: \"Sodium\", y: sod, gdp: 2.5},\n\t\t\t{ label: \"Protein\", y: protein, gdp: 1.9},\n\t\t\t{ label: \"Cholesterol\", y: cho, gdp: 1.2},\n\t\t\t{ label: \"Saturated Fat\", y: sat_f, gdp: 2.7},\n\t\t\t{ label: \"Total Fat\", y: to_fat, gdp: 2.0},\n\t\t\t{ label: \"Fiber\", y: fiber, gdp: 1.0},\n\t\t\t{ label: \"Total Carbohydrate\", y: to_cal, gdp: 1.3},\n\t\t\t{ label: \"Fat Calories\", y: fat_c, gdp: 5.7},\n\t\t\t{ label: \"Calories\", y: cal, gdp: 5.8},\n\t\t]\n\t}]\n});\nchart.render();\n}\n\nfunction nutrients_piechart(data) {\nvar sum = data.reduce(function(a, b){return a + b;}, 0);\nresult = [];\nfor(var i in data){\n    result.push(Math.round(data[i]/sum * 10000) / 100);\n}\n\nvar chart = new CanvasJS.Chart(\"chartContainer1\", {\n\ttheme: \"light2\",\n\tanimationEnabled: true,\n\ttitle: {\n\t\ttext: \"Major Nutrients per 100g\",\n\t\tfontSize: 25\n\t},\n\tdata: [{\n\t\ttype: \"pie\",\n\t\tindexLabelFontSize: 18,\n\t\tradius: 120,\n\t\tindexLabel: \"{label} - {y}\",\n\t\tyValueFormatString: \"###0.0\\\"%\\\"\",\n\t\tclick: explodePie,\n\t\tdataPoints: [\n\t\t\t{ y: result[0], label: \"Sugar\" },\n\t\t\t{ y: result[1], label: \"Saturated Fat\"},\n\t\t\t{ y: result[2], label: \"Salt\" },\n\t\t\t{ y: result[3], label: \"Fat\" },\n\t\t]\n\t}]\n});\nchart.render();\n\nfunction explodePie(e) {\n\tfor(var i = 0; i < e.dataSeries.dataPoints.length; i++) {\n\t\tif(i !== e.dataPointIndex)\n\t\t\te.dataSeries.dataPoints[i].exploded = false;\n\t}\n}\n}","output":"str","x":980,"y":1480,"wires":[["27cb0c30.a6b094","87753af2.6753c8"]]},{"id":"b779d815.da2188","type":"function","z":"c0a64af3.88a468","name":"format data","func":"msg.data = []\nmsg.data2 = []\nmsg.tag1 = []\nmsg.ing1 = []\nmsg.rTitle = msg.payload[1]['title'];\nmsg.URL = msg.payload[1]['url']\nmsg.cal = String(msg.payload[1]['calories']);\nmsg.cho = String(msg.payload[1]['cholesterol']);\nmsg.fat_c = String(msg.payload[1]['fat_cals']);\nmsg.fat_p = String(msg.payload[1]['fat_per100g']);\nmsg.fiber = String(msg.payload[1]['fiber']);\nmsg.protein = String(msg.payload[1]['protein']);\nmsg.sat_f = String(msg.payload[1][\"saturated_fat\"])\nmsg.sat_p = String(msg.payload[1]['saturates_per100g']);\nmsg.ser_z = String(msg.payload[1]['serving_size']);\nmsg.ser_p = String(msg.payload[1]['servings_per_recipe']);\nmsg.sod = String(msg.payload[1]['sodium']);\nmsg.salt_p = String(msg.payload[1]['salt_per100g']);\nmsg.sug = String(msg.payload[1]['sugar']);\nmsg.sug_p = String(msg.payload[1]['sugar_per100g']);\nmsg.to_car = String(msg.payload[1]['total_carbohydrates']);\nmsg.to_fat = String(msg.payload[1]['total_fat']);\n\n \nfor(var i in msg.payload){\n        itr1 = true;\n        for (var j in msg.data2){\n        if(msg.payload[i]['instruction']==msg.data2[j]){\n            itr1 = false;\n            break;}\n        }\n        if(itr1){\n            msg.data2.push(msg.payload[i]['instruction']);\n            msg.data.push(msg.payload[i]['instruction_number']);\n        }\n        \n        itr1 = true;\n        for (var l in msg.tag1){\n        if(msg.payload[i]['tags']==msg.tag1[l]){\n            itr1 = false;\n            break;}\n        }\n        if(itr1){msg.tag1.push(msg.payload[i]['tags'])}\n        \n        itr1 = true;\n        for (var m in msg.ing1){\n        if(msg.payload[i]['ingredients']==msg.ing1[m]){\n            itr1 = false;\n            break;}\n        }\n        if(itr1){msg.ing1.push(msg.payload[i]['ingredients'])}\n        \n}\n\nfor (var h in msg.data2){\n    msg.data2[h] = msg.data2[h].replace(/,/g, \" \");\n}\n\nfor (var h1 in msg.ing1){\n    msg.ing1[h1] = msg.ing1[h1].replace(/,/g, \" \");\n}\nreturn msg;","outputs":1,"noerr":0,"x":770,"y":1480,"wires":[["f54ab2e7.94609","48fbf98f.bfa358"]]},{"id":"87753af2.6753c8","type":"debug","z":"c0a64af3.88a468","name":"","active":true,"tosidebar":false,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":1090,"y":1560,"wires":[]},{"id":"1d03045b.02fa2c","type":"debug","z":"c0a64af3.88a468","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"select","targetType":"msg","x":470,"y":1580,"wires":[]},{"id":"ea376ce0.98077","type":"http in","z":"c0a64af3.88a468","name":"","url":"/recipe","method":"get","upload":false,"swaggerDoc":"","x":90,"y":1640,"wires":[["52d6281f.cb6bf8"]]},{"id":"6719ef.a5aec61","type":"http response","z":"c0a64af3.88a468","name":"","x":1210,"y":1640,"wires":[]},{"id":"61c1bf17.c1bca","type":"template","z":"c0a64af3.88a468","name":"HTML","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<html>\n    <head><script src=\"http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js\"></script></head>\n\t<body onload='list()'>\n\t\t<table border=\"5px\" style=\"width: 500px; font-size: 30px;\" id = \"table\">\n\t\t</table>\n\t\t<a href=\"/landin\" style=\"font-size: 30px;\">Go back to landin page</a>\n\t\t<script>{{{payload.script}}}</script>\n\t</body>\n</html>","x":1070,"y":1640,"wires":[["6719ef.a5aec61"]]},{"id":"3c9898bb.3f8478","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":470,"y":1640,"wires":[["6f07f05.94ec61"]]},{"id":"52d6281f.cb6bf8","type":"function","z":"c0a64af3.88a468","name":"test","func":"var select=\"SELECT instruction from instructions order by instruction_number asc\";\n\nmsg.topic = util.format(select);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":320,"y":1640,"wires":[["3c9898bb.3f8478"]]},{"id":"3ae648aa.16b828","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":630,"y":1720,"wires":[]},{"id":"be5b9bad.194278","type":"template","z":"c0a64af3.88a468","name":"Javascript","field":"payload.script","fieldType":"msg","format":"javascript","syntax":"mustache","template":"var array = \"{{data}}\"; //\"Cheese,Bread,Chocolate,Coconut\";\nvar array = array.split(\",\"); //[\"Cheese\", \"Bread\", \"Chocolate\", \"Coconut\"];\nHTML = \"<thread><td>Instructions</td></thread>\";\nfunction list(){\n    for(i=0; i < array.length; i++){\n        HTML += \"<tr><td>\" + array[i] + \"</td></tr>\";\n    }\n    document.getElementById(\"table\").innerHTML=HTML;\n}\n","output":"str","x":880,"y":1640,"wires":[["61c1bf17.c1bca"]]},{"id":"6f07f05.94ec61","type":"function","z":"c0a64af3.88a468","name":"format data","func":"msg.data = []\n\nreturn msg;","outputs":1,"noerr":0,"x":650,"y":1640,"wires":[["be5b9bad.194278","3ae648aa.16b828"]]},{"id":"d54696c.f24eb68","type":"http in","z":"c0a64af3.88a468","name":"","url":"/insert_comment","method":"post","upload":false,"swaggerDoc":"","x":120,"y":1800,"wires":[["87751dfa.6b9a4"]]},{"id":"76d8cefb.82e1b","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":690,"y":1800,"wires":[]},{"id":"87751dfa.6b9a4","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"//breakfast\nmsg.recipe = msg.payload.recipe;\nmsg.comment = msg.payload.comment;\n\n\nvar insert = \"INSERT INTO comment(username, recipe, comment) VALUES('%s', '%s', '%s')\";\n\nmsg.topic = util.format(insert, msg.req.cookies.id, msg.recipe, msg.comment);\n\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":1800,"wires":[["2f952fbd.41736"]]},{"id":"2f952fbd.41736","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":510,"y":1800,"wires":[["76d8cefb.82e1b"]]},{"id":"7b398fa8.3899a","type":"http in","z":"c0a64af3.88a468","name":"","url":"/load","method":"post","upload":false,"swaggerDoc":"","x":80,"y":1880,"wires":[["d2aba493.655d98"]]},{"id":"9fd5471.33315b8","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":890,"y":1880,"wires":[]},{"id":"d2aba493.655d98","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"//breakfast\nmsg.recipe = msg.payload.recipe;\n\nvar insert = \"SELECT username, comment, time FROM comment WHERE recipe = '%s' ORDER BY time desc\";\n\nmsg.topic = util.format(insert, msg.recipe);\n\nreturn msg;","outputs":1,"noerr":0,"x":290,"y":1880,"wires":[["4e4ae52a.eaa5bc"]]},{"id":"4e4ae52a.eaa5bc","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":510,"y":1880,"wires":[["1a32190e.8bfb87"]]},{"id":"1a32190e.8bfb87","type":"function","z":"c0a64af3.88a468","name":"format data","func":"msg.data = []\nmsg.data1 = []\nmsg.data2 = []\nfor(var i in msg.payload){\n    msg.data.push(msg.payload[i][\"username\"]);\n    msg.data1.push(msg.payload[i]['comment']);\n    msg.data2.push(msg.payload[i]['time']);\n}\nmsg.payload = {};\nmsg.payload[\"username\"] = msg.data;\nmsg.payload[\"comment\"] = msg.data1;\nmsg.payload[\"time\"] = msg.data2;\n\nreturn msg;","outputs":1,"noerr":0,"x":690,"y":1880,"wires":[["9fd5471.33315b8","2581bce4.cd5434"]]},{"id":"2581bce4.cd5434","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":710,"y":1960,"wires":[]},{"id":"27557e32.a63292","type":"http in","z":"c0a64af3.88a468","name":"","url":"/menu","method":"get","upload":false,"swaggerDoc":"","x":80,"y":2160,"wires":[["dfe4b90d.55b218"]]},{"id":"70a16ee5.7ab93","type":"http response","z":"c0a64af3.88a468","name":"","x":2850,"y":2160,"wires":[]},{"id":"ef737371.1f1d1","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1130,"y":2160,"wires":[["70e7d12a.49cee"]]},{"id":"e2f288fa.5ec2e8","type":"function","z":"c0a64af3.88a468","name":"test","func":"var select=\"SELECT recipe, title from menu join recipes on recipe = id where username = '%s' and type = 'b'\";\n\nmsg.topic = util.format(select, msg.req.cookies.id);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":980,"y":2160,"wires":[["ef737371.1f1d1"]]},{"id":"25a2a251.211b9e","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1490,"y":2220,"wires":[]},{"id":"c1985a0d.ce8da8","type":"template","z":"c0a64af3.88a468","name":"Javascript","field":"payload.script","fieldType":"msg","format":"javascript","syntax":"mustache","template":"/*var array = \"{{data}}\"; //\nvar array = array.split(\",\"); \n \nHTML = \"<thread><td>Recipes</td></thread>\";\n//HTML += \"<tr><td>\" + array + \"</td></tr>\";\n\nfunction list(){\n    for(i=0; i < array.length; i++){\n        HTML += \"<tr><td>\" + array[i] + \"</td></tr>\";\n    }\n    document.getElementById(\"table\").innerHTML=HTML;\n}*/\n\nvar arrayb = \"{{datab}}\"; //[\"Cheese\", \"Bread\", \"Chocolate\", \"Coconut\"];\nvar arrayb = arrayb.split(\",\");\nvar array2b = \"{{data2b}}\"; //[\"Cheese\", \"Bread\", \"Chocolate\", \"Coconut\"];\nvar array2b = array2b.split(\",\");\nfunction listb(){\n    HTML1 = \"\";\n    if(arrayb[0] !== \"\"){\n        for(i=0; i < arrayb.length; i++){\n            HTML1 += \"<tr><td>\" + arrayb[i] + \"</td>\";\n            HTML1 += \"<td><a  style = \\\"font-size:20px; cursor:pointer\\\" onclick=\\\"myFunction(array2b, \" + i +\", 'b');\\\"><u>Delete</u></a></td>\";\n            HTML1 += \"<td><div class=\\\"dropdown\\\"><button class=\\\"dropbtn\\\">Move to<i class=\\\"fa fa-caret-down\\\"></i></button><div class=\\\"dropdown-content\\\"><a style = \\\"font-size:20px; cursor:pointer\\\" onclick=\\\"movetoLunchAjax(array2b, \" + i +\", 'b');\\\"><u>Lunch</u></a><a style = \\\"font-size:20px; cursor:pointer\\\" onclick=\\\"movetoDinnerAjax(array2b, \" + i +\", 'b');\\\"><u>Dinner</u></a></div></div></td></tr>\"\n        }\n    }\n    document.getElementById(\"tableb\").innerHTML=HTML1;\n}\n\nvar arrayl = \"{{datal}}\"; //[\"Cheese\", \"Bread\", \"Chocolate\", \"Coconut\"];\nvar arrayl = arrayl.split(\",\");\nvar array2l = \"{{data2l}}\"; //[\"Cheese\", \"Bread\", \"Chocolate\", \"Coconut\"];\nvar array2l = array2l.split(\",\");\nfunction listl(){\n    HTML2 = \"\";\n    if(arrayl[0] !== \"\"){\n        for(i=0; i < arrayl.length; i++){\n            HTML2 += \"<tr><td>\" + arrayl[i] + \"</td>\";\n            HTML2 += \"<td><a  style = \\\"font-size:20px; cursor:pointer\\\" onclick=\\\"myFunction(array2l, \" + i +\", 'l');\\\"><u>Delete</u></a></td>\";\n            HTML2 += \"<td><div class=\\\"dropdown\\\"><button class=\\\"dropbtn\\\">Move to<i class=\\\"fa fa-caret-down\\\"></i></button><div class=\\\"dropdown-content\\\"><a style = \\\"font-size:20px; cursor:pointer\\\" onclick=\\\"movetoBreakfastAjax(array2l, \" + i +\", 'l');\\\"><u>Breakfast</u></a><a style = \\\"font-size:20px; cursor:pointer\\\" onclick=\\\"movetoDinnerAjax(array2l, \" + i +\", 'l');\\\"><u>Dinner</u></a></div></div></td></tr>\"\n            \n        }\n    }\n    document.getElementById(\"tablel\").innerHTML=HTML2;\n}\n\nvar arrayd = \"{{datad}}\"; //[\"Cheese\", \"Bread\", \"Chocolate\", \"Coconut\"];\nvar arrayd = arrayd.split(\",\");\nvar array2d = \"{{data2d}}\"; //[\"Cheese\", \"Bread\", \"Chocolate\", \"Coconut\"];\nvar array2d = array2d.split(\",\");\nfunction listd(){\n    HTML = \"\";\n    if(arrayd[0] !== \"\"){\n        for(i=0; i < arrayd.length; i++){\n            HTML += \"<tr><td>\" + arrayd[i] + \"</td>\";\n            HTML += \"<td><a  style = \\\"font-size:20px; cursor:pointer\\\" onclick=\\\"myFunction(array2d, \" + i +\", 'd');\\\"><u>Delete</u></a></td>\";\n            HTML += \"<td><div class=\\\"dropdown\\\"><button class=\\\"dropbtn\\\">Move to<i class=\\\"fa fa-caret-down\\\"></i></button><div class=\\\"dropdown-content\\\"><a style = \\\"font-size:20px; cursor:pointer\\\" onclick=\\\"movetoBreakfastAjax(array2d, \" + i +\", 'd');\\\"><u>Breakfast</u></a><a style = \\\"font-size:20px; cursor:pointer\\\" onclick=\\\"movetoLunchAjax(array2d, \" + i +\", 'd');\\\"><u>Lunch</u></a></div></div></td></tr>\"\n        }\n    }\n    document.getElementById(\"tabled\").innerHTML=HTML;\n}\n\nfunction deleteAjax(array, i, type) {\n    message = array[i];\n    $.ajax({\n        type: 'POST',\n        url: \"/delete_menu\",\n        data: {\"name\": message, \"type\": type},\n        success: function(returnhtml){\n            window.location = \"/menu\";\n            //$(\"#result\").html(returnhtml);\n            //$(\"#loadingimg\").hide();\n        }\n   });\n    \n}\n\nfunction movetoBreakfastAjax(array, i, type) {\n    message = array[i];\n    $.ajax({\n        type: 'POST',\n        url: \"/move_Breakfast\",\n        data: {\"name\": message, \"type\": type},\n        success: function(returnhtml){\n            window.location = \"/menu\";\n            //$(\"#result\").html(returnhtml);\n            //$(\"#loadingimg\").hide();\n        }\n   });\n    \n}\n\nfunction movetoLunchAjax(array, i, type) {\n    message = array[i];\n    $.ajax({\n        type: 'POST',\n        url: \"/move_Lunch\",\n        data: {\"name\": message, \"type\": type},\n        success: function(returnhtml){\n            window.location = \"/menu\";\n            //$(\"#result\").html(returnhtml);\n            //$(\"#loadingimg\").hide();\n        }\n   });\n    \n}\n\nfunction movetoDinnerAjax(array, i, type) {\n    message = array[i];\n    $.ajax({\n        type: 'POST',\n        url: \"/move_Dinner\",\n        data: {\"name\": message, \"type\": type},\n        success: function(returnhtml){\n            window.location = \"/menu\";\n            //$(\"#result\").html(returnhtml);\n            //$(\"#loadingimg\").hide();\n        }\n   });\n    \n}\n\nfunction myFunction(array, i, type) {\n    var txt;\n    var r = confirm(\"Are you sure you want to delete this recipe from menu\");\n    if (r === true) {\n        deleteAjax(array, i, type);\n    } else {\n        window.location = \"/menu\";\n    }\n}\n\narray = arrayb.concat(arrayl.concat(arrayd));\narray2 = array2b.concat(array2l.concat(array2d));\nHTML3 = \"\";\nfunction linklist(){\n    for(i=0; i < array.length; i++){\n        HTML3 += \"<a style = \\\"padding: 6px 0px 6px 0px;\\\" href='recipe/\" + array2[i] + \"'>\" + array[i] + \"</a>\";\n    }\n    document.getElementById(\"recipes-dropdown\").innerHTML=HTML3;\n}\n","output":"str","x":2560,"y":2160,"wires":[["2f09936d.3813ac"]]},{"id":"70e7d12a.49cee","type":"function","z":"c0a64af3.88a468","name":"format data","func":"msg.datab = []\nmsg.data2b = []\nfor(var i in msg.payload){\n    if(msg.payload[i]['title'] !== \"\"){\n        msg.datab.push(msg.payload[i]['title']);\n        msg.data2b.push(msg.payload[i]['recipe']);\n    }\n}\nreturn msg;","outputs":1,"noerr":0,"x":1310,"y":2160,"wires":[["de61622f.39ff5","25a2a251.211b9e"]]},{"id":"b087c004.3f9f4","type":"http in","z":"c0a64af3.88a468","name":"","url":"/menu/ingredients","method":"get","upload":false,"swaggerDoc":"","x":110,"y":2280,"wires":[["e84af706.39cf18"]]},{"id":"ffab0c7f.974f8","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1190,"y":2280,"wires":[["f12f4b93.d50418"]]},{"id":"bbf011e9.fe046","type":"function","z":"c0a64af3.88a468","name":"test","func":"var select=\"SELECT ingredient, type, checked from menu_ingr where username = '%s'\";\n\nmsg.topic = util.format(select, msg.req.cookies.id);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":1010,"y":2280,"wires":[["ffab0c7f.974f8"]]},{"id":"833c5f8f.4b83d","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1550,"y":2340,"wires":[]},{"id":"f12f4b93.d50418","type":"function","z":"c0a64af3.88a468","name":"format data","func":"msg.datab = [];\nmsg.data2b = [];\nmsg.datal = [];\nmsg.data2l = [];\nmsg.datad = [];\nmsg.data2d = [];\n\nfor(var i in msg.payload){\n    if(msg.payload[i]['type']  == \"b\"){\n        msg.datab.push(msg.payload[i]['ingredient'].replace(/@/g, \"'\").replace(/,/g, \"@\"));\n        msg.data2b.push(msg.payload[i]['checked']);\n    } else if(msg.payload[i]['type']  == \"l\"){\n        msg.datal.push(msg.payload[i]['ingredient'].replace(/@/g, \"'\").replace(/,/g, \"@\"));\n        msg.data2l.push(msg.payload[i]['checked']);\n    } else {\n        msg.datad.push(msg.payload[i]['ingredient'].replace(/@/g, \"'\").replace(/,/g, \"@\"));\n        msg.data2d.push(msg.payload[i]['checked']);\n    }\n\n}\nreturn msg;","outputs":1,"noerr":0,"x":1360,"y":2280,"wires":[["833c5f8f.4b83d","259b5a32.6995a6"]]},{"id":"9119b7c6.841c18","type":"http response","z":"c0a64af3.88a468","name":"","x":2430,"y":2280,"wires":[]},{"id":"d90e2372.98d01","type":"template","z":"c0a64af3.88a468","name":"Javascript","field":"payload.script","fieldType":"msg","format":"javascript","syntax":"mustache","template":"var arrayb = \"{{datab}}\"; //\nvar arrayb = arrayb.split(\",\"); \nvar arrayl = \"{{datal}}\"; //\nvar arrayl = arrayl.split(\",\"); \nvar arrayd = \"{{datad}}\"; //\nvar arrayd = arrayd.split(\",\"); \n\nvar array2b = \"{{data2b}}\"; //\nvar array2b = array2b.split(\",\"); \nvar array2l = \"{{data2l}}\"; //\nvar array2l = array2l.split(\",\"); \nvar array2d = \"{{data2d}}\"; //\nvar array2d = array2d.split(\",\"); \n\nvar array2 = \"{{data2}}\"; //\nvar array2 = array2.split(\",\"); \nvar array3 = \"{{data3}}\"; //\nvar array3 = array3.split(\",\"); \n\nfunction listb(){\n    HTML = \"\";\n    for(i=0; i < arrayb.length; i++){\n        if(array2b[i] == 0){\n            HTML += \"<li>\" + arrayb[i].replace(/@/g, \",\") + \"</li>\";\n        } else {\n            HTML += \"<li class = 'checked'>\" + arrayb[i].replace(/@/g, \",\") + \"</li>\";\n        }\n    }\n    document.getElementById(\"myULb\").innerHTML=HTML;\n}\n\nfunction listl(){\n    HTML1 = \"\";\n    for(i=0; i < arrayl.length; i++){\n        if(array2l[i] == 0){\n            HTML1 += \"<li>\" + arrayl[i].replace(/@/g, \",\") + \"</li>\";\n        } else {\n            HTML1 += \"<li class = 'checked'>\" + arrayl[i].replace(/@/g, \",\") + \"</li>\";\n        }\n    }\n    document.getElementById(\"myULl\").innerHTML=HTML1;\n}\n\nfunction listd(){\n    HTML3 = \"\";\n    for(i=0; i < arrayd.length; i++){\n        if(array2d[i] == 0){\n            HTML3 += \"<li>\" + arrayd[i].replace(/@/g, \",\") + \"</li>\";\n        } else {\n            HTML3 += \"<li class = 'checked'>\" + arrayd[i].replace(/@/g, \",\") + \"</li>\";\n        }\n    }\n    document.getElementById(\"myULd\").innerHTML=HTML3;\n}\n\nHTML2 = \"\";\nfunction linklist(){\n    for(i=0; i < array2.length; i++){\n        HTML2 += \"<a style = \\\"padding: 6px 0px 6px 0px;\\\" href='/recipe/\" + array3[i] + \"'>\" + array2[i] + \"</a>\";\n    }\n    document.getElementById(\"recipes-dropdown\").innerHTML=HTML2;\n}\n\nfunction changeb(ingr){\n    message = ingr;\n    $.ajax({\n        type: 'POST',\n        url: \"/change_ingr_stat\",\n        data: {\"name\": message, \"type\": \"b\"},\n        success: function(returnhtml){\n            //window.location = \"/menu/ingredients\";\n            //$(\"#result\").html(returnhtml);\n            //$(\"#loadingimg\").hide();\n        }\n   });\n}\n\nfunction changel(ingr){\n    message = ingr;\n    $.ajax({\n        type: 'POST',\n        url: \"/change_ingr_stat\",\n        data: {\"name\": message, \"type\": \"l\"},\n        success: function(returnhtml){\n            //window.location = \"/menu/ingredients\";\n            //$(\"#result\").html(returnhtml);\n            //$(\"#loadingimg\").hide();\n        }\n   });\n}\n\nfunction changed(ingr){\n    message = ingr;\n    $.ajax({\n        type: 'POST',\n        url: \"/change_ingr_stat\",\n        data: {\"name\": message, \"type\": \"d\"},\n        success: function(returnhtml){\n            //window.location = \"/menu/ingredients\";\n            //$(\"#result\").html(returnhtml);\n            //$(\"#loadingimg\").hide();\n        }\n   });\n}\n\nvar myNodelist = document.getElementsByTagName(\"LI\");\nvar i;\nfor (i = 0; i < myNodelist.length; i++) {\n  var span = document.createElement(\"SPAN\");\n  var txt = document.createTextNode(\"\\u00D7\");\n  span.className = \"close\";\n  span.appendChild(txt);\n  myNodelist[i].appendChild(span);\n}\n\n// Click on a close button to hide the current list item\nvar close = document.getElementsByClassName(\"close\");\nvar i;\nfor (i = 0; i < close.length; i++) {\n  close[i].onclick = function() {\n    var div = this.parentElement;\n    div.style.display = \"none\";\n  }\n}\n\n// Add a \"checked\" symbol when clicking on a list item\nvar list = document.querySelectorAll('ul');\nlist[0].addEventListener('click', function(ev) {\n  if (ev.target.tagName === 'LI') {\n    ev.target.classList.toggle('checked');\n    changeb(ev.target.innerHTML);\n  }\n}, false);\n\nlist[1].addEventListener('click', function(ev) {\n  if (ev.target.tagName === 'LI') {\n    ev.target.classList.toggle('checked');\n    changel(ev.target.innerHTML);\n  }\n}, false);\n\nlist[2].addEventListener('click', function(ev) {\n  if (ev.target.tagName === 'LI') {\n    ev.target.classList.toggle('checked');\n    changed(ev.target.innerHTML);\n  }\n}, false);\n\n// Create a new list item when clicking on the \"Add\" button\nfunction newElement() {\n  var li = document.createElement(\"li\");\n  var inputValue = document.getElementById(\"myInput\").value;\n  var t = document.createTextNode(inputValue);\n  li.appendChild(t);\n  if (inputValue === '') {\n    alert(\"You must write something!\");\n  } else {\n    document.getElementById(\"myUL\").appendChild(li);\n  }\n  document.getElementById(\"myInput\").value = \"\";\n\n  var span = document.createElement(\"SPAN\");\n  var txt = document.createTextNode(\"\\u00D7\");\n  span.className = \"close\";\n  span.appendChild(txt);\n  li.appendChild(span);\n\n  for (i = 0; i < close.length; i++) {\n    close[i].onclick = function() {\n      var div = this.parentElement;\n      div.style.display = \"none\";\n    }\n  }\n}","output":"str","x":2100,"y":2280,"wires":[["2735b260.904b5e"]]},{"id":"ff0ae36e.3b9ce","type":"http in","z":"c0a64af3.88a468","name":"","url":"/menu/nutrients","method":"get","upload":false,"swaggerDoc":"","x":110,"y":2420,"wires":[["2192a95c.5783a6"]]},{"id":"c3befbcb.b092d8","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1180,"y":2420,"wires":[["75fbfeb6.daaaf"]]},{"id":"953f5153.816fe","type":"function","z":"c0a64af3.88a468","name":"test","func":"var select=\"SELECT title, id from menu join recipes on recipe = id where username = '%s'\";\n\nmsg.topic = util.format(select, msg.req.cookies.id);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":1020,"y":2420,"wires":[["c3befbcb.b092d8"]]},{"id":"bbecebdb.1ee758","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1560,"y":2480,"wires":[]},{"id":"75fbfeb6.daaaf","type":"function","z":"c0a64af3.88a468","name":"format data","func":"msg.data = []\nmsg.data1 = []\nfor(var i in msg.payload){\n    msg.data.push(msg.payload[i]['title']);\n    msg.data1.push(msg.payload[i]['id']);\n\n}\nreturn msg;","outputs":1,"noerr":0,"x":1370,"y":2420,"wires":[["bbecebdb.1ee758","89756e05.d5889"]]},{"id":"fe21aa60.6f8e88","type":"http response","z":"c0a64af3.88a468","name":"","x":1880,"y":2420,"wires":[]},{"id":"89756e05.d5889","type":"template","z":"c0a64af3.88a468","name":"Javascript","field":"payload.script","fieldType":"msg","format":"javascript","syntax":"mustache","template":"diction = {};\ndiction[\"calories\"] = \"calories\";\ndiction[\"fat\"] = \"total_fat\";\ndiction[\"carbohydrate\"] = \"total_carbohydrates\";\ndiction[\"protein\"] = \"protein\";\ndiction[\"All\"] = \"a\";\ndiction[\"Breakfast\"] = \"b\";\ndiction[\"Lunch\"] = \"l\";\ndiction[\"Dinner\"] = \"d\";\n\nfunction invoke_piechart(nut){\n    function get_sum(response) {\n        compare_piechart(nut, response);\n    }\n    $.ajax({\n        type: 'POST',\n        url: \"/sum_ajax\",\n        data: {\"name\": diction[nut]},\n        success: get_sum\n   });\n}\n\nfunction compare_piechart(name, data) {\ndocument.getElementById(\"name1\").innerHTML=name;\nvar sum = data.reduce(function(a, b){return a + b;}, 0);\nresult = [];\nfor(var i in data){\n    result.push(Math.round(data[i]/sum * 10000) / 100);\n}\n\nvar chart = new CanvasJS.Chart(\"chartContainer2\", {\n    theme: \"light2\",\n\tanimationEnabled: true,\n\ttitle: {\n\t\ttext: \"Total \" + name.charAt(0).toUpperCase() + name.slice(1) + \" Value compared by Meal\"\n\t},\n\tdata: [{\n\t\ttype: \"pie\",\n\t\tindexLabelFontSize: 18,\n\t\tradius: 120,\n\t\tindexLabel: \"{label} - {y}\",\n\t\tyValueFormatString: \"###0.0\\\"%\\\"\",\n\t\tclick: explodePie,\n\t\tdataPoints: [\n\t\t\t{ y: result[0], label: \"Breakfast\" },\n\t\t\t{ y: result[1], label: \"Lunch\"},\n\t\t\t{ y: result[2], label: \"Dinner\" }\n\t\t]\n\t}]\n});\nchart.render();\n\nfunction explodePie(e) {\n\tfor(var i = 0; i < e.dataSeries.dataPoints.length; i++) {\n\t\tif(i !== e.dataPointIndex)\n\t\t\te.dataSeries.dataPoints[i].exploded = false;\n\t}\n}\n}\n\nfunction nutrients_piechart(data) {\nvar sum = data.reduce(function(a, b){return a + b;}, 0);\nresult = [];\nfor(var i in data){\n    result.push(Math.round(data[i]/sum * 10000) / 100);\n}\n\nvar chart = new CanvasJS.Chart(\"chartContainer\", {\n\ttheme: \"light2\",\n\tanimationEnabled: true,\n\ttitle: {\n\t\ttext: \"Total nutrients in Recipes\"\n\t},\n\tdata: [{\n\t\ttype: \"pie\",\n\t\tindexLabelFontSize: 18,\n\t\tradius: 120,\n\t\tindexLabel: \"{label} - {y}\",\n\t\tyValueFormatString: \"###0.0\\\"%\\\"\",\n\t\tclick: explodePie,\n\t\tdataPoints: [\n\t\t\t{ y: result[0], label: \"Saturated Fat\" },\n\t\t\t{ y: result[1], label: \"Cholesterol\"},\n\t\t\t{ y: result[2], label: \"Fiber\" },\n\t\t\t{ y: result[3], label: \"Sodium\" },\n\t\t\t{ y: result[4], label: \"Sugar\" }\n\t\t]\n\t}]\n});\nchart.render();\n\nfunction explodePie(e) {\n\tfor(var i = 0; i < e.dataSeries.dataPoints.length; i++) {\n\t\tif(i !== e.dataPointIndex)\n\t\t\te.dataSeries.dataPoints[i].exploded = false;\n\t}\n}\n}\n\n$(document).ready(function() {\n\t javascriptCheck();\n\t invokerankAjax(\"calories\", \"desc\", \"All\");\n\t invokelistAjax(\"All\");\n\t invoke_piechart(\"calories\");\n});\n\nfunction javascriptCheck() {\n    $('#no-script').remove();\n}\n\nfunction invokerankAjax(nut, ord, type){\n    function list_rank(response) {\n        response[\"o_name\"] = nut;\n        response[\"name\"] = diction[nut];\n        response[\"order\"] = ord;\n        response[\"type\"] = type;\n        processOK(response);\n    }\n    $.ajax({\n        type: 'POST',\n        url: \"/rank_ajax\",\n        data: {\"name\": diction[nut], \"order\": ord, \"type\": diction[type]},\n        success: list_rank\n   });\n}\n\nfunction invokerankAjax_a(nut){\n    var type = document.getElementById(\"view\").innerHTML;\n    var ord = document.getElementById(\"order\").innerHTML;\n    invokerankAjax(nut, ord, type);\n}\n\nfunction invokerankAjax_b(ord){\n    var type = document.getElementById(\"view\").innerHTML;\n    var nut = document.getElementById(\"name\").innerHTML;\n    invokerankAjax(nut, ord, type);\n}\n\nfunction invokerankAjax_c(type){\n    var nut = document.getElementById(\"name\").innerHTML;\n    var ord = document.getElementById(\"order\").innerHTML;\n    invokerankAjax(nut, ord, type);\n}\n\nfunction processOK(response){\n    HTML = \"<tr><th colspan='2'>Ranking by Major Nutrient</th></tr><tr><th>Recipe</th><th>\" + response[\"o_name\"] + \"</th></tr>\";\n    for(i=0; i < response[\"recipe\"].length; i++){\n        if(response[\"value\"][i] !== null) {\n            HTML += \"<tr><td>\" + response[\"recipe\"][i] + \"</td><td>\" + response[\"value\"][i] + \"</td></tr>\";\n        }\n    }\n    if(response[\"sum\"][i] !== null) {\n        HTML += \"<tr><td>Total</td><td>\" + response[\"sum\"][0] + \"</td></tr>\";\n    }\n    document.getElementById(\"table\").innerHTML=HTML;\n    document.getElementById(\"name\").innerHTML=response[\"o_name\"];\n    document.getElementById(\"order\").innerHTML=response[\"order\"];\n    document.getElementById(\"view\").innerHTML=response[\"type\"];\n}\n\nfunction invokelistAjax(type){\n    function list_rank1(response) {\n        processOK1(response);\n    }\n    $.ajax({\n        type: 'POST',\n        url: \"/get_macro\",\n        data: {\"type\": diction[type]},\n        success: list_rank1\n   });\n}\n\nfunction processOK1(response){\n    data = [];\n    HTML1 = \"<tr><th colspan='2'>Total for Other Nutrients</th></tr><tr><th>Nutrient</th><th>Total Value</th></tr>\";\n    for(i=0; i < response[\"nutrients\"].length; i++){\n        if(response[response[\"key\"][i]] !== null) {\n            HTML1 += \"<tr><td>\" + response[\"nutrients\"][i] + \"</td><td>\" + response[response[\"key\"][i]] + \"</td></tr>\";\n        }\n        data.push(response[response[\"key\"][i]]);\n    }\n    HTML1 += \"</tr>\";\n    document.getElementById(\"table1\").innerHTML=HTML1;\n    nutrients_piechart(data);\n}\n\nvar array = \"{{data}}\"; //\nvar array = array.split(\",\"); \n\nvar array1 = \"{{data1}}\"; //\nvar array1 = array1.split(\",\"); \n\nHTML2 = \"\";\nfunction linklist(){\n    for(i=0; i < array.length; i++){\n        HTML2 += \"<a style = \\\"padding: 6px 0px 6px 0px;\\\" href='/recipe/\" + array1[i] + \"'>\" + array[i] + \"</a>\";\n    }\n    document.getElementById(\"recipes-dropdown\").innerHTML=HTML2;\n}\n\n","output":"str","x":1590,"y":2420,"wires":[["be0fe305.3a872"]]},{"id":"4e540e72.b38f2","type":"http in","z":"c0a64af3.88a468","name":"","url":"/menu/instructions","method":"get","upload":false,"swaggerDoc":"","x":120,"y":2560,"wires":[["7908986a.befdf8"]]},{"id":"1c21f1b6.e5c28e","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1230,"y":4100,"wires":[["fe997787.a6e2f8","da624242.fa54"]]},{"id":"e729956a.d15d88","type":"function","z":"c0a64af3.88a468","name":"test","func":"\nvar select=\"SELECT instruction_number, instruction, title, checked from recipes r, menu_ins where id = recipe and r.id = '%s' and username = '%s' and type = '%s' order by instruction_number asc\";\n\nmsg.topic = util.format(select, msg.id, msg.req.cookies.id, msg.type);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":1090,"y":4100,"wires":[["1c21f1b6.e5c28e"]]},{"id":"da624242.fa54","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1410,"y":4160,"wires":[]},{"id":"fe997787.a6e2f8","type":"function","z":"c0a64af3.88a468","name":"format data","func":"msg.data = [];\nmsg.data1 = [];\nmsg.data2 = [];\nmsg.data3 = msg.payload[0]['title'];\nfor(var i in msg.payload){\n    msg.data.push(msg.payload[i]['instruction'].replace(/@/g, \"'\").replace(/,/g, \"@\"));\n    msg.data1.push(msg.payload[i]['instruction_number']);\n    msg.data2.push(msg.payload[i]['checked']);\n}\nmsg.payload = {};\nmsg.payload[\"title\"] = msg.data3;\nmsg.payload[\"instruction_number\"] = msg.data1;\nmsg.payload[\"instruction\"] = msg.data;\nmsg.payload[\"checked\"] = msg.data2;\nreturn msg;","outputs":1,"noerr":0,"x":1410,"y":4100,"wires":[["27daf638.7b84da"]]},{"id":"f826cdb9.c3ada","type":"http response","z":"c0a64af3.88a468","name":"","x":1890,"y":2560,"wires":[]},{"id":"8a922318.d0a26","type":"template","z":"c0a64af3.88a468","name":"HTML","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<!--<html>\n    <head><script src=\"http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js\"></script></head>\n\t<body onload='list()'>\n        <button onclick=\"location.href = 'landin';\" id=\"landin_btn\" style=\"font-size: 20px\" > Back to Landin Page </button>\n\n\t\t<table border=\"5px\" style=\"width: 500px; font-size: 30px;\" id = \"table\">\n\t\t</table>\n\t\t<a href=\"/landin\" style=\"font-size: 30px;\">Go back to landin page</a>\n\t\t<script>{{{payload.script}}}</script>\n\t</body>\n</html>-->\n<!DOCTYPE html>\n<html>\n<head>\n    <script src=\"http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js\"></script>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\">\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"/template.css\">\n</head>\n<body onload='linklist()'>\n\n<div class=\"sidenav\">\n  <a href=\"/menu\">Daily Menu</a>\n  <a href=\"/menu/ingredients\">Ingredient List</a>\n  <a href=\"/menu/nutrients\">Nutrients</a>\n  <a href=\"/menu/instructions\">Instructions</a>\n  <button class=\"dropdown-btn\">Recipes \n    <i class=\"fa fa-caret-down\"></i>\n  </button>\n  <div class=\"dropdown-container\" id=\"recipes-dropdown\">\n  </div>\n  <a href=\"/user_profile\">User Profile</a>\n  <a href=\"/landin\">Recipe Search</a>\n  <a href=\"/farmers_market\">Market Search</a>\n</div>\n\n<div class=\"main\">\n        \n        <div id=\"myDIV\" class=\"header\">\n            <h2 style=\"font-size:35px;margin:5px\">Cooking Instructions</h2>\n        </div>\n        \n        <div id=\"myDIV\" class=\"header\" style=\"padding-top:0px; padding-left:0px\">\n            \n            <div class=\"dropdown\">\n    \t\t    <button class=\"dropbtn\" style=\"font-size:25px; font-weight:bold; width:210px; color:white\">Select Recipe<i class=\"fa fa-caret-down\"></i></button>\n    \t\t    <div class=\"dropdown-content\" id = \"drops\">\n                    <a style = \"font-size:20px; cursor:pointer\" onclick=\"invokerankAjax_a('calories')\"><u>Calories</u></a>\n                    <a style = \"font-size:20px; cursor:pointer\" onclick=\"invokerankAjax_a('fat')\"><u>Fat</u></a>\n                    <a style = \"font-size:20px; cursor:pointer\" onclick=\"invokerankAjax_a('carbohydrate')\"><u>Carbohydrate</u></a>\n                    <a style = \"font-size:20px; cursor:pointer\" onclick=\"invokerankAjax_a('protein')\"><u>Protein</u></a>\n                </div>\n            </div>\n            \n            <p id=\"name\" style=\"font-size:25px; font-weight:bold; margin:0; float:left; margin-left:10px; margin-right:15px\"></p>\n            \n            <div style=\"float:right\">\n                <div class=\"dropdown\">\n        \t\t    <button class=\"dropbtn\" style=\"font-size:25px; font-weight:bold; width:100px; color:white\">View<i class=\"fa fa-caret-down\"></i></button>\n        \t\t    <div class=\"dropdown-content\">\n                        <a style = \"font-size:20px; cursor:pointer\" onclick=\"invokerankAjax('calories', 'desc', 'Breakfast');invokelistAjax('Breakfast');invokeinsbar();invokeingrbar();\"><u>Breakfast</u></a>\n                        <a style = \"font-size:20px; cursor:pointer\" onclick=\"invokerankAjax('calories', 'desc', 'Lunch');invokelistAjax('Lunch');invokeinsbar();invokeingrbar();\"><u>Lunch</u></a>\n                        <a style = \"font-size:20px; cursor:pointer\" onclick=\"invokerankAjax('calories', 'desc', 'Dinner');invokelistAjax('Dinner');invokeinsbar();invokeingrbar();\"><u>Dinner</u></a>\n                    </div>\n                </div>\n                \n                <p id=\"view\" style=\"font-size:25px; font-weight:bold; margin:0; margin-left:10px; float:right\"></p>\n            </div>\n            <!--<p style=\"font-size:25px; font-weight:bold; margin:0; float:left; margin-left:10%\">Breakfast</p>\n            <p style=\"font-size:25px; font-weight:bold; margin:0; float:left; margin-left:30%\">Lunch</p>\n            <p style=\"font-size:25px; font-weight:bold; margin:0; float:right; margin-right:13%\">Dinner</p>-->\n        </div>\n        <div style=\"width:490px; float:right; padding-top:20px\">\n            <div id=\"app\"></div>\n            <div style=\"height:50px; padding-top:20px\">\n                <input type=\"text\" id=\"hour\" name=\"h\" placeholder=\"Hour\" style=\"width:100px; float:left; border:solid; border-radius:10px; margin-left:8px\"><div style=\"float:left; font-size:40px; margin-left:5px; margin-right:5px\">:</div>\n                <input type=\"text\" id=\"minute\" name=\"m\" placeholder=\"Minute\" style=\"width:100px; float:left; border:solid; border-radius:10px\"><div style=\"float:left; font-size:40px; margin-left:5px; margin-right:5px\">:</div>\n                <input type=\"text\" id=\"second\" name=\"s\" placeholder=\"Second\" style=\"width:100px; float:left; border:solid; border-radius:10px\">\n                <button onclick=\"restart();\" id=\"id_enter\" style=\"height:45px; width:80px; border-radius:10px; margin-left:50px; font-size:20px\">Start</button>\n            </div>\n        </div>\n        \n        \n\t\t<!--<table border=\"5px\" style=\"width: 500px; font-size: 30px; float:left\" id = \"table\">\n\t\t</table>-->\n\t\t\n\t\t<div style=\"width: 490px; float:left; margin-right:10px\">\n\t\t    <div style=\"width: 490px;\">\n\t\t        <h2 style=\"text-align:center;margin-bottom:0px\">Ingredient Progress Bar</h2>\n    \t\t</div>\n    \t\t<div style=\"width: 490px;\" id=\"ingrBar\">\n    \t\t</div>\n    \t\t<div style=\"width: 490px;\">\n\t\t        <h2 style=\"text-align:center;margin-bottom:0px\">Instruction Progress Bar</h2>\n    \t\t</div>\n    \t\t<div style=\"width: 490px;\" id=\"insBar\">\n    \t\t</div>\n\t\t</div>\n\t\t\n\t\t<ul style=\"width: 500px; float: left\" id=\"myULb\">\n        </ul>\n\t\t\n\t\t<script>{{{payload.script}}}</script>\n</div>\n\n<script>\n/* Loop through all dropdown buttons to toggle between hiding and showing its dropdown content - This allows the user to have multiple dropdowns without any conflict */\nvar dropdown = document.getElementsByClassName(\"dropdown-btn\");\nvar i;\n\nfor (i = 0; i < dropdown.length; i++) {\n  dropdown[i].addEventListener(\"click\", function() {\n  this.classList.toggle(\"active\");\n  var dropdownContent = this.nextElementSibling;\n  if (dropdownContent.style.display === \"block\") {\n  dropdownContent.style.display = \"none\";\n  } else {\n  dropdownContent.style.display = \"block\";\n  }\n  });\n}\n</script>\n\n</body>\n</html> ","x":1750,"y":2560,"wires":[["f826cdb9.c3ada"]]},{"id":"b6e19588.f3a308","type":"template","z":"c0a64af3.88a468","name":"Javascript","field":"payload.script","fieldType":"msg","format":"javascript","syntax":"mustache","template":"diction = {};\ndiction[\"calories\"] = \"calories\";\ndiction[\"fat\"] = \"total_fat\";\ndiction[\"carbohydrate\"] = \"total_carbohydrates\";\ndiction[\"protein\"] = \"protein\";\ndiction[\"All\"] = \"a\";\ndiction[\"Breakfast\"] = \"b\";\ndiction[\"Lunch\"] = \"l\";\ndiction[\"Dinner\"] = \"d\";\n\n$(document).ready(function() {\n\t document.getElementById(\"view\").innerHTML = \"Breakfast\";\n\t invokerankAjax(\"calories\", \"desc\", \"Breakfast\");\n\t invokeingrbar();\n\t invokeinsbar();\n\t enterbutton();\n});\n\nfunction enterbutton(){\n\n    $(function() {\n        $(\"input\").keypress(function (e) {\n        if ((e.which && e.which == 13) || (e.keyCode && e.keyCode == 13)) {\n             $('#id_enter').click();\n             return false;\n        } else {\n       return true;\n\t }\n     });\n    });\n\n}\n\nfunction invokeingrbar(){\n    var type = diction[document.getElementById(\"view\").innerHTML];\n    function list_rank3(response) {\n        ingrbar(response);\n    }\n    $.ajax({\n        type: 'POST',\n        url: \"/ingr_bar\",\n        data: {\"type\": type},\n        success: list_rank3\n   });\n}\n\nfunction ingrbar(response) {\n    HTML = \"\";\n    for(i=0; i < response[\"recipe\"].length; i++){\n        if(response[\"recipe\"][i] in response[\"percentage\"]) {\n            HTML += \"<p style='margin-left:15px;margin-bottom:3px;margin-top:10px'>\" + response[\"recipe\"][i] + \"</p>\";\n            HTML += \"<div class='container'><div class='skills css' style='background-color:#4CAF50; width:\" + response[\"percentage\"][response[\"recipe\"][i]].toString() + \"%'>\";\n            HTML += response[\"percentage\"][response[\"recipe\"][i]].toString() + \"%</div></div>\";\n        } else {\n            HTML += \"<p style='margin-left:15px;margin-bottom:3px;margin-top:10px'>\" + response[\"recipe\"][i] + \"</p>\";\n            HTML += \"<div class='container'><div class='skills css' style='background-color:#4CAF50; width:0%'>\";\n            HTML += \"0%</div></div>\";\n        }\n    }\n    document.getElementById(\"ingrBar\").innerHTML=HTML;\n}\n\nfunction invokeinsbar(){\n    var type = diction[document.getElementById(\"view\").innerHTML];\n    function list_rank2(response) {\n        insbar(response);\n    }\n    $.ajax({\n        type: 'POST',\n        url: \"/ins_bar\",\n        data: {\"type\": type},\n        success: list_rank2\n   });\n}\n\nfunction insbar(response) {\n    HTML = \"\";\n    for(i=0; i < response[\"recipe\"].length; i++){\n        if(response[\"recipe\"][i] in response[\"percentage\"]) {\n            HTML += \"<p style='margin-left:15px;margin-bottom:3px;margin-top:10px'>\" + response[\"recipe\"][i] + \"</p>\";\n            HTML += \"<div class='container'><div class='skills css' style='background-color:#4CAF50; width:\" + response[\"percentage\"][response[\"recipe\"][i]].toString() + \"%'>\";\n            HTML += response[\"percentage\"][response[\"recipe\"][i]].toString() + \"%</div></div>\";\n        } else {\n            HTML += \"<p style='margin-left:15px;margin-bottom:3px;margin-top:10px'>\" + response[\"recipe\"][i] + \"</p>\";\n            HTML += \"<div class='container'><div class='skills css' style='background-color:#4CAF50; width:0%'>\";\n            HTML += \"0%</div></div>\";\n        }\n    }\n    document.getElementById(\"insBar\").innerHTML=HTML;\n}\n\nfunction invokelistAjax(view) {\n    document.getElementById(\"view\").innerHTML = view;\n}\n\nfunction invokeinsAjax(id) {\n    var type = diction[document.getElementById(\"view\").innerHTML];\n    function list_rank1(response) {\n        listb(response);\n        document.getElementById(\"name\").innerHTML = response[\"title\"];\n    }\n    $.ajax({\n        type: 'POST',\n        url: \"/ins_ajax\",\n        data: {\"id\": id, \"type\": type},\n        success: list_rank1\n   });\n}\n\nfunction listb(response){\n    HTML = \"\";\n    for(i=0; i < response[\"instruction\"].length; i++){\n        if(response[\"checked\"][i] === 0){\n            HTML += \"<li>\" + response[\"instruction_number\"][i] + \". \" + response[\"instruction\"][i].replace(/@/g, \",\") + \"</li>\";\n        } else {\n            HTML += \"<li class = 'checked'>\" + response[\"instruction_number\"][i] + \". \" + response[\"instruction\"][i].replace(/@/g, \",\") + \"</li>\";\n        }\n    }\n    document.getElementById(\"myULb\").innerHTML=HTML;\n}\n\nfunction invokerankAjax(nut, ord, type){\n    function list_rank(response) {\n        response[\"o_name\"] = nut;\n        response[\"name\"] = diction[nut];\n        response[\"order\"] = ord;\n        response[\"type\"] = type;\n        processOK(response);\n    }\n    $.ajax({\n        type: 'POST',\n        url: \"/rank_ajax\",\n        data: {\"name\": diction[nut], \"order\": ord, \"type\": diction[type]},\n        success: list_rank\n   });\n}\n\nfunction processOK(response){\n    var HTML = \"\";\n    for(i=0; i < response[\"recipe\"].length; i++){\n        HTML += \"<a style = 'font-size:20px; cursor:pointer' onclick='invokeinsAjax(\\\"\"+ response[\"id\"][i] + \"\\\")'><u>\" + response[\"recipe\"][i] + \"</u></a>\";\n    }\n    document.getElementById(\"drops\").innerHTML=HTML;\n    invokeinsAjax(response[\"id\"][0]);\n}\n\nconst FULL_DASH_ARRAY = 283;\nconst WARNING_THRESHOLD = 10;\nconst ALERT_THRESHOLD = 5;\n\nconst COLOR_CODES = {\n  info: {\n    color: \"green\"\n  },\n  warning: {\n    color: \"orange\",\n    threshold: WARNING_THRESHOLD\n  },\n  alert: {\n    color: \"red\",\n    threshold: ALERT_THRESHOLD\n  }\n};\n\nvar TIME_LIMIT = 0;\nvar timePassed = 0;\nvar timeLeft = TIME_LIMIT;\nvar timerInterval = null;\nvar remainingPathColor = COLOR_CODES.info.color;\nvar hours = 0;\nvar minutes = 0;\nvar seconds = 0;\n\ndocument.getElementById(\"app\").innerHTML = `\n<div class=\"base-timer\" style=\"margin:auto\">\n  <svg class=\"base-timer__svg\" viewBox=\"0 0 100 100\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g class=\"base-timer__circle\">\n      <circle class=\"base-timer__path-elapsed\" cx=\"50\" cy=\"50\" r=\"45\"></circle>\n      <path\n        id=\"base-timer-path-remaining\"\n        stroke-dasharray=\"283\"\n        class=\"base-timer__path-remaining ${remainingPathColor}\"\n        d=\"\n          M 50, 50\n          m -45, 0\n          a 45,45 0 1,0 90,0\n          a 45,45 0 1,0 -90,0\n        \"\n      ></path>\n    </g>\n  </svg>\n  <span id=\"base-timer-label\" class=\"base-timer__label\">${formatTime(\n    timeLeft\n  )}</span>\n</div>\n`;\n\nfunction restart(){\n\nhours = parseInt(document.getElementById(\"hour\").value);\nminutes = parseInt(document.getElementById(\"minute\").value);\nseconds = parseInt(document.getElementById(\"second\").value);\n\nif(isNaN(hours)){\n    hours = 0;\n}\nif(isNaN(minutes)){\n    minutes = 0;\n}\nif(isNaN(seconds)){\n    seconds = 0;\n}\n\ntimePassed = 0;\nTIME_LIMIT = 3600*hours + 60*minutes + seconds;\ntimeLeft = TIME_LIMIT;\ntimerInterval = null;\nremainingPathColor = COLOR_CODES.info.color;\n\ndocument.getElementById(\"app\").innerHTML = `\n<div class=\"base-timer\" style=\"margin:auto\">\n  <svg class=\"base-timer__svg\" viewBox=\"0 0 100 100\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g class=\"base-timer__circle\">\n      <circle class=\"base-timer__path-elapsed\" cx=\"50\" cy=\"50\" r=\"45\"></circle>\n      <path\n        id=\"base-timer-path-remaining\"\n        stroke-dasharray=\"283\"\n        class=\"base-timer__path-remaining ${remainingPathColor}\"\n        d=\"\n          M 50, 50\n          m -45, 0\n          a 45,45 0 1,0 90,0\n          a 45,45 0 1,0 -90,0\n        \"\n      ></path>\n    </g>\n  </svg>\n  <span id=\"base-timer-label\" class=\"base-timer__label\">${formatTime(\n    timeLeft\n  )}</span>\n</div>\n`;\n\nstartTimer(timeLeft);\n}\n\nfunction onTimesUp() {\n  clearInterval(timerInterval);\n  document.getElementById(\"base-timer-label\").innerHTML = formatTime(\n      0\n    );\n}\n\nfunction startTimer(limit) {\n  timerInterval = setInterval(() => {\n    timePassed = timePassed += 1;\n    timeLeft = limit - timePassed;\n    document.getElementById(\"base-timer-label\").innerHTML = formatTime(\n      timeLeft\n    );\n    setCircleDasharray();\n    setRemainingPathColor(timeLeft);\n\n    if (timeLeft <= 0) {\n      onTimesUp();\n    }\n  }, 1000);\n}\n\nfunction formatTime(time) {\n  const hours = Math.floor(time / 3600);\n  let minutes = Math.floor(time / 60);\n  let seconds = time % 60;\n  \n  if (minutes < 10) {\n    minutes = `0${minutes}`;\n  }\n  \n  if (seconds < 10) {\n    seconds = `0${seconds}`;\n  }\n\n  return `${hours}:${minutes}:${seconds}`;\n}\n\nfunction setRemainingPathColor(timeLeft) {\n  const { alert, warning, info } = COLOR_CODES;\n  if (timeLeft <= alert.threshold) {\n    document\n      .getElementById(\"base-timer-path-remaining\")\n      .classList.remove(warning.color);\n    document\n      .getElementById(\"base-timer-path-remaining\")\n      .classList.add(alert.color);\n  } else if (timeLeft <= warning.threshold) {\n    document\n      .getElementById(\"base-timer-path-remaining\")\n      .classList.remove(info.color);\n    document\n      .getElementById(\"base-timer-path-remaining\")\n      .classList.add(warning.color);\n  }\n}\n\nfunction calculateTimeFraction() {\n  const rawTimeFraction = timeLeft / TIME_LIMIT;\n  return rawTimeFraction - (1 / TIME_LIMIT) * (1 - rawTimeFraction);\n}\n\nfunction setCircleDasharray() {\n  const circleDasharray = `${(\n    calculateTimeFraction() * FULL_DASH_ARRAY\n  ).toFixed(0)} 283`;\n  document\n    .getElementById(\"base-timer-path-remaining\")\n    .setAttribute(\"stroke-dasharray\", circleDasharray);\n}\n\nvar array = \"1,2,3,4,5,6,7,8\"; //\nvar array = array.split(\",\"); \nvar array1 = \"1,2,3,4,5,6,7,8\"; //\nvar array1 = array1.split(\",\"); \n\nvar array2 = \"1,2,3,4,5,6,7,8\"; //\nvar array2 = array2.split(\",\"); \n \nHTML = \"<thread><td></td><td>Instruction</td></thread>\";\n//HTML += \"<tr><td>\" + array + \"</td></tr>\";\n\nfunction listt(){\n    for(i=0; i < array.length; i++){\n        HTML += \"<tr><td>\" + array1[i] + \"</td><td>\" + array[i].replace(/@/g, \",\") + \"</td></tr>\";\n    }\n    document.getElementById(\"table\").innerHTML=HTML;\n}\n\nvar array = \"{{data}}\"; //\nvar array = array.split(\",\"); \n\nvar array1 = \"{{data1}}\"; //\nvar array1 = array1.split(\",\"); \n\nHTML2 = \"\";\nfunction linklist(){\n    for(i=0; i < array.length; i++){\n        HTML2 += \"<a style = \\\"padding: 6px 0px 6px 0px;\\\" href='/recipe/\" + array1[i] + \"'>\" + array[i] + \"</a>\";\n    }\n    document.getElementById(\"recipes-dropdown\").innerHTML=HTML2;\n}\n\nfunction change(ins, num){\n    message = ins;\n    var type = diction[document.getElementById(\"view\").innerHTML];\n    $.ajax({\n        type: 'POST',\n        url: \"/change_ins_stat\",\n        data: {\"name\": message, \"type\": type, \"number\": num},\n        success: function(returnhtml){\n            invokeinsbar();\n            //window.location = \"/menu/ingredients\";\n            //$(\"#result\").html(returnhtml);\n            //$(\"#loadingimg\").hide();\n        }\n   });\n}\n\nvar myNodelist = document.getElementsByTagName(\"LI\");\nvar i;\nfor (i = 0; i < myNodelist.length; i++) {\n  var span = document.createElement(\"SPAN\");\n  var txt = document.createTextNode(\"\\u00D7\");\n  span.className = \"close\";\n  span.appendChild(txt);\n  myNodelist[i].appendChild(span);\n}\n\n// Click on a close button to hide the current list item\nvar close = document.getElementsByClassName(\"close\");\nvar i;\nfor (i = 0; i < close.length; i++) {\n  close[i].onclick = function() {\n    var div = this.parentElement;\n    div.style.display = \"none\";\n  }\n}\n\n// Add a \"checked\" symbol when clicking on a list item\nvar list = document.querySelector('ul');\nlist.addEventListener('click', function(ev) {\n  if (ev.target.tagName === 'LI') {\n    ev.target.classList.toggle('checked');\n    var num = ev.target.innerHTML.substr(0,ev.target.innerHTML.indexOf('. ')); // \"72\"\n    var ins = ev.target.innerHTML.substr(ev.target.innerHTML.indexOf('. ')+2); \n    change(ins, num);\n  }\n}, false);\n\n// Create a new list item when clicking on the \"Add\" button\nfunction newElement() {\n  var li = document.createElement(\"li\");\n  var inputValue = document.getElementById(\"myInput\").value;\n  var t = document.createTextNode(inputValue);\n  li.appendChild(t);\n  if (inputValue === '') {\n    alert(\"You must write something!\");\n  } else {\n    document.getElementById(\"myUL\").appendChild(li);\n  }\n  document.getElementById(\"myInput\").value = \"\";\n\n  var span = document.createElement(\"SPAN\");\n  var txt = document.createTextNode(\"\\u00D7\");\n  span.className = \"close\";\n  span.appendChild(txt);\n  li.appendChild(span);\n\n  for (i = 0; i < close.length; i++) {\n    close[i].onclick = function() {\n      var div = this.parentElement;\n      div.style.display = \"none\";\n    }\n  }\n}","output":"str","x":1600,"y":2560,"wires":[["8a922318.d0a26"]]},{"id":"be0fe305.3a872","type":"template","z":"c0a64af3.88a468","name":"HTML","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<!--<html>\n    <head><script src=\"http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js\"></script></head>\n\t<body onload='list()'>\n        <button onclick=\"location.href = 'landin';\" id=\"landin_btn\" style=\"font-size: 20px\" > Back to Landin Page </button>\n\n\t\t<table border=\"5px\" style=\"width: 500px; font-size: 30px;\" id = \"table\">\n\t\t</table>\n\t\t<a href=\"/landin\" style=\"font-size: 30px;\">Go back to landin page</a>\n\t\t<script>{{{payload.script}}}</script>\n\t</body>\n</html>-->\n<!DOCTYPE html>\n<html>\n<head>\n    <script src=\"http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js\"></script>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\">\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"/template.css\">\n</head>\n<body onload='linklist()'>\n\n<div class=\"sidenav\">\n  <a href=\"/menu\">Daily Menu</a>\n  <a href=\"/menu/ingredients\">Ingredient List</a>\n  <a href=\"/menu/nutrients\">Nutrients</a>\n  <a href=\"/menu/instructions\">Instructions</a>\n  <button class=\"dropdown-btn\">Recipes \n    <i class=\"fa fa-caret-down\"></i>\n  </button>\n  <div class=\"dropdown-container\" id=\"recipes-dropdown\">\n  </div>\n  <a href=\"/user_profile\">User Profile</a>\n  <a href=\"/landin\">Recipe Search</a>\n  <a href=\"/farmers_market\">Market Search</a>\n</div>\n\n<div class=\"main\">\n    \n        <div id=\"myDIV\" class=\"header\">\n            <h2 style=\"font-size:35px;margin:5px\">Menu Nutrients</h2>\n        </div>\n        \n        <div id=\"myDIV\" class=\"header\" style=\"padding-top:0px; padding-left:0px\">\n            <div class=\"dropdown\">\n    \t\t    <button class=\"dropbtn\" style=\"font-size:25px; font-weight:bold; width:150px; color:white\">Rank by<i class=\"fa fa-caret-down\"></i></button>\n    \t\t    <div class=\"dropdown-content\">\n                    <a style = \"font-size:20px; cursor:pointer\" onclick=\"invokerankAjax_a('calories')\"><u>Calories</u></a>\n                    <a style = \"font-size:20px; cursor:pointer\" onclick=\"invokerankAjax_a('fat')\"><u>Fat</u></a>\n                    <a style = \"font-size:20px; cursor:pointer\" onclick=\"invokerankAjax_a('carbohydrate')\"><u>Carbohydrate</u></a>\n                    <a style = \"font-size:20px; cursor:pointer\" onclick=\"invokerankAjax_a('protein')\"><u>Protein</u></a>\n                </div>\n            </div>\n            \n            <p id=\"name\" style=\"font-size:25px; font-weight:bold; margin:0; float:left; margin-left:10px; margin-right:15px\"></p>\n            \n            <div class=\"dropdown\">\n    \t\t    <button class=\"dropbtn\" style=\"font-size:25px; font-weight:bold; width:150px; color:white\">Order<i class=\"fa fa-caret-down\"></i></button>\n    \t\t    <div class=\"dropdown-content\">\n                    <a style = \"font-size:20px; cursor:pointer\" onclick=\"invokerankAjax_b('asc')\"><u>asc</u></a>\n                    <a style = \"font-size:20px; cursor:pointer\" onclick=\"invokerankAjax_b('desc')\"><u>desc</u></a>\n                </div>\n            </div>\n            \n            <p id=\"order\" style=\"font-size:25px; font-weight:bold; margin:0; float:left; margin-left:10px; margin-right:160px\"></p>\n            \n            <div class=\"dropdown\">\n    \t\t    <button class=\"dropbtn\" style=\"font-size:25px; font-weight:bold; width:200px; color:white\">Compare by<i class=\"fa fa-caret-down\"></i></button>\n    \t\t    <div class=\"dropdown-content\">\n                    <a style = \"font-size:20px; cursor:pointer\" onclick=\"invoke_piechart('calories')\"><u>Calories</u></a>\n                    <a style = \"font-size:20px; cursor:pointer\" onclick=\"invoke_piechart('fat')\"><u>Fat</u></a>\n                    <a style = \"font-size:20px; cursor:pointer\" onclick=\"invoke_piechart('carbohydrate')\"><u>Carbohydrate</u></a>\n                    <a style = \"font-size:20px; cursor:pointer\" onclick=\"invoke_piechart('protein')\"><u>Protein</u></a>\n                </div>\n            </div>\n            \n            <p id=\"name1\" style=\"font-size:25px; font-weight:bold; margin:0; float:left; margin-left:10px; margin-right:15px\"></p>\n            \n            <div style=\"float:right\">\n                <div class=\"dropdown\">\n        \t\t    <button class=\"dropbtn\" style=\"font-size:25px; font-weight:bold; width:100px; color:white\">View<i class=\"fa fa-caret-down\"></i></button>\n        \t\t    <div class=\"dropdown-content\">\n                        <a style = \"font-size:20px; cursor:pointer\" onclick=\"invokerankAjax_c('Breakfast');invokelistAjax('Breakfast');\"><u>Breakfast</u></a>\n                        <a style = \"font-size:20px; cursor:pointer\" onclick=\"invokerankAjax_c('Lunch');invokelistAjax('Lunch');\"><u>Lunch</u></a>\n                        <a style = \"font-size:20px; cursor:pointer\" onclick=\"invokerankAjax_c('Dinner');invokelistAjax('Dinner');\"><u>Dinner</u></a>\n                        <a style = \"font-size:20px; cursor:pointer\" onclick=\"invokerankAjax_c('All');invokelistAjax('All');\"><u>All</u></a>\n                    </div>\n                </div>\n                \n                <p id=\"view\" style=\"font-size:25px; font-weight:bold; margin:0; margin-left:10px; float:right\"></p>\n            </div>\n            <!--<p style=\"font-size:25px; font-weight:bold; margin:0; float:left; margin-left:10%\">Breakfast</p>\n            <p style=\"font-size:25px; font-weight:bold; margin:0; float:left; margin-left:30%\">Lunch</p>\n            <p style=\"font-size:25px; font-weight:bold; margin:0; float:right; margin-right:13%\">Dinner</p>-->\n        </div>\n        \n        <div style=\"float:left; min-height:500px\">\n    \t\t<table border=\"5px\" style=\"width: 650px; font-size: 30px;\" id = \"table\">\n    \t\t</table>\n    \t\t\n    \t\t<div style=\"padding-top:20px\"></div>\n    \t\t\n    \t\t<table border=\"5px\" style=\"width: 650px; font-size: 30px;\" id = \"table1\">\n    \t\t</table>\n\t\t</div>\n\t\t\n\t\t<div style=\"width:850px\">\n    \t\t<div id=\"chartContainer2\" style=\"height: 370px; width: 100%;\"></div>\n    \t\t<div id=\"chartContainer\" style=\"height: 370px; width: 100%;\"></div>\n        </div>\n        <script src=\"https://canvasjs.com/assets/script/canvasjs.min.js\"></script>\n        \n\t\t\n\t\t<script>{{{payload.script}}}</script>\n</div>\n\n<script>\n/* Loop through all dropdown buttons to toggle between hiding and showing its dropdown content - This allows the user to have multiple dropdowns without any conflict */\nvar dropdown = document.getElementsByClassName(\"dropdown-btn\");\nvar i;\n\nfor (i = 0; i < dropdown.length; i++) {\n  dropdown[i].addEventListener(\"click\", function() {\n  this.classList.toggle(\"active\");\n  var dropdownContent = this.nextElementSibling;\n  if (dropdownContent.style.display === \"block\") {\n  dropdownContent.style.display = \"none\";\n  } else {\n  dropdownContent.style.display = \"block\";\n  }\n  });\n}\n</script>\n\n</body>\n</html> ","x":1750,"y":2420,"wires":[["fe21aa60.6f8e88"]]},{"id":"2735b260.904b5e","type":"template","z":"c0a64af3.88a468","name":"HTML","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<!--<html>\n    <head><script src=\"http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js\"></script></head>\n\t<body onload='list()'>\n        <button onclick=\"location.href = 'landin';\" id=\"landin_btn\" style=\"font-size: 20px\" > Back to Landin Page </button>\n\n\t\t<table border=\"5px\" style=\"width: 500px; font-size: 30px;\" id = \"table\">\n\t\t</table>\n\t\t<a href=\"/landin\" style=\"font-size: 30px;\">Go back to landin page</a>\n\t\t<script>{{{payload.script}}}</script>\n\t</body>\n</html>-->\n<!DOCTYPE html>\n<html>\n<head>\n    <script src=\"http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js\"></script>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\">\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"/template.css\">\n</head>\n<body onload='listb(); listl(); listd(); linklist()'>\n\n<div class=\"sidenav\">\n  <a href=\"/menu\">Daily Menu</a>\n  <a href=\"/menu/ingredients\">Ingredient List</a>\n  <a href=\"/menu/nutrients\">Nutrients</a>\n  <a href=\"/menu/instructions\">Instructions</a>\n  <button class=\"dropdown-btn\">Recipes \n    <i class=\"fa fa-caret-down\"></i>\n  </button>\n  <a href=\"/user_profile\">User Profile</a>\n  <div class=\"dropdown-container\" id=\"recipes-dropdown\">\n  </div>\n  <a href=\"/landin\">Recipe Search</a>\n  <a href=\"/farmers_market\">Market Search</a>\n</div>\n\n<div class=\"main\">\n\n\t\t<!--<table border=\"5px\" style=\"width: 500px; font-size: 30px;\" id = \"table\">\n\t\t</table>-->\n\t\t<div id=\"myDIV\" class=\"header\">\n            <h2 style=\"font-size:35px;margin:5px\">Ingredient List</h2>\n        </div>\n        \n        <div id=\"myDIV\" class=\"header\" style=\"padding-top:0px\">\n            <p style=\"font-size:25px; font-weight:bold; margin:0; float:left; margin-left:10%\">Breakfast</p>\n            <p style=\"font-size:25px; font-weight:bold; margin:0; float:left; margin-left:30%\">Lunch</p>\n            <p style=\"font-size:25px; font-weight:bold; margin:0; float:right; margin-right:13%\">Dinner</p>\n        </div>\n\n        <ul style=\"width: 495px; float: left\" id=\"myULb\">\n        </ul>\n        \n        <ul style=\"width: 495px; float: left; margin-left: 4px\" id=\"myULl\">\n        </ul>\n        \n        <ul style=\"width: 495px; float: right\" id=\"myULd\">\n        </ul>\n\t\t\n\t\t<script>{{{payload.script}}}</script>\n</div>\n\n<script>\n/* Loop through all dropdown buttons to toggle between hiding and showing its dropdown content - This allows the user to have multiple dropdowns without any conflict */\nvar dropdown = document.getElementsByClassName(\"dropdown-btn\");\nvar i;\n\nfor (i = 0; i < dropdown.length; i++) {\n  dropdown[i].addEventListener(\"click\", function() {\n  this.classList.toggle(\"active\");\n  var dropdownContent = this.nextElementSibling;\n  if (dropdownContent.style.display === \"block\") {\n  dropdownContent.style.display = \"none\";\n  } else {\n  dropdownContent.style.display = \"block\";\n  }\n  });\n}\n</script>\n\n</body>\n</html> ","x":2280,"y":2280,"wires":[["9119b7c6.841c18"]]},{"id":"2f09936d.3813ac","type":"template","z":"c0a64af3.88a468","name":"HTML","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<!--<html>\n    <head><script src=\"http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js\"></script></head>\n\t<body onload='list()'>\n        <button onclick=\"location.href = 'landin';\" id=\"landin_btn\" style=\"font-size: 20px\" > Back to Landin Page </button>\n\n\t\t<table border=\"5px\" style=\"width: 500px; font-size: 30px;\" id = \"table\">\n\t\t</table>\n\t\t<a href=\"/landin\" style=\"font-size: 30px;\">Go back to landin page</a>\n\t\t<script>{{{payload.script}}}</script>\n\t</body>\n</html>-->\n<!DOCTYPE html>\n<html>\n<head>\n    <script src=\"http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js\"></script>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\">\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"/template.css\">\n  </head>\n<body onload='listb(); listl(); listd(); linklist()'>\n\n<div class=\"sidenav\">\n  <a href=\"/menu\">Daily Menu</a>\n  <a href=\"/menu/ingredients\">Ingredient List</a>\n  <a href=\"/menu/nutrients\">Nutrients</a>\n  <a href=\"/menu/instructions\">Instructions</a>\n  <button class=\"dropdown-btn\">Recipes \n    <i class=\"fa fa-caret-down\"></i>\n  </button>\n  <a href=\"/user_profile\">User Profile</a>\n  <div class=\"dropdown-container\" id=\"recipes-dropdown\">\n  </div>\n  <a href=\"/landin\">Recipe Search</a>\n  <a href=\"/farmers_market\">Market Search</a>\n</div>\n\n<div class=\"main\">\n    \n        <div id=\"myDIV\" class=\"header\">\n            <h2 style=\"font-size:35px;margin:5px\">Daily Menu</h2>\n        </div>\n        \n        <div id=\"myDIV\" class=\"header\" style=\"padding-top:0px\">\n            <p style=\"font-size:25px; font-weight:bold; margin:0; float:left; margin-left:10%\">Breakfast</p>\n            <p style=\"font-size:25px; font-weight:bold; margin:0; float:left; margin-left:30%\">Lunch</p>\n            <p style=\"font-size:25px; font-weight:bold; margin:0; float:right; margin-right:13%\">Dinner</p>\n        </div>\n        <div style=\"float: left; width: 500px; font-size: 30px; min-height:500px\">\n    \t\t<table border=\"5px\" style=\"float: left; width: 500px; font-size: 30px\" id = \"tableb\">\n    \t\t</table>\n    \t</div>\n    \t<div style=\"float: left; width: 500px; font-size: 30px; min-height:300px\">\n    \t\t<table border=\"5px\" style=\"float: left; width: 500px; font-size: 30px\" id = \"tablel\">\n    \t\t</table>\n    \t</div>\n    \t<div style=\"float: left; width: 500px; font-size: 30px\">\n    \t\t<table border=\"5px\" style=\"width: 500px; font-size: 30px;\" id = \"tabled\">\n    \t\t</table>\n\t\t</div>\n\t\t\n\t\t<script>{{{payload.script}}}</script>\n</div>\n\n<script>\n/* Loop through all dropdown buttons to toggle between hiding and showing its dropdown content - This allows the user to have multiple dropdowns without any conflict */\nvar dropdown = document.getElementsByClassName(\"dropdown-btn\");\nvar i;\n\nfor (i = 0; i < dropdown.length; i++) {\n  dropdown[i].addEventListener(\"click\", function() {\n  this.classList.toggle(\"active\");\n  var dropdownContent = this.nextElementSibling;\n  if (dropdownContent.style.display === \"block\") {\n  dropdownContent.style.display = \"none\";\n  } else {\n  dropdownContent.style.display = \"block\";\n  }\n  });\n}\n</script>\n\n</body>\n</html> ","x":2710,"y":2160,"wires":[["70a16ee5.7ab93"]]},{"id":"79ad50e3.a93e3","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"// Find demo cookies and clear them\nvar select=\"DELETE from menu WHERE recipe = '%s' and username = '%s' and type = '%s';\";\nvar del = \"DELETE from menu_ingr WHERE recipe = '%s' and username = '%s' and type = '%s';\";\nvar del2 = \"DELETE from menu_ins WHERE recipe = '%s' and username = '%s' and type = '%s';\";\nselect = util.format(select, msg.payload.name, msg.req.cookies.id, msg.payload.type);\ndel = util.format(del, msg.payload.name, msg.req.cookies.id, msg.payload.type);\ndel2 = util.format(del2, msg.payload.name, msg.req.cookies.id, msg.payload.type);\nmsg.topic = select + del + del2;\nreturn msg;","outputs":1,"noerr":0,"x":430,"y":2720,"wires":[["5a72b4a2.6a5dfc"]]},{"id":"e107496f.663c08","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":1050,"y":2720,"wires":[]},{"id":"eb9790e6.8ff27","type":"change","z":"c0a64af3.88a468","name":"Redirect to /menu","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.location","pt":"msg","to":"/menu","tot":"str"},{"t":"set","p":"statusCode","pt":"msg","to":"302","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":830,"y":2720,"wires":[["e107496f.663c08"]]},{"id":"5a72b4a2.6a5dfc","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":630,"y":2720,"wires":[["eb9790e6.8ff27"]]},{"id":"77006f8e.5325e","type":"http in","z":"c0a64af3.88a468","name":"","url":"/delete_menu","method":"post","upload":false,"swaggerDoc":"","x":130,"y":2720,"wires":[["79ad50e3.a93e3"]]},{"id":"beed5927.803bf8","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1670,"y":2160,"wires":[["b0415da1.ea6c5"]]},{"id":"de61622f.39ff5","type":"function","z":"c0a64af3.88a468","name":"test","func":"var select=\"SELECT recipe, title from menu join recipes on recipe = id where username = '%s' and type = 'l'\";\n\nmsg.topic = util.format(select, msg.req.cookies.id);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":1520,"y":2160,"wires":[["beed5927.803bf8"]]},{"id":"b0415da1.ea6c5","type":"function","z":"c0a64af3.88a468","name":"format data","func":"msg.datal = []\nmsg.data2l = []\nfor(var i in msg.payload){\n    if(msg.payload[i]['title'] !== \"\"){\n        msg.datal.push(msg.payload[i]['title']);\n        msg.data2l.push(msg.payload[i]['recipe']);\n    }\n}\nreturn msg;","outputs":1,"noerr":0,"x":1850,"y":2160,"wires":[["25d1ded1.854772"]]},{"id":"fdc52927.cc7df8","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":2190,"y":2160,"wires":[["db573006.ac00b"]]},{"id":"25d1ded1.854772","type":"function","z":"c0a64af3.88a468","name":"test","func":"var select=\"SELECT recipe, title from menu join recipes on recipe = id where username = '%s' and type = 'd'\";\n\nmsg.topic = util.format(select, msg.req.cookies.id);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":2040,"y":2160,"wires":[["fdc52927.cc7df8"]]},{"id":"db573006.ac00b","type":"function","z":"c0a64af3.88a468","name":"format data","func":"msg.datad = []\nmsg.data2d = []\nfor(var i in msg.payload){\n    if(msg.payload[i]['title'] !== \"\"){\n        msg.datad.push(msg.payload[i]['title']);\n        msg.data2d.push(msg.payload[i]['recipe']);\n    }\n}\nreturn msg;","outputs":1,"noerr":0,"x":2370,"y":2160,"wires":[["c1985a0d.ce8da8"]]},{"id":"f5a23816.53b128","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"// Find demo cookies and clear them\nvar select=\"Update menu set type = 'l' WHERE recipe = '%s' and username = '%s' and type = '%s';\";\nvar select2=\"Update menu_ingr set type = 'l' WHERE recipe = '%s' and username = '%s' and type = '%s';\";\nvar select3=\"Update menu_ins set type = 'l' WHERE recipe = '%s' and username = '%s' and type = '%s';\";\nselect = util.format(select, msg.name, msg.req.cookies.id, msg.type);\nselect2 = util.format(select2, msg.name, msg.req.cookies.id, msg.type);\nselect3 = util.format(select3, msg.name, msg.req.cookies.id, msg.type);\nmsg.topic = select + select2 + select3;\n\nreturn msg;","outputs":1,"noerr":0,"x":1070,"y":2840,"wires":[["b5bd87b0.bd21d8"]]},{"id":"c2b2cfd8.ccee4","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":1690,"y":2840,"wires":[]},{"id":"af361130.9ec47","type":"change","z":"c0a64af3.88a468","name":"Redirect to /menu","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.location","pt":"msg","to":"/menu","tot":"str"},{"t":"set","p":"statusCode","pt":"msg","to":"302","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":1470,"y":2840,"wires":[["c2b2cfd8.ccee4"]]},{"id":"b5bd87b0.bd21d8","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1270,"y":2840,"wires":[["af361130.9ec47"]]},{"id":"fdd803ce.a9584","type":"http in","z":"c0a64af3.88a468","name":"","url":"/move_Lunch","method":"post","upload":false,"swaggerDoc":"","x":130,"y":2840,"wires":[["224c3e16.1952f2"]]},{"id":"e8d50b41.788158","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"// Find demo cookies and clear them\nvar select=\"Update menu set type = 'd' WHERE recipe = '%s' and username = '%s' and type = '%s';\";\nvar select2=\"Update menu_ingr set type = 'd' WHERE recipe = '%s' and username = '%s' and type = '%s';\";\nvar select3=\"Update menu_ins set type = 'd' WHERE recipe = '%s' and username = '%s' and type = '%s';\";\nselect = util.format(select, msg.name, msg.req.cookies.id, msg.type);\nselect2 = util.format(select2, msg.name, msg.req.cookies.id, msg.type);\nselect3 = util.format(select3, msg.name, msg.req.cookies.id, msg.type);\nmsg.topic = select + select2 + select3;\n\nreturn msg;","outputs":1,"noerr":0,"x":1070,"y":2920,"wires":[["370b7198.ea519e"]]},{"id":"5cf19c94.9c4ba4","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":1690,"y":2920,"wires":[]},{"id":"a7ea3e27.f5fda","type":"change","z":"c0a64af3.88a468","name":"Redirect to /menu","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.location","pt":"msg","to":"/menu","tot":"str"},{"t":"set","p":"statusCode","pt":"msg","to":"302","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":1470,"y":2920,"wires":[["5cf19c94.9c4ba4"]]},{"id":"370b7198.ea519e","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1270,"y":2920,"wires":[["a7ea3e27.f5fda"]]},{"id":"8baac437.0bdd18","type":"http in","z":"c0a64af3.88a468","name":"","url":"/move_Dinner","method":"post","upload":false,"swaggerDoc":"","x":130,"y":2900,"wires":[["4b475a8b.832ef4"]]},{"id":"3ab1a90c.e5d3f6","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"// Find demo cookies and clear them\nvar select=\"Update menu set type = 'b' WHERE recipe = '%s' and username = '%s' and type = '%s';\";\nvar select2=\"Update menu_ingr set type = 'b' WHERE recipe = '%s' and username = '%s' and type = '%s';\";\nvar select3=\"Update menu_ins set type = 'b' WHERE recipe = '%s' and username = '%s' and type = '%s';\";\nselect = util.format(select, msg.name, msg.req.cookies.id, msg.type);\nselect2 = util.format(select2, msg.name, msg.req.cookies.id, msg.type);\nselect3 = util.format(select3, msg.name, msg.req.cookies.id, msg.type);\nmsg.topic = select + select2 + select3;\n\nreturn msg;","outputs":1,"noerr":0,"x":1070,"y":2760,"wires":[["276de975.a0fcb6"]]},{"id":"5f5eefdd.2c55d","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":1690,"y":2760,"wires":[]},{"id":"c2577d4f.adbb7","type":"change","z":"c0a64af3.88a468","name":"Redirect to /menu","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.location","pt":"msg","to":"/menu","tot":"str"},{"t":"set","p":"statusCode","pt":"msg","to":"302","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":1470,"y":2760,"wires":[["5f5eefdd.2c55d"]]},{"id":"276de975.a0fcb6","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1270,"y":2760,"wires":[["c2577d4f.adbb7","fcf537b9.d9d5a8"]]},{"id":"d18b8c69.9149f","type":"http in","z":"c0a64af3.88a468","name":"","url":"/move_Breakfast","method":"post","upload":false,"swaggerDoc":"","x":140,"y":2780,"wires":[["e06383b9.f0eb5"]]},{"id":"8f60e6f3.7e9068","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"//breakfast\n\nvar select=\"SELECT distinct ingredients from ingredient where id = '%s'\";\n\nmsg.topic = util.format(select, msg.name);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":1470,"y":3000,"wires":[["e0c877d8.49ccd8"]]},{"id":"10d4241a.09fadc","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":2850,"y":3000,"wires":[]},{"id":"e0c877d8.49ccd8","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1650,"y":3000,"wires":[["44862549.78a80c","e3742c0.3b649d8"]]},{"id":"10b5e1.192b6a2","type":"http in","z":"c0a64af3.88a468","name":"","url":"/addToMenu","method":"post","upload":false,"swaggerDoc":"","x":130,"y":3000,"wires":[["df4510a2.c8eb"]]},{"id":"44862549.78a80c","type":"function","z":"c0a64af3.88a468","name":"format data","func":"var insert = \"\";\nfor(var i in msg.payload){\n    tmp = \"INSERT INTO menu_ingr VALUES ('%s', '%s', '%s', '%s', 0);\";\n    insert += util.format(tmp, msg.req.cookies.id, msg.name, msg.payload[i]['ingredients'].replace(/'/g, \"@\"), msg.type);\n}\nmsg.topic = insert;\n\nreturn msg;","outputs":1,"noerr":0,"x":1810,"y":3000,"wires":[["b701c3e7.77e06","893b2be8.f5dfd8"]]},{"id":"b701c3e7.77e06","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1990,"y":3000,"wires":[["6eaf9408.6b0b6c"]]},{"id":"5a281154.04f41","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"//breakfast\n\nvar insert = \"INSERT INTO menu VALUES('%s', '%s', '%s')\";\n\nmsg.topic = util.format(insert, msg.req.cookies.id, msg.name, msg.type);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":1090,"y":3000,"wires":[["a5ac1491.65b528"]]},{"id":"a5ac1491.65b528","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1290,"y":3000,"wires":[["8f60e6f3.7e9068"]]},{"id":"d8a88c4e.81443","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":870,"y":3180,"wires":[]},{"id":"893b2be8.f5dfd8","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2110,"y":3060,"wires":[]},{"id":"e3742c0.3b649d8","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1850,"y":3060,"wires":[]},{"id":"a8b1f65f.d30718","type":"function","z":"c0a64af3.88a468","name":"format data","func":"msg.data2 = []\nmsg.data3 = []\nfor(var i in msg.payload){\n    msg.data2.push(msg.payload[i]['title']);\n    msg.data3.push(msg.payload[i]['id']);\n\n}\nreturn msg;","outputs":1,"noerr":0,"x":1900,"y":2280,"wires":[["d90e2372.98d01"]]},{"id":"95ed2a67.41aea8","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1720,"y":2280,"wires":[["a8b1f65f.d30718"]]},{"id":"259b5a32.6995a6","type":"function","z":"c0a64af3.88a468","name":"test","func":"var select=\"SELECT title, id from menu join recipes on recipe = id where username = '%s'\";\n\nmsg.topic = util.format(select, msg.req.cookies.id);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":1570,"y":2280,"wires":[["95ed2a67.41aea8"]]},{"id":"32f38f05.d85b3","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"// Find demo cookies and clear them\nvar select=\"select checked from menu_ingr where username = '%s' and ingredient = '%s' and type = '%s'\";\nmsg.topic = util.format(select, msg.req.cookies.id, msg.name.replace(/'/g, \"@\"), msg.type);\n\nreturn msg;","outputs":1,"noerr":0,"x":1090,"y":3200,"wires":[["d2744da5.e8402"]]},{"id":"da64f39a.3df53","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":2330,"y":3200,"wires":[]},{"id":"dacde464.db0b18","type":"change","z":"c0a64af3.88a468","name":"Redirect to /menu","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.location","pt":"msg","to":"/menu/ingredients","tot":"str"},{"t":"set","p":"statusCode","pt":"msg","to":"302","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":2110,"y":3200,"wires":[["da64f39a.3df53"]]},{"id":"d2744da5.e8402","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1290,"y":3200,"wires":[["618334b.e0172cc"]]},{"id":"711f38f3.dc0b78","type":"http in","z":"c0a64af3.88a468","name":"","url":"/change_ingr_stat","method":"post","upload":false,"swaggerDoc":"","x":140,"y":3240,"wires":[["ba433fcc.93391","898fea67.1c8e78"]]},{"id":"618334b.e0172cc","type":"switch","z":"c0a64af3.88a468","name":"","property":"payload[0][\"checked\"]","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"eq","v":"1","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1510,"y":3200,"wires":[["5f37ba51.01dd14"],["ff0f145a.adce38"]]},{"id":"5f37ba51.01dd14","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"// Find demo cookies and clear them\nvar select=\"update menu_ingr set checked = 1 where username = '%s' and ingredient = '%s' and type = '%s'\";\nmsg.topic = util.format(select, msg.req.cookies.id, msg.name.replace(/'/g, \"@\"), msg.type);\n\nreturn msg;","outputs":1,"noerr":0,"x":1690,"y":3140,"wires":[["8d6ea9a8.f4a9b8"]]},{"id":"8d6ea9a8.f4a9b8","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1890,"y":3140,"wires":[["dacde464.db0b18"]]},{"id":"ff0f145a.adce38","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"// Find demo cookies and clear them\nvar select=\"update menu_ingr set checked = 0 where username = '%s' and ingredient = '%s' and type = '%s'\";\nmsg.topic = util.format(select, msg.req.cookies.id, msg.name.replace(/'/g, \"@\"), msg.type);\n\nreturn msg;","outputs":1,"noerr":0,"x":1690,"y":3260,"wires":[["a36abba2.7313f8"]]},{"id":"a36abba2.7313f8","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1890,"y":3260,"wires":[["dacde464.db0b18"]]},{"id":"ba433fcc.93391","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":410,"y":3320,"wires":[]},{"id":"b6f41b60.0432f8","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":2110,"y":3660,"wires":[]},{"id":"a248f55e.5d6678","type":"http in","z":"c0a64af3.88a468","name":"","url":"/rank_ajax","method":"post","upload":false,"swaggerDoc":"","x":120,"y":3660,"wires":[["1c091f08.d26051"]]},{"id":"f66823c5.b3274","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1250,"y":3660,"wires":[["451d4b51.94a784"]]},{"id":"807945a9.32f8e8","type":"function","z":"c0a64af3.88a468","name":"test","func":"\nvar add = \"and type = '%s'\";\nif(msg.type !== \"a\"){\n    add = util.format(add, msg.type);\n} else {\n    add = \"\"\n}\n\nvar select=\"SELECT id, title, %s from menu join recipes on recipe = id where username = '%s' \" + add + \" order by %s %s\";\n\nmsg.topic = util.format(select, msg.name, msg.req.cookies.id, msg.name, msg.order);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":1090,"y":3660,"wires":[["f66823c5.b3274","6d089a36.c68644"]]},{"id":"6d089a36.c68644","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1270,"y":3720,"wires":[]},{"id":"451d4b51.94a784","type":"function","z":"c0a64af3.88a468","name":"format data","func":"msg.data = []\nmsg.data1 = []\nmsg.data3 = []\nfor(var i in msg.payload){\n    msg.data.push(msg.payload[i][msg.name]);\n    msg.data1.push(msg.payload[i]['title']);\n    msg.data3.push(msg.payload[i]['id']);\n\n}\nreturn msg;","outputs":1,"noerr":0,"x":1440,"y":3660,"wires":[["a4918bca.34dc68"]]},{"id":"560565b.e5c5e9c","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1750,"y":3660,"wires":[["bd18955.3436968"]]},{"id":"a4918bca.34dc68","type":"function","z":"c0a64af3.88a468","name":"test","func":"var add = \" and type = '%s'\";\nif(msg.type !== \"a\"){\n    add = util.format(add, msg.type);\n} else {\n    add = \"\";\n}\n\nvar select=\"SELECT round(sum(%s), 2) count from menu join recipes on recipe = id where username = '%s'\" + add;\n\nmsg.topic = util.format(select, msg.name, msg.req.cookies.id);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":1610,"y":3660,"wires":[["560565b.e5c5e9c"]]},{"id":"bd18955.3436968","type":"function","z":"c0a64af3.88a468","name":"format data","func":"msg.data2 = []\n\nfor(var i in msg.payload){\n    msg.data2.push(msg.payload[i]['count']);\n}\n\nmsg.payload = {};\nmsg.payload[\"recipe\"] = msg.data1;\nmsg.payload[\"value\"] = msg.data;\nmsg.payload[\"sum\"] = msg.data2;\nmsg.payload[\"id\"] = msg.data3;\nreturn msg;","outputs":1,"noerr":0,"x":1930,"y":3660,"wires":[["b6f41b60.0432f8"]]},{"id":"380a592f.5c0dc6","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":1650,"y":3820,"wires":[]},{"id":"48436cf7.e90764","type":"http in","z":"c0a64af3.88a468","name":"","url":"/get_macro","method":"post","upload":false,"swaggerDoc":"","x":120,"y":3820,"wires":[["c1d5de15.00b0a"]]},{"id":"112432c3.c95a1d","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1370,"y":3880,"wires":[]},{"id":"56dd4e20.1d9be","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1230,"y":3820,"wires":[["680f1098.d3dae"]]},{"id":"72cfb86a.fafef8","type":"function","z":"c0a64af3.88a468","name":"test","func":"var add = \" and type = '%s'\";\nif(msg.type !== \"a\"){\n    add = util.format(add, msg.type);\n} else {\n    add = \"\";\n}\n\nvar select=\"SELECT round(sum(cholesterol), 2) cholesterol, round(sum(sodium), 2) sodium, round(sum(saturated_fat), 2) saturated_fat, round(sum(fiber), 2) fiber, round(sum(sugar), 2) sugar from menu join recipes on recipe = id where username = '%s'\" + add;\n\nmsg.topic = util.format(select, msg.req.cookies.id);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":1090,"y":3820,"wires":[["56dd4e20.1d9be","112432c3.c95a1d"]]},{"id":"680f1098.d3dae","type":"function","z":"c0a64af3.88a468","name":"format data","func":"result = {};\nresult[\"cholesterol\"] = msg.payload[0]['cholesterol'];\nresult[\"saturated_fat\"] = msg.payload[0]['saturated_fat'];\nresult[\"sodium\"] = msg.payload[0]['sodium'];\nresult[\"fiber\"] = msg.payload[0]['fiber'];\nresult[\"sugar\"] = msg.payload[0]['sugar'];\nresult[\"key\"] = [\"saturated_fat\", \"cholesterol\", \"fiber\", \"sodium\", \"sugar\"];\nresult[\"nutrients\"] = [\"Saturated Fat\", \"Cholesterol\", \"Fiber\", \"Sodium\", \"Sugar\"];\nmsg.payload = result;\nreturn msg;","outputs":1,"noerr":0,"x":1410,"y":3820,"wires":[["380a592f.5c0dc6"]]},{"id":"4b8363d.ec6f29c","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":2630,"y":3980,"wires":[]},{"id":"1bd30eef.ac6911","type":"http in","z":"c0a64af3.88a468","name":"","url":"/sum_ajax","method":"post","upload":false,"swaggerDoc":"","x":120,"y":3980,"wires":[["f76cb3d.979005"]]},{"id":"b9c8c34d.8e1f9","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1250,"y":3980,"wires":[["5746de41.950a1"]]},{"id":"cef80ed9.f82ca","type":"function","z":"c0a64af3.88a468","name":"test","func":"msg.name =msg.name;\n\nvar select=\"SELECT round(sum(%s), 2) count from menu join recipes on recipe = id where username = '%s' and type = 'b'\";\n\nmsg.topic = util.format(select, msg.name, msg.req.cookies.id);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":1090,"y":3980,"wires":[["b9c8c34d.8e1f9"]]},{"id":"5746de41.950a1","type":"function","z":"c0a64af3.88a468","name":"format data","func":"msg.result = [];\n\nfor(var i in msg.payload){\n    msg.result.push(msg.payload[i]['count']);\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":1430,"y":3980,"wires":[["1ecc70f1.881ccf"]]},{"id":"31d9e951.9d1016","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1730,"y":3980,"wires":[["4515cad4.bb7424"]]},{"id":"1ecc70f1.881ccf","type":"function","z":"c0a64af3.88a468","name":"test","func":"var select=\"SELECT round(sum(%s), 2) count from menu join recipes on recipe = id where username = '%s' and type = 'l'\";\n\nmsg.topic = util.format(select, msg.name, msg.req.cookies.id);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":1590,"y":3980,"wires":[["31d9e951.9d1016"]]},{"id":"4515cad4.bb7424","type":"function","z":"c0a64af3.88a468","name":"format data","func":"for(var i in msg.payload){\n    msg.result.push(msg.payload[i]['count']);\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":1910,"y":3980,"wires":[["9ce28998.091e08"]]},{"id":"12246894.e9da27","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":2270,"y":3980,"wires":[["b2099879.ec72d8"]]},{"id":"9ce28998.091e08","type":"function","z":"c0a64af3.88a468","name":"test","func":"var select=\"SELECT round(sum(%s), 2) count from menu join recipes on recipe = id where username = '%s' and type = 'd'\";\n\nmsg.topic = util.format(select, msg.name, msg.req.cookies.id);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":2110,"y":3980,"wires":[["12246894.e9da27"]]},{"id":"b2099879.ec72d8","type":"function","z":"c0a64af3.88a468","name":"format data","func":"for(var i in msg.payload){\n    msg.result.push(msg.payload[i]['count']);\n}\n\nmsg.payload = msg.result;\n\nreturn msg;","outputs":1,"noerr":0,"x":2450,"y":3980,"wires":[["4b8363d.ec6f29c"]]},{"id":"2f1a2604.b3273a","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1190,"y":2560,"wires":[["1b36414b.9d357f"]]},{"id":"cfec14a6.2fdc98","type":"function","z":"c0a64af3.88a468","name":"test","func":"var select=\"SELECT title, id from menu join recipes on recipe = id where username = '%s'\";\n\nmsg.topic = util.format(select, msg.req.cookies.id);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":1030,"y":2560,"wires":[["2f1a2604.b3273a"]]},{"id":"71863f23.6f755","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1570,"y":2620,"wires":[]},{"id":"1b36414b.9d357f","type":"function","z":"c0a64af3.88a468","name":"format data","func":"msg.data = []\nmsg.data1 = []\nfor(var i in msg.payload){\n    msg.data.push(msg.payload[i]['title']);\n    msg.data1.push(msg.payload[i]['id']);\n\n}\nreturn msg;","outputs":1,"noerr":0,"x":1380,"y":2560,"wires":[["71863f23.6f755","b6e19588.f3a308"]]},{"id":"273d069b.f35e4a","type":"http in","z":"c0a64af3.88a468","name":"","url":"/ins_ajax","method":"post","upload":false,"swaggerDoc":"","x":120,"y":4100,"wires":[["7c6b7d0c.330174"]]},{"id":"27daf638.7b84da","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":1630,"y":4100,"wires":[]},{"id":"fdc039fa.51d218","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":2710,"y":3000,"wires":[["10d4241a.09fadc"]]},{"id":"a0a27cf5.d1199","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2530,"y":3140,"wires":[]},{"id":"e69d6a7.0910898","type":"function","z":"c0a64af3.88a468","name":"format data","func":"var insert = \"\";\nfor(var i in msg.payload){\n    tmp = \"INSERT INTO menu_ins VALUES ('%s', '%s', '%s', '%s', '%s', 0);\";\n    insert += util.format(tmp, msg.req.cookies.id, msg.name, msg.payload[i]['instruction_number'], msg.payload[i]['instruction'].replace(/'/g, \"@\"), msg.type);\n}\nmsg.topic = insert;\n\nreturn msg;","outputs":1,"noerr":0,"x":2530,"y":3000,"wires":[["fdc039fa.51d218"]]},{"id":"632aa99c.5f7ea8","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":2350,"y":3000,"wires":[["e69d6a7.0910898","a0a27cf5.d1199"]]},{"id":"6eaf9408.6b0b6c","type":"function","z":"c0a64af3.88a468","name":"test","func":"msg.id = msg.payload.id;\n\nvar select=\"SELECT distinct instruction_number, instruction, title from recipes r, menu join instructions i on recipe = i.id where r.id = recipe and r.id = '%s' and username = '%s' order by instruction_number asc\";\n\nmsg.topic = util.format(select, msg.name, msg.req.cookies.id);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":2190,"y":3000,"wires":[["632aa99c.5f7ea8"]]},{"id":"dc15d1a3.45bff","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"// Find demo cookies and clear them\nvar select=\"select checked from menu_ins where username = '%s' and instruction = '%s' and type = '%s' and instruction_number = %s\";\nmsg.topic = util.format(select, msg.req.cookies.id, msg.name.replace(/'/g, \"@\"), msg.type, parseInt(msg.number));\n\nreturn msg;","outputs":1,"noerr":0,"x":1090,"y":3480,"wires":[["dcd6fc03.5a753","5fd0942d.be9d4c"]]},{"id":"a3296223.83d47","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":2330,"y":3480,"wires":[]},{"id":"92cab9dc.59a118","type":"change","z":"c0a64af3.88a468","name":"Redirect to /menu","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.location","pt":"msg","to":"/menu/ingredients","tot":"str"},{"t":"set","p":"statusCode","pt":"msg","to":"302","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":2110,"y":3480,"wires":[["a3296223.83d47"]]},{"id":"dcd6fc03.5a753","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1290,"y":3480,"wires":[["268ae125.46832e"]]},{"id":"686ac06c.dafcd","type":"http in","z":"c0a64af3.88a468","name":"","url":"/change_ins_stat","method":"post","upload":false,"swaggerDoc":"","x":140,"y":3460,"wires":[["25a70464.7df5bc"]]},{"id":"268ae125.46832e","type":"switch","z":"c0a64af3.88a468","name":"","property":"payload[0][\"checked\"]","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"eq","v":"1","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1510,"y":3480,"wires":[["168fa2b1.c8b95d"],["d6f1f544.511878"]]},{"id":"168fa2b1.c8b95d","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"// Find demo cookies and clear them\nvar select=\"update menu_ins set checked = 1 where username = '%s' and instruction = '%s' and type = '%s' and instruction_number = %s\";\nmsg.topic = util.format(select, msg.req.cookies.id, msg.name.replace(/'/g, \"@\"), msg.type, parseInt(msg.number));\n\nreturn msg;","outputs":1,"noerr":0,"x":1690,"y":3420,"wires":[["626a68a5.7bfbf8","5c29f36c.990dbc"]]},{"id":"626a68a5.7bfbf8","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1890,"y":3420,"wires":[["92cab9dc.59a118"]]},{"id":"d6f1f544.511878","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"// Find demo cookies and clear them\nvar select=\"update menu_ins set checked = 0 where username = '%s' and instruction = '%s' and type = '%s' and instruction_number = %s\";\nmsg.topic = util.format(select, msg.req.cookies.id, msg.name.replace(/'/g, \"@\"), msg.type, parseInt(msg.number));\n\nreturn msg;","outputs":1,"noerr":0,"x":1690,"y":3540,"wires":[["3f22e918.333a26"]]},{"id":"3f22e918.333a26","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1890,"y":3540,"wires":[["92cab9dc.59a118"]]},{"id":"5c29f36c.990dbc","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1950,"y":3360,"wires":[]},{"id":"c9201b54.8d4158","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"// Find demo cookies and clear them\nvar select=\"select title, count(*) count0 from menu_ins, recipes where recipe = id and username = '%s' and type = '%s' and checked = 0 group by title order by title asc\";\nmsg.topic = util.format(select, msg.req.cookies.id, msg.type);\n\nreturn msg;","outputs":1,"noerr":0,"x":1090,"y":4260,"wires":[["c97a5fe3.45e61"]]},{"id":"f1dde8c9.b6b698","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":2870,"y":4260,"wires":[]},{"id":"c97a5fe3.45e61","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1290,"y":4260,"wires":[["31555e9.dc0eda2"]]},{"id":"38e80801.665e88","type":"http in","z":"c0a64af3.88a468","name":"","url":"/ins_bar","method":"post","upload":false,"swaggerDoc":"","x":110,"y":4260,"wires":[["ef2ecbc2.f26ef8"]]},{"id":"cf92b47c.31a3f8","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2870,"y":4340,"wires":[]},{"id":"31555e9.dc0eda2","type":"function","z":"c0a64af3.88a468","name":"format data","func":"msg.data1 = {};\nfor(var i in msg.payload){\n    msg.data1[msg.payload[i]['title']] = msg.payload[i]['count0'];\n}\nreturn msg;","outputs":1,"noerr":0,"x":1450,"y":4260,"wires":[["23ced1df.6edd3e"]]},{"id":"23ced1df.6edd3e","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"// Find demo cookies and clear them\nvar select=\"select title, count(*) count1 from menu_ins, recipes where recipe = id and username = '%s' and type = '%s' and checked = 1 group by title order by title asc\";\nmsg.topic = util.format(select, msg.req.cookies.id, msg.type);\n\nreturn msg;","outputs":1,"noerr":0,"x":1670,"y":4260,"wires":[["73cc1ea6.bb49c"]]},{"id":"73cc1ea6.bb49c","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1870,"y":4260,"wires":[["d157a102.d9352"]]},{"id":"d157a102.d9352","type":"function","z":"c0a64af3.88a468","name":"format data","func":"msg.data2 = {};\nfor(var i in msg.payload){\n    if(msg.payload[i]['title'] in msg.data1){\n        msg.data2[msg.payload[i]['title']] = Math.round(100*msg.payload[i]['count1']/(msg.payload[i]['count1']+msg.data1[msg.payload[i]['title']]));\n    } else {\n        msg.data2[msg.payload[i]['title']] = 100;\n    }\n}\n\nmsg.payload = msg.data2;\nreturn msg;","outputs":1,"noerr":0,"x":2070,"y":4260,"wires":[["31a76127.47788e"]]},{"id":"31a76127.47788e","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"// Find demo cookies and clear them\nvar select=\"select distinct title from menu_ins, recipes where recipe = id and username = '%s' and type = '%s' order by title asc\";\nmsg.topic = util.format(select, msg.req.cookies.id, msg.type);\n\nreturn msg;","outputs":1,"noerr":0,"x":2290,"y":4260,"wires":[["8ce81d1.73947e"]]},{"id":"8ce81d1.73947e","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":2490,"y":4260,"wires":[["20f5c234.17871e"]]},{"id":"20f5c234.17871e","type":"function","z":"c0a64af3.88a468","name":"format data","func":"msg.data = [];\nfor(var i in msg.payload){\n    msg.data.push([msg.payload[i]['title']]);\n}\nmsg.payload = {};\nmsg.payload[\"recipe\"] = msg.data;\nmsg.payload[\"percentage\"] = msg.data2;\nreturn msg;","outputs":1,"noerr":0,"x":2690,"y":4260,"wires":[["f1dde8c9.b6b698","cf92b47c.31a3f8"]]},{"id":"d3845df7.aa8fa","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"// Find demo cookies and clear them\nvar select=\"select title, count(*) count0 from menu_ingr, recipes where recipe = id and username = '%s' and type = '%s' and checked = 0 group by title order by title asc\";\nmsg.topic = util.format(select, msg.req.cookies.id, msg.type);\n\nreturn msg;","outputs":1,"noerr":0,"x":1090,"y":4400,"wires":[["51fdf774.8f2c38"]]},{"id":"3b894b92.b5d264","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":2810,"y":4400,"wires":[]},{"id":"51fdf774.8f2c38","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1290,"y":4400,"wires":[["3121967f.4c44aa"]]},{"id":"1c6e3ced.18fc03","type":"http in","z":"c0a64af3.88a468","name":"","url":"/ingr_bar","method":"post","upload":false,"swaggerDoc":"","x":120,"y":4420,"wires":[["28533032.a332c"]]},{"id":"12711ec0.b376b1","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2050,"y":4460,"wires":[]},{"id":"3121967f.4c44aa","type":"function","z":"c0a64af3.88a468","name":"format data","func":"msg.data1 = {};\nfor(var i in msg.payload){\n    msg.data1[msg.payload[i]['title']] = msg.payload[i]['count0'];\n}\nreturn msg;","outputs":1,"noerr":0,"x":1450,"y":4400,"wires":[["25dc720d.f3fa5e"]]},{"id":"25dc720d.f3fa5e","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"// Find demo cookies and clear them\nvar select=\"select title, count(*) count1 from menu_ingr, recipes where recipe = id and username = '%s' and type = '%s' and checked = 1 group by title order by title asc\";\nmsg.topic = util.format(select, msg.req.cookies.id, msg.type);\n\nreturn msg;","outputs":1,"noerr":0,"x":1650,"y":4400,"wires":[["8dd8b932.bcd5a8"]]},{"id":"8dd8b932.bcd5a8","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":1830,"y":4400,"wires":[["564bb3fd.480e0c","12711ec0.b376b1"]]},{"id":"564bb3fd.480e0c","type":"function","z":"c0a64af3.88a468","name":"format data","func":"msg.data2 = {};\nfor(var i in msg.payload){\n    if(msg.payload[i]['title'] in msg.data1){\n        msg.data2[msg.payload[i]['title']] = Math.round(100*msg.payload[i]['count1']/(msg.payload[i]['count1']+msg.data1[msg.payload[i]['title']]));\n    } else {\n        msg.data2[msg.payload[i]['title']] = 100;\n    }\n}\n\nmsg.payload = msg.data2;\nreturn msg;","outputs":1,"noerr":0,"x":2030,"y":4400,"wires":[["d9bf6e04.7e52b"]]},{"id":"d9bf6e04.7e52b","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"// Find demo cookies and clear them\nvar select=\"select distinct title from menu_ingr, recipes where recipe = id and username = '%s' and type = '%s' order by title asc\";\nmsg.topic = util.format(select, msg.req.cookies.id, msg.type);\n\nreturn msg;","outputs":1,"noerr":0,"x":2230,"y":4400,"wires":[["137e9f3a.008b71"]]},{"id":"137e9f3a.008b71","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":2430,"y":4400,"wires":[["3360ddf4.0f3272"]]},{"id":"3360ddf4.0f3272","type":"function","z":"c0a64af3.88a468","name":"format data","func":"msg.data = [];\nfor(var i in msg.payload){\n    msg.data.push([msg.payload[i]['title']]);\n}\nmsg.payload = {};\nmsg.payload[\"recipe\"] = msg.data;\nmsg.payload[\"percentage\"] = msg.data2;\nreturn msg;","outputs":1,"noerr":0,"x":2630,"y":4400,"wires":[["3b894b92.b5d264"]]},{"id":"fcf537b9.d9d5a8","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1490,"y":2700,"wires":[]},{"id":"eb736849.e25878","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"//breakfast\n\nvar insert = \"SELECT username from users\";\n\nmsg.topic = insert;\n\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":3000,"wires":[["e93e3bfd.87a1a8"]]},{"id":"e93e3bfd.87a1a8","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":530,"y":3000,"wires":[["e3d1f5c3.557cd8"]]},{"id":"e3d1f5c3.557cd8","type":"function","z":"c0a64af3.88a468","name":"check user","func":"var assert = 0;\nfor(var i in msg.payload){\n    if(msg.req.cookies.id == msg.payload[i]['username']) {\n        assert = 1;\n        break;\n    }\n}\nif(!(['b', 'l', 'd'].includes(msg.type))) {\n    assert = 0;\n}\nmsg.assert = assert;\nreturn msg;","outputs":1,"noerr":0,"x":690,"y":3000,"wires":[["8a852101.4b4fc","aca95d46.8e8d7"]]},{"id":"8a852101.4b4fc","type":"switch","z":"c0a64af3.88a468","name":"","property":"assert","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":890,"y":3000,"wires":[["5a281154.04f41"],["b60e1bbe.ffe9c8"]]},{"id":"b60e1bbe.ffe9c8","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":1070,"y":3040,"wires":[]},{"id":"e06383b9.f0eb5","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"//breakfast\nmsg.order = msg.payload.order;\nmsg.id = msg.payload.id;\nmsg.name = msg.payload.name;\nmsg.type = msg.payload.type;\n\n\nvar insert = \"SELECT username from users\";\n\nmsg.topic = insert;\n\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":2780,"wires":[["908d9d8e.2fcf6"]]},{"id":"908d9d8e.2fcf6","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":530,"y":2780,"wires":[["8a68c5f5.835e58"]]},{"id":"8a68c5f5.835e58","type":"function","z":"c0a64af3.88a468","name":"check user","func":"msg.users = [];\nmsg.assert = 0\nfor(var i in msg.payload){\n    if(msg.req.cookies.id === msg.payload[i]['username']) {\n        msg.assert = 1;\n        break;\n    }\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":690,"y":2780,"wires":[["45484ac0.14f6d4"]]},{"id":"45484ac0.14f6d4","type":"switch","z":"c0a64af3.88a468","name":"","property":"assert","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":890,"y":2780,"wires":[["3ab1a90c.e5d3f6"],["6d99af46.04f56"]]},{"id":"6d99af46.04f56","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":1050,"y":2800,"wires":[]},{"id":"224c3e16.1952f2","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"//breakfast\nmsg.order = msg.payload.order;\nmsg.id = msg.payload.id;\nmsg.name = msg.payload.name;\nmsg.type = msg.payload.type;\n\n\nvar insert = \"SELECT username from users\";\n\nmsg.topic = insert;\n\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":2840,"wires":[["bee915e2.ba5d88"]]},{"id":"bee915e2.ba5d88","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":530,"y":2840,"wires":[["28960969.3e43b6"]]},{"id":"28960969.3e43b6","type":"function","z":"c0a64af3.88a468","name":"check user","func":"msg.users = [];\nmsg.assert = 0\nfor(var i in msg.payload){\n    if(msg.req.cookies.id === msg.payload[i]['username']) {\n        msg.assert = 1;\n        break;\n    }\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":690,"y":2840,"wires":[["f423f6c4.c51ef8"]]},{"id":"f423f6c4.c51ef8","type":"switch","z":"c0a64af3.88a468","name":"","property":"assert","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":890,"y":2840,"wires":[["f5a23816.53b128"],["fa03904d.71ff7"]]},{"id":"fa03904d.71ff7","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":1050,"y":2880,"wires":[]},{"id":"4b475a8b.832ef4","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"//breakfast\nmsg.order = msg.payload.order;\nmsg.id = msg.payload.id;\nmsg.name = msg.payload.name;\nmsg.type = msg.payload.type;\n\n\nvar insert = \"SELECT username from users\";\n\nmsg.topic = insert;\n\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":2900,"wires":[["90ca5e43.8cce"]]},{"id":"90ca5e43.8cce","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":530,"y":2900,"wires":[["4c6ddf30.74fe2"]]},{"id":"4c6ddf30.74fe2","type":"function","z":"c0a64af3.88a468","name":"check user","func":"msg.users = [];\nmsg.assert = 0\nfor(var i in msg.payload){\n    if(msg.req.cookies.id === msg.payload[i]['username']) {\n        msg.assert = 1;\n        break;\n    }\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":690,"y":2900,"wires":[["2618a5f6.587d0a"]]},{"id":"2618a5f6.587d0a","type":"switch","z":"c0a64af3.88a468","name":"","property":"assert","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":890,"y":2900,"wires":[["e8d50b41.788158"],["9cc41ded.c5dfe"]]},{"id":"9cc41ded.c5dfe","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":1050,"y":2960,"wires":[]},{"id":"898fea67.1c8e78","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"//breakfast\nmsg.order = msg.payload.order;\nmsg.id = msg.payload.id;\nmsg.name = msg.payload.name;\nmsg.type = msg.payload.type;\n\n\nvar insert = \"SELECT username from users\";\n\nmsg.topic = insert;\n\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":3240,"wires":[["27b71e66.d20fb2"]]},{"id":"27b71e66.d20fb2","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":530,"y":3240,"wires":[["3048a93d.afcba6"]]},{"id":"3048a93d.afcba6","type":"function","z":"c0a64af3.88a468","name":"check user","func":"msg.users = [];\nmsg.assert = 0\nfor(var i in msg.payload){\n    if(msg.req.cookies.id === msg.payload[i]['username']) {\n        msg.assert = 1;\n        break;\n    }\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":690,"y":3240,"wires":[["2a3f2a7c.56ee76"]]},{"id":"2a3f2a7c.56ee76","type":"switch","z":"c0a64af3.88a468","name":"","property":"assert","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":890,"y":3240,"wires":[["32f38f05.d85b3"],["3e49ea49.3e7e86"]]},{"id":"3e49ea49.3e7e86","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":890,"y":3300,"wires":[]},{"id":"25a70464.7df5bc","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"//breakfast\nmsg.order = msg.payload.order;\nmsg.id = msg.payload.id;\nmsg.name = msg.payload.name;\nmsg.type = msg.payload.type;\nmsg.number = msg.payload.number;\n\n\nvar insert = \"SELECT username from users\";\n\nmsg.topic = insert;\n\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":3460,"wires":[["22a69c73.6e58a4"]]},{"id":"22a69c73.6e58a4","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":530,"y":3460,"wires":[["c79d5f81.71ead"]]},{"id":"c79d5f81.71ead","type":"function","z":"c0a64af3.88a468","name":"check user","func":"msg.users = [];\nmsg.assert = 0\nfor(var i in msg.payload){\n    if(msg.req.cookies.id === msg.payload[i]['username']) {\n        msg.assert = 1;\n        break;\n    }\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":690,"y":3460,"wires":[["9fae36f5.8b6118"]]},{"id":"9fae36f5.8b6118","type":"switch","z":"c0a64af3.88a468","name":"","property":"assert","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":890,"y":3460,"wires":[["dc15d1a3.45bff"],["5052b1.c5df9d5"]]},{"id":"5052b1.c5df9d5","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":890,"y":3520,"wires":[]},{"id":"1c091f08.d26051","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"//breakfast\nmsg.order = msg.payload.order;\nmsg.id = msg.payload.id;\nmsg.name = msg.payload.name;\nmsg.type = msg.payload.type;\n\n\nvar insert = \"SELECT username from users\";\n\nmsg.topic = insert;\n\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":3660,"wires":[["4704255b.aa866c"]]},{"id":"4704255b.aa866c","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":530,"y":3660,"wires":[["b3beecd1.a884b"]]},{"id":"b3beecd1.a884b","type":"function","z":"c0a64af3.88a468","name":"check user","func":"msg.users = [];\nmsg.assert = 0\nfor(var i in msg.payload){\n    if(msg.req.cookies.id === msg.payload[i]['username']) {\n        msg.assert = 1;\n        break;\n    }\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":690,"y":3660,"wires":[["c9c1347b.2d4dc8"]]},{"id":"c9c1347b.2d4dc8","type":"switch","z":"c0a64af3.88a468","name":"","property":"assert","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":890,"y":3660,"wires":[["807945a9.32f8e8"],["275ccf1.11dcd3"]]},{"id":"275ccf1.11dcd3","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":890,"y":3720,"wires":[]},{"id":"c1d5de15.00b0a","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"//breakfast\nmsg.order = msg.payload.order;\nmsg.id = msg.payload.id;\nmsg.name = msg.payload.name;\nmsg.type = msg.payload.type;\n\n\nvar insert = \"SELECT username from users\";\n\nmsg.topic = insert;\n\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":3820,"wires":[["3a82a3f3.0b1f3c"]]},{"id":"3a82a3f3.0b1f3c","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":530,"y":3820,"wires":[["48439766.e0eaa8"]]},{"id":"48439766.e0eaa8","type":"function","z":"c0a64af3.88a468","name":"check user","func":"msg.users = [];\nmsg.assert = 0\nfor(var i in msg.payload){\n    if(msg.req.cookies.id === msg.payload[i]['username']) {\n        msg.assert = 1;\n        break;\n    }\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":690,"y":3820,"wires":[["c1254168.0773c"]]},{"id":"c1254168.0773c","type":"switch","z":"c0a64af3.88a468","name":"","property":"assert","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":890,"y":3820,"wires":[["72cfb86a.fafef8"],["500041b3.7da62"]]},{"id":"500041b3.7da62","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":890,"y":3880,"wires":[]},{"id":"f76cb3d.979005","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"//breakfast\nmsg.order = msg.payload.order;\nmsg.id = msg.payload.id;\nmsg.name = msg.payload.name;\nmsg.type = msg.payload.type;\n\n\nvar insert = \"SELECT username from users\";\n\nmsg.topic = insert;\n\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":3980,"wires":[["84ea21b7.b41ee"]]},{"id":"84ea21b7.b41ee","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":530,"y":3980,"wires":[["4b9d7580.b8184c"]]},{"id":"4b9d7580.b8184c","type":"function","z":"c0a64af3.88a468","name":"check user","func":"msg.users = [];\nmsg.assert = 0\nfor(var i in msg.payload){\n    if(msg.req.cookies.id === msg.payload[i]['username']) {\n        msg.assert = 1;\n        break;\n    }\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":690,"y":3980,"wires":[["a246e4da.c16798"]]},{"id":"a246e4da.c16798","type":"switch","z":"c0a64af3.88a468","name":"","property":"assert","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":890,"y":3980,"wires":[["cef80ed9.f82ca"],["5bfa5364.e7739c"]]},{"id":"5bfa5364.e7739c","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":890,"y":4040,"wires":[]},{"id":"7c6b7d0c.330174","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"//breakfast\nmsg.order = msg.payload.order;\nmsg.id = msg.payload.id;\nmsg.name = msg.payload.name;\nmsg.type = msg.payload.type;\n\n\nvar insert = \"SELECT username from users\";\n\nmsg.topic = insert;\n\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":4100,"wires":[["6535fc85.e44c74"]]},{"id":"6535fc85.e44c74","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":530,"y":4100,"wires":[["f0c78bd3.414648"]]},{"id":"f0c78bd3.414648","type":"function","z":"c0a64af3.88a468","name":"check user","func":"msg.users = [];\nmsg.assert = 0\nfor(var i in msg.payload){\n    if(msg.req.cookies.id === msg.payload[i]['username']) {\n        msg.assert = 1;\n        break;\n    }\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":690,"y":4100,"wires":[["6080afeb.84a44"]]},{"id":"6080afeb.84a44","type":"switch","z":"c0a64af3.88a468","name":"","property":"assert","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":890,"y":4100,"wires":[["e729956a.d15d88"],["6edeadfd.c4a544"]]},{"id":"6edeadfd.c4a544","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":890,"y":4160,"wires":[]},{"id":"ef2ecbc2.f26ef8","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"//breakfast\nmsg.order = msg.payload.order;\nmsg.id = msg.payload.id;\nmsg.name = msg.payload.name;\nmsg.type = msg.payload.type;\n\n\nvar insert = \"SELECT username from users\";\n\nmsg.topic = insert;\n\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":4260,"wires":[["4df94f98.c4d97"]]},{"id":"4df94f98.c4d97","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":530,"y":4260,"wires":[["445993cd.d8343c"]]},{"id":"445993cd.d8343c","type":"function","z":"c0a64af3.88a468","name":"check user","func":"msg.users = [];\nmsg.assert = 0\nfor(var i in msg.payload){\n    if(msg.req.cookies.id === msg.payload[i]['username']) {\n        msg.assert = 1;\n        break;\n    }\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":690,"y":4260,"wires":[["3474a07c.747d3"]]},{"id":"3474a07c.747d3","type":"switch","z":"c0a64af3.88a468","name":"","property":"assert","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":890,"y":4260,"wires":[["c9201b54.8d4158"],["4c24aea.d9c035"]]},{"id":"4c24aea.d9c035","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":890,"y":4320,"wires":[]},{"id":"28533032.a332c","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"//breakfast\nmsg.order = msg.payload.order;\nmsg.id = msg.payload.id;\nmsg.name = msg.payload.name;\nmsg.type = msg.payload.type;\n\n\nvar insert = \"SELECT username from users\";\n\nmsg.topic = insert;\n\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":4420,"wires":[["eaa5ef8c.7e603"]]},{"id":"eaa5ef8c.7e603","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":530,"y":4420,"wires":[["391ffdf8.996612"]]},{"id":"391ffdf8.996612","type":"function","z":"c0a64af3.88a468","name":"check user","func":"msg.users = [];\nmsg.assert = 0\nfor(var i in msg.payload){\n    if(msg.req.cookies.id === msg.payload[i]['username']) {\n        msg.assert = 1;\n        break;\n    }\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":690,"y":4420,"wires":[["ce3eae3b.3b6c7"]]},{"id":"ce3eae3b.3b6c7","type":"switch","z":"c0a64af3.88a468","name":"","property":"assert","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":890,"y":4420,"wires":[["d3845df7.aa8fa"],["9740f0c1.2c706"]]},{"id":"9740f0c1.2c706","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":890,"y":4480,"wires":[]},{"id":"dfe4b90d.55b218","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"//breakfast\n\nvar insert = \"SELECT username from users\";\n\nmsg.topic = insert;\n\nreturn msg;","outputs":1,"noerr":0,"x":250,"y":2160,"wires":[["eada8345.13035"]]},{"id":"eada8345.13035","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":410,"y":2160,"wires":[["3afc6e20.49a172"]]},{"id":"3afc6e20.49a172","type":"function","z":"c0a64af3.88a468","name":"check user","func":"msg.users = [];\nmsg.assert = 0\nfor(var i in msg.payload){\n    if(msg.req.cookies.id === msg.payload[i]['username']) {\n        msg.assert = 1;\n        break;\n    }\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":570,"y":2160,"wires":[["4d94b93c.16e438"]]},{"id":"4d94b93c.16e438","type":"switch","z":"c0a64af3.88a468","name":"","property":"assert","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":2160,"wires":[["e2f288fa.5ec2e8"],["f708a64d.a73418"]]},{"id":"9c5369d6.dab738","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":870,"y":2220,"wires":[]},{"id":"f708a64d.a73418","type":"change","z":"c0a64af3.88a468","name":"Redirect to /menu","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.location","pt":"msg","to":"/landin","tot":"str"},{"t":"set","p":"statusCode","pt":"msg","to":"302","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":690,"y":2220,"wires":[["9c5369d6.dab738"]]},{"id":"e84af706.39cf18","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"//breakfast\n\nvar insert = \"SELECT username from users\";\n\nmsg.topic = insert;\n\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":2280,"wires":[["a3862779.e56d28"]]},{"id":"a3862779.e56d28","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":510,"y":2280,"wires":[["908529b7.0332d8"]]},{"id":"908529b7.0332d8","type":"function","z":"c0a64af3.88a468","name":"check user","func":"msg.users = [];\nmsg.assert = 0\nfor(var i in msg.payload){\n    if(msg.req.cookies.id === msg.payload[i]['username']) {\n        msg.assert = 1;\n        break;\n    }\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":670,"y":2280,"wires":[["9c51cd5f.09629"]]},{"id":"9c51cd5f.09629","type":"switch","z":"c0a64af3.88a468","name":"","property":"assert","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":870,"y":2280,"wires":[["bbf011e9.fe046"],["b407d021.4bee7"]]},{"id":"3829b46a.c283dc","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":970,"y":2340,"wires":[]},{"id":"b407d021.4bee7","type":"change","z":"c0a64af3.88a468","name":"Redirect to /menu","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.location","pt":"msg","to":"/landin","tot":"str"},{"t":"set","p":"statusCode","pt":"msg","to":"302","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":2340,"wires":[["3829b46a.c283dc"]]},{"id":"2192a95c.5783a6","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"//breakfast\n\nvar insert = \"SELECT username from users\";\n\nmsg.topic = insert;\n\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":2420,"wires":[["f50478c1.2d9278"]]},{"id":"f50478c1.2d9278","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":490,"y":2420,"wires":[["e50cfb6.7e97e08"]]},{"id":"e50cfb6.7e97e08","type":"function","z":"c0a64af3.88a468","name":"check user","func":"msg.users = [];\nmsg.assert = 0\nfor(var i in msg.payload){\n    if(msg.req.cookies.id === msg.payload[i]['username']) {\n        msg.assert = 1;\n        break;\n    }\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":650,"y":2420,"wires":[["558e9b5e.5f1464"]]},{"id":"558e9b5e.5f1464","type":"switch","z":"c0a64af3.88a468","name":"","property":"assert","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":850,"y":2420,"wires":[["953f5153.816fe"],["8b5eb633.a97f48"]]},{"id":"c74a0b39.619a48","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":950,"y":2480,"wires":[]},{"id":"8b5eb633.a97f48","type":"change","z":"c0a64af3.88a468","name":"Redirect to /menu","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.location","pt":"msg","to":"/landin","tot":"str"},{"t":"set","p":"statusCode","pt":"msg","to":"302","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":2480,"wires":[["c74a0b39.619a48"]]},{"id":"7908986a.befdf8","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"//breakfast\n\nvar insert = \"SELECT username from users\";\n\nmsg.topic = insert;\n\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":2560,"wires":[["683a3335.708e7c"]]},{"id":"683a3335.708e7c","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":510,"y":2560,"wires":[["f354b5c4.d8d778"]]},{"id":"f354b5c4.d8d778","type":"function","z":"c0a64af3.88a468","name":"check user","func":"msg.users = [];\nmsg.assert = 0\nfor(var i in msg.payload){\n    if(msg.req.cookies.id === msg.payload[i]['username']) {\n        msg.assert = 1;\n        break;\n    }\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":670,"y":2560,"wires":[["2e99b16c.c05a6e"]]},{"id":"2e99b16c.c05a6e","type":"switch","z":"c0a64af3.88a468","name":"","property":"assert","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":870,"y":2560,"wires":[["cfec14a6.2fdc98"],["26d42f41.eaa75"]]},{"id":"a8c560ea.674ff","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":970,"y":2620,"wires":[]},{"id":"26d42f41.eaa75","type":"change","z":"c0a64af3.88a468","name":"Redirect to /menu","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.location","pt":"msg","to":"/landin","tot":"str"},{"t":"set","p":"statusCode","pt":"msg","to":"302","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":2620,"wires":[["a8c560ea.674ff"]]},{"id":"df4510a2.c8eb","type":"function","z":"c0a64af3.88a468","name":"Delete user","func":"//breakfast\nmsg.order = msg.payload.order;\nmsg.id = msg.payload.id;\nmsg.name = msg.payload.name;\nmsg.type = msg.payload.type;\n\nvar insert = \"SELECT count(*) count from recipes where id = '%s'\";\n\nmsg.topic = util.format(insert, msg.name);\n\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":3100,"wires":[["e521dc35.9c254"]]},{"id":"2e8c3f7.f0190c","type":"switch","z":"c0a64af3.88a468","name":"","property":"payload[0][\"count\"]","propertyType":"msg","rules":[{"t":"gt","v":"0","vt":"num"},{"t":"eq","v":"0","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":850,"y":3120,"wires":[["eb736849.e25878"],["15741d92.9dcc02"]]},{"id":"15741d92.9dcc02","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":1030,"y":3140,"wires":[]},{"id":"ea951dfa.28fb8","type":"function","z":"c0a64af3.88a468","name":"check user","func":"msg.count = msg.payload[0][\"count\"];\n\nreturn msg;","outputs":1,"noerr":0,"x":670,"y":3140,"wires":[["2e8c3f7.f0190c","d8a88c4e.81443"]]},{"id":"e521dc35.9c254","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":530,"y":3100,"wires":[["ea951dfa.28fb8"]]},{"id":"aca95d46.8e8d7","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":830,"y":3040,"wires":[]},{"id":"b48b91fa.51dd3","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{"content-type":"text/css"},"x":630,"y":2100,"wires":[]},{"id":"ce613dac.b9991","type":"template","z":"c0a64af3.88a468","name":"template","field":"payload","fieldType":"msg","format":"css","syntax":"mustache","template":"body {\n  font-family: \"Lato\", sans-serif;\n}\n\ntable {\n  font-family: Arial, Helvetica, sans-serif;\n  border-collapse: collapse;\n  width: 100%;\n}\n\ntable td, #table th {\n  border: 2px solid #ddd;\n  padding: 8px;\n\n\n}\n\ntable tr:nth-child(even){background-color: #f2f2f2;}\n\ntable tr:hover {background-color: #ddd;}\n\ntable th {\n  padding-top: 12px;\n  padding-bottom: 12px;\n  text-align: left;\n  background-color: #ffad33;\n  color: white;\n}\n\na {\n    color: black;\n    text-decoration: none;\n}\n\n.comment{\n    font-size: 12px;\n    display: inline-block;\n    box-sizing: border-box;\n    background-color: #f4f5f7;\n    border: 1px solid #e5e9ef;\n    overflow: auto;\n    border-radius: 4px;\n    color: #555;\n    height: 65px;\n    transition: 0s;\n    padding: 5px 10px;\n    line-height: normal;\n}\n\n.comment_submit{\n    width: 95px;\n    height: 64px;\n    right: -80px;\n    top: 0;\n    padding: 4px 15px;\n    font-size: 14px;\n    color: #fff;\n    border-radius: 4px;\n    text-align: center;\n    min-width: 60px;\n    vertical-align: top;\n    cursor: pointer;\n    background-color: #00a1d6;\n    border: 1px solid #00a1d6;\n    transition: 0.1s;\n    user-select: none;\n    outline: none;\n}\n\n.tag{\n  float: left;\n  margin: 0 10px 8px 0;\n  background: #f4f4f4;\n  border-radius: 100px;\n  padding: 0 12px;\n  position: relative;\n  height: 22px;\n  line-height: 22px;\n  transition: all .3s;\n  font-size: 12px;\n  border: 1px solid #f4f4f4;\n  color:black;\n  font-weight:bold;\n}\n\n.container {\n  width: 100%; /* Full width */\n  background-color: #ddd; /* Grey background */\n}\n\n.skills {\n  text-align: right; /* Right-align text */\n  padding-top: 10px; /* Add top padding */\n  padding-bottom: 10px; /* Add bottom padding */\n  color: white; /* White text color */\n}\n\n.html {width: 90%; background-color: #4CAF50;} /* Green */\n.css {width: 80%; background-color: #2196F3;} /* Blue */\n.js {width: 65%; background-color: #f44336;} /* Red */\n.php {width: 60%; background-color: #808080;} /* Dark Grey */\n\n.base-timer {\n  position: relative;\n  width: 300px;\n  height: 300px;\n}\n\n.base-timer__svg {\n  transform: scaleX(-1);\n}\n\n.base-timer__circle {\n  fill: none;\n  stroke: none;\n}\n\n.base-timer__path-elapsed {\n  stroke-width: 7px;\n  stroke: grey;\n}\n\n.base-timer__path-remaining {\n  stroke-width: 7px;\n  stroke-linecap: round;\n  transform: rotate(90deg);\n  transform-origin: center;\n  transition: 1s linear all;\n  fill-rule: nonzero;\n  stroke: currentColor;\n}\n\n.base-timer__path-remaining.green {\n  color: rgb(65, 184, 131);\n}\n\n.base-timer__path-remaining.orange {\n  color: orange;\n}\n\n.base-timer__path-remaining.red {\n  color: red;\n}\n\n.base-timer__label {\n  position: absolute;\n  width: 300px;\n  height: 300px;\n  top: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 48px;\n}\n\n* {\n  box-sizing: border-box;\n}\n\n/* Remove margins and padding from the list */\nul {\n  margin: 0;\n  padding: 0;\n}\n\n/* Style the list items */\nul li {\n  cursor: pointer;\n  position: relative;\n  padding: 12px 8px 12px 40px;\n  background: #eee;\n  font-size: 18px;\n  transition: 0.2s;\n  list-style-type: none;\n\n  /* make the list items unselectable */\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n\n/* Set all odd list items to a different color (zebra-stripes) */\nul li:nth-child(odd) {\n  background: #f9f9f9;\n}\n\n/* Darker background-color on hover */\nul li:hover {\n  background: #ddd;\n}\n\n/* When clicked on, add a background color and strike out text */\nul li.checked {\n  background: #888;\n  color: #fff;\n  text-decoration: line-through;\n}\n\n/* Add a \"checked\" mark when clicked on */\nul li.checked::before {\n  content: '';\n  position: absolute;\n  border-color: #fff;\n  border-style: solid;\n  border-width: 0 2px 2px 0;\n  top: 10px;\n  left: 16px;\n  transform: rotate(45deg);\n  height: 15px;\n  width: 7px;\n}\n\n/* Style the close button */\n.close {\n  position: absolute;\n  right: 0;\n  top: 0;\n  padding: 12px 16px 12px 16px;\n}\n\n.close:hover {\n  background-color: #f44336;\n  color: white;\n}\n\n/* Style the header */\n.header {\n  background-color: #f44336;\n  padding: 20px 40px;\n  color: white;\n  text-align: center;\n  width: 1500px;\n}\n\n/* Clear floats after the header */\n.header:after {\n  content: \"\";\n  display: table;\n  clear: both;\n}\n\n/* Style the input */\ninput {\n  margin: 0;\n  border: none;\n  border-radius: 0;\n  width: 75%;\n  padding: 10px;\n  float: left;\n  font-size: 16px;\n}\n\n/* Style the \"Add\" button */\n.addBtn {\n  padding: 10px;\n  width: 25%;\n  background: #d9d9d9;\n  color: #555;\n  float: left;\n  text-align: center;\n  font-size: 16px;\n  cursor: pointer;\n  transition: 0.3s;\n  border-radius: 0;\n}\n\n.addBtn:hover {\n  background-color: #bbb;\n}\n\n/* The dropdown container */\n.dropdown {\n  float: left;\n  overflow: hidden;\n}\n\n/* Dropdown button */\n.dropdown .dropbtn {\n  font-size: 20px;\n  width: 80px;\n  border: none;\n  outline: none;\n  color: black;\n  padding: 14px 16px;\n  background-color: inherit;\n  font-family: inherit; /* Important for vertical align on mobile phones */\n  margin: 0; /* Important for vertical align on mobile phones */\n  padding: 0;\n}\n\n/* Add a red background color to navbar links on hover */\n.dropdown:hover .dropbtn {\n  background-color: orange;\n}\n\n/* Dropdown content (hidden by default) */\n.dropdown-content {\n  display: none;\n  position: absolute;\n  background-color: #f9f9f9;\n  min-width: 160px;\n  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n  z-index: 1;\n}\n\n/* Links inside the dropdown */\n.dropdown-content a {\n  float: none;\n  color: black;\n  padding: 12px 16px;\n  text-decoration: none;\n  display: block;\n  text-align: left;\n}\n\n/* Add a grey background color to dropdown links on hover */\n.dropdown-content a:hover {\n  background-color: #ddd;\n}\n\n/* Show the dropdown menu on hover */\n.dropdown:hover .dropdown-content {\n  display: block;\n}\n\n/* Fixed sidenav, full height */\n.sidenav {\n  height: 100%;\n  width: 200px;\n  position: fixed;\n  z-index: 1;\n  top: 0;\n  left: 0;\n  background-color: #111;\n  overflow-x: hidden;\n  padding-top: 20px;\n}\n\n/* Style the sidenav links and the dropdown button */\n.sidenav a, .dropdown-btn {\n  padding: 6px 8px 6px 16px;\n  text-decoration: none;\n  font-size: 20px;\n  color: #818181;\n  display: block;\n  border: none;\n  background: none;\n  width: 100%;\n  text-align: left;\n  cursor: pointer;\n  outline: none;\n}\n\n/* On mouse-over */\n.sidenav a:hover, .dropdown-btn:hover {\n  color: #f1f1f1;\n}\n\n/* Main content */\n.main {\n  margin-left: 200px; /* Same as the width of the sidenav */\n  font-size: 20px; /* Increased text to enable scrolling */\n  padding: 0px 10px;\n}\n\n/* Add an active class to the active dropdown button */\n.active {\n  background-color: green;\n  color: white;\n}\n\n/* Dropdown container (hidden by default). Optional: add a lighter background color and some left padding to change the design of the dropdown content */\n.dropdown-container {\n  display: none;\n  background-color: #262626;\n  padding-left: 8px;\n}\n\n/* Optional: Style the caret down icon */\n.fa-caret-down {\n  float: right;\n  padding-right: 8px;\n}\n\n/* Some media queries for responsiveness */\n@media screen and (max-height: 450px) {\n  .sidenav {padding-top: 15px;}\n  .sidenav a {font-size: 18px;}\n}","output":"str","x":320,"y":2100,"wires":[["b48b91fa.51dd3"]]},{"id":"873ebbfc.211718","type":"http in","z":"c0a64af3.88a468","name":"Template","url":"/template.css","method":"get","upload":false,"swaggerDoc":"","x":80,"y":2100,"wires":[["ce613dac.b9991"]]},{"id":"5fd0942d.be9d4c","type":"debug","z":"c0a64af3.88a468","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1290,"y":3540,"wires":[]},{"id":"829da0b5.65286","type":"comment","z":"c0a64af3.88a468","name":"Farmers Market Page","info":"","x":140,"y":4540,"wires":[]},{"id":"e7dbb52f.005738","type":"http in","z":"c0a64af3.88a468","name":"","url":"/farmers_market","method":"get","upload":false,"swaggerDoc":"","x":140,"y":4780,"wires":[["46d78846.3abca8"]]},{"id":"33d164db.2351bc","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{},"x":1230,"y":4780,"wires":[]},{"id":"b0b3e0c9.c2028","type":"template","z":"c0a64af3.88a468","name":"HTML","field":"payload","fieldType":"msg","format":"html","syntax":"mustache","template":"<html>\n    <head>\n        <script src=\"http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js\"></script>\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n        <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/market_template.css\">\n    </head>\n\n    <body>\n        <div class=\"sidenav\">\n            <a href=\"/menu\">Menu</a>\n            <a href=\"/user_profile\">User Profile</a>\n            <a href=\"/landin\">Recipe Search</a>\n        </div>\n        \n        <div class=\"main\">\n            <div id=\"mainTitle\" class=\"header\">\n                <h2 style=\"font-size:30px;\" margin=\"center;\" >Farmers Market</h2>\n            </div>\n\n        </div>\n        \n        <input type =\"text\" id = \"marketText\" placeholder=\"Search...\">\n        <button id=\"marketBtn\" class=\"searchBtn\"  onclick=\"searchFunction()\"> Submit </button>\n        <div class=\"dropdown\">\n          <button id = searchByBtn class=\"dropbtn\">Search By</button>\n          <div class=\"dropdown-content\">\n          <a onclick=\"searchBy('name')\" >Market Name</a>\n          <a onclick=\"searchBy('city')\" >City</a>\n          <a onclick=\"searchBy('state')\" >State</a>\n          <a onclick=\"searchBy('zip')\" >ZIP Code</a>\n          <a onclick=\"searchBy('FMID')\" >ID</a>\n\n          </div>\n        </div>\n        <br/>\n    \n        <div style=\"width: max-content; margin-left: 250px;\">\n        <table border = 1px id = \"table\">\n\t    </table>\n        </div>\n\n        <div style=\"display: auto;\">\n\t    <button onclick=\"prev()\" id=\"prev\" class=\"pageBtn\" >Prev</button>\n\t    <button onclick=\"next()\" id=\"next\" class=\"pageBtn\" >Next</button>\n        </div>\n\n\t<script>\n\t{{{payload.script}}}\n\tvar search_info = document.getElementById(\"marketText\");\n    search_info.addEventListener(\"keyup\", function(event) {\n        if (event.keyCode === 13) {\n            event.preventDefault();\n            document.getElementById(\"marketBtn\").click();\n        }\n\n    });    \n\t</script>\n\n\t\n</html>","x":1070,"y":4780,"wires":[["33d164db.2351bc"]]},{"id":"d4a490af.b805b","type":"mysql","z":"c0a64af3.88a468","mydb":"9bc36b30.4298c8","name":"","x":470,"y":4780,"wires":[["1711ee3c.7d2f72"]]},{"id":"46d78846.3abca8","type":"function","z":"c0a64af3.88a468","name":"test","func":"var select=\"SELECT * from farmers order by FMID asc\";\n\nmsg.topic = util.format(select);\n\n//util.format()\n\nreturn msg;","outputs":1,"noerr":0,"x":320,"y":4780,"wires":[["d4a490af.b805b"]]},{"id":"2b2c8f73.9490d","type":"debug","z":"c0a64af3.88a468","name":"dataDebug","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":650,"y":4860,"wires":[]},{"id":"21f74498.f6f36c","type":"template","z":"c0a64af3.88a468","name":"Javascript","field":"payload.script","fieldType":"msg","format":"javascript","syntax":"mustache","template":"var marketName = \"{{marketName}}\".split(\",\");\nvar city = \"{{city}}\".split(\",\"); \nvar state = \"{{state}}\".split(\",\"); \nvar zip = \"{{zip}}\".split(\",\"); \nvar FMID = \"{{FMID}}\".split(\",\"); \nvar website = \"{{website}}\".split(\",\");\n\nvar cur = 1;\nvar marketSearched= [];\nvar citySearched= [];\nvar stateSearched= [];\nvar zipSearched= [];\nvar FMIDSearched= [];\nvar websiteSearched= [];\nvar searchByCondition = \"name\";\n\nHTML = \"\";\n\nfunction prev(){\n    cur -= 1;\n    if(cur == 1){\n        document.getElementById(\"prev\").style=\"display:none;\";\n    }\n    document.getElementById(\"next\").style=\"display:block;\";\n    HTML = \"\";\n    tableHeader();\n\n    var start = (cur-1)*20;\n    var num = start+1;\n    if(start + 20 >= marketSearched.length){\n        for(i=start; i < marketName.length; i++){\n          HTML += \"<tr>\" \n          + \"<td>\" + FMIDSearched[i] + \"</td>\"\n          + \"<td>\"  + \"<a href = \" + websiteSearched[i] + \"> \"+ marketSearched[i] + \"</a></td>\"\n          + \"<td>\" + citySearched[i] + \"</td>\"\n          + \"<td>\" + stateSearched[i] + \"</td>\"\n          + \"<td>\" + zipSearched[i] + \"</td>\"\n          + \"<td>\"  + \"<a href = \" + websiteSearched[i] + \"> \"+ websiteSearched[i] + \"</a></td>\"\n          + \"</tr>\";\n            num += 1;\n        }\n    }\n    else{\n        for(i=start; i < start+20; i++){\n          HTML += \"<tr>\" \n          + \"<td>\" + FMIDSearched[i] + \"</td>\"\n          + \"<td>\"  + \"<a href = \" + websiteSearched[i] + \"> \"+ marketSearched[i] + \"</a></td>\"\n          + \"<td>\" + citySearched[i] + \"</td>\"\n          + \"<td>\" + stateSearched[i] + \"</td>\"\n          + \"<td>\" + zipSearched[i] + \"</td>\"\n          + \"<td>\"  + \"<a href = \" + websiteSearched[i] + \"> \"+ websiteSearched[i] + \"</a></td>\"\n          + \"</tr>\";\n            num += 1;\n        }\n    }\n    document.getElementById(\"table\").innerHTML=HTML;\n}\n\nfunction next(){\n    \n    cur += 1;\n    if(cur*20 >= marketSearched.length){\n        document.getElementById(\"next\").style=\"display:none;\";\n    }\n    document.getElementById(\"prev\").style=\"display:block;\";\n    HTML = \"\";\n    tableHeader();\n\n    var start = (cur-1)*20;\n    var num = start+1;\n    if(start + 20 >= marketSearched.length){\n        for(i=start; i < marketSearched.length; i++){\n          HTML += \"<tr>\" \n          + \"<td>\" + FMIDSearched[i] + \"</td>\"\n          + \"<td>\"  + \"<a href = \" + websiteSearched[i] + \"> \"+ marketSearched[i] + \"</a></td>\"\n          + \"<td>\" + citySearched[i] + \"</td>\"\n          + \"<td>\" + stateSearched[i] + \"</td>\"\n          + \"<td>\" + zipSearched[i] + \"</td>\"\n          + \"<td>\"  + \"<a href = \" + websiteSearched[i] + \"> \"+ websiteSearched[i] + \"</a></td>\"\n          + \"</tr>\";\n            num += 1;\n        }\n    }\n    else{\n        for(i=start; i < start+20; i++){\n          HTML += \"<tr>\" \n          + \"<td>\" + FMIDSearched[i] + \"</td>\"\n          + \"<td>\"  + \"<a href = \" + websiteSearched[i] + \"> \"+ marketSearched[i] + \"</a></td>\"\n          + \"<td>\" + citySearched[i] + \"</td>\"\n          + \"<td>\" + stateSearched[i] + \"</td>\"\n          + \"<td>\" + zipSearched[i] + \"</td>\"\n          + \"<td>\"  + \"<a href = \" + websiteSearched[i] + \"> \"+ websiteSearched[i] + \"</a></td>\"\n          + \"</tr>\";\n            num += 1;\n        }\n    }\n    document.getElementById(\"table\").innerHTML=HTML;\n}\n\nfunction searchFunction(){\n    \n    marketSearched= [];\n    ids = [];\n    citySearched= [];\n    stateSearched= [];\n    zipSearched= [];\n    FMIDSearched= [];\n    websiteSearched= [];\n    HTML= \"\";\n    tableHeader();\n    var search_info = document.getElementById(\"marketText\").value;\n\n    for(i=0; i < marketName.length; i++){\n        switch(searchByCondition){\n            case \"name\":\n                value = marketName[i];\n                break;\n            case \"city\":\n                value = city[i];\n                break;\n            case \"state\":\n                value = state[i];\n                break;\n            case \"zip\":\n                value = zip[i];\n                break;        \n            case \"FMID\":\n                value = FMID[i];\n        }\n        if(value.toUpperCase().search(search_info.toUpperCase()) != -1 ){\n            marketSearched.push(marketName[i]);\n            citySearched.push(city[i]);\n            stateSearched.push(state[i]);\n            zipSearched.push(zip[i]);\n            FMIDSearched.push(FMID[i]);\n            websiteSearched.push(website[i]);\n        }\n    }\n    var num = 1;\n    if(marketSearched.length > 0 && marketSearched.length <= 20){\n        for(i=0; i<marketSearched.length; i++){\n          HTML += \"<tr>\" \n          + \"<td>\" + FMIDSearched[i] + \"</td>\"\n          + \"<td>\"  + \"<a href = \" + websiteSearched[i] + \"> \"+ marketSearched[i] + \"</a></td>\"\n          + \"<td>\" + citySearched[i] + \"</td>\"\n          + \"<td>\" + stateSearched[i] + \"</td>\"\n          + \"<td>\" + zipSearched[i] + \"</td>\"\n          + \"<td>\"  + \"<a href = \" + websiteSearched[i] + \"> \"+ websiteSearched[i] + \"</a></td>\"\n          + \"</tr>\";\n            num += 1;\n        }\n        document.getElementById(\"table\").style = \"display: block;\";\n        document.getElementById(\"table\").innerHTML=HTML;\n        document.getElementById(\"prev\").style=\"display:none\";\n        document.getElementById(\"next\").style=\"display:none\";\n    }\n    else if(marketSearched.length <= 0){\n        document.getElementById(\"table\").style = \"display: none;\";\n        document.getElementById(\"prev\").style=\"display:none\";\n        document.getElementById(\"next\").style=\"display:none\";\n    }\n    else{\n        num = 1;\n        for(i=0; i<20; i++){\n          HTML += \"<tr>\" \n          + \"<td>\" + FMIDSearched[i] + \"</td>\"\n          + \"<td>\"  + \"<a href = \" + websiteSearched[i] + \"> \"+ marketSearched[i] + \"</a></td>\"\n          + \"<td>\" + citySearched[i] + \"</td>\"\n          + \"<td>\" + stateSearched[i] + \"</td>\"\n          + \"<td>\" + zipSearched[i] + \"</td>\"\n          + \"<td>\"  + \"<a href = \" + websiteSearched[i] + \"> \"+ websiteSearched[i] + \"</a></td>\"\n          + \"</tr>\";\n            num += 1;\n        }\n        document.getElementById(\"table\").style = \"display: block;\";\n        document.getElementById(\"table\").innerHTML=HTML;\n        document.getElementById(\"next\").style=\"display:block;\";\n    }\n}\n\nfunction searchBy(input){\n    searchByCondition = input;\n    document.getElementById(\"searchByBtn\").innerHTML=\"Search by \" + input.toUpperCase();\n\n}\n\n\nfunction tableHeader(){\n  HTML = \"<thread>\"\n      + \"<th> FMID </th>\"\n      + \"<th> Market Name </th>\"\n      + \"<th> City </th>\"\n      + \"<th> State </th>\"\n      + \"<th> Zip code </th>\"\n      + \"<th> Website </th>\"\n      + \"</thread>\";\n}\n    ","output":"str","x":880,"y":4780,"wires":[["b0b3e0c9.c2028","6bbeecbb.44fbe4"]]},{"id":"1711ee3c.7d2f72","type":"function","z":"c0a64af3.88a468","name":"format data","func":"msg.FMID = []\nmsg.marketName = []\nmsg.city = []\nmsg.state = []\nmsg.zip = []\nmsg.website = []\nfor(var i in msg.payload){\n    msg.FMID.push(msg.payload[i]['FMID']);\n    msg.marketName.push(msg.payload[i]['MarketName'].replace(/,/g, \" \"));\n    msg.city.push(msg.payload[i]['city']);\n    msg.state.push(msg.payload[i]['State']);\n    msg.zip.push(msg.payload[i]['zip']);\n    msg.website.push(msg.payload[i]['Website']);\n\n}\nreturn msg;","outputs":1,"noerr":0,"x":650,"y":4780,"wires":[["21f74498.f6f36c","2b2c8f73.9490d"]]},{"id":"6bbeecbb.44fbe4","type":"debug","z":"c0a64af3.88a468","name":"jsDebug","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":860,"y":4860,"wires":[]},{"id":"b60eef95.8d97c","type":"http response","z":"c0a64af3.88a468","name":"","statusCode":"","headers":{"content-type":"text/css"},"x":590,"y":4640,"wires":[]},{"id":"9a550890.307598","type":"template","z":"c0a64af3.88a468","name":"Market CSS","field":"payload","fieldType":"msg","format":"css","syntax":"mustache","template":"body {\n  font-family: \"Lato\", sans-serif;\n}\n\n.center {\n  margin-left: auto;\n  margin-right: auto;\n}\n\n/* Style the header */\n.header {\n  background-color: #f44336;\n  color: white;\n  text-align: center;\n  width: 100%;\n  height: 14%;\n  font-size: 62px;\n    \n}\n\n.topright {\n  position: absolute;\n  padding-top: 10px;\n  top: 8px;\n  right: 16px;\n  font-size: 18px;\n}\n\n\n\n.accountBtn {\n    display: flex;\n    justify-content: space-around;\n    background-color: #f44336; /* Red */\n    border: #f000000;\n    color: white;\n    padding: 15px 32px;\n    text-align: center;\n    text-decoration: none;\n    display: inline-block;\n    font-size: 16px;\n    margin: 4px 2px;\n    cursor: pointer;\n\n}\n\n/* On mouse-over */\n.accountBtn:hover {\n  color: #f1f1f1;\n}\n\n/* Clear floats after the header */\n.header:after {\n  content: \"\";\n  display: table;\n  clear: both;\n}\n\n\ninput[type=text] {\n  margin-left:40%;\n  width: 200px;\n  box-sizing: border-box;\n  border: 2px solid #ccc;\n  border-radius: 4px;\n  font-size: 16px;\n  background-color: white;\n  background-position: 10px 10px; \n  background-repeat: no-repeat;\n  padding: 12px 20px 12px 40px;\n  -webkit-transition: width 0.4s ease-in-out;\n  transition: width 0.4s ease-in-out;\n}\n\ninput[type=text]:focus {\n  width: 30%;\n}\n\n\n.searchBtn {\n    display: flex;\n    justify-content: space-around;\n    background-color: #818181;\n    border: #f000000;\n    color: white;\n    padding: 15px 32px;\n    text-align: center;\n    text-decoration: none;\n    display: inline-block;\n    font-size: 16px;\n    margin: 4px 2px;\n    cursor: pointer;\n\n}\n\n/* On mouse-over */\n.searchBtn:hover {\n  color: #f1f1f1;\n}\n\n.pageBtn {\n    justify-content: center;\n    background-color: #818181;\n    border: #f000000;\n    color: white;\n    padding: 15px 32px;\n    text-align: center;\n    text-decoration: none;\n    display:none;\n    font-size: 16px;\n    margin: 4px 2px;\n    cursor: pointer;\n    margin-left: auto;\n}\n\n/* On mouse-over */\n.pageBtn:hover {\n  color: #f1f1f1;\n}\n\n\n\n/* landin Main content */\n.main {\n  margin-left: 200px; /* Same as the width of the sidenav */\n  font-size: 20px; /* Increased text to enable scrolling */\n  padding: 0px 10px;\n\n}\n\n/* Fixed sidenav, full height */\n.sidenav {\n  height: 100%;\n  width: 200px;\n  position: fixed;\n  z-index: 1;\n  top: 0;\n  left: 0;\n  background-color: #111;\n  overflow-x: hidden;\n  padding-top: 20px;\n}\n\n/* Style the sidenav links and the dropdown button */\n.sidenav a, .dropdown-btn {\n  padding: 6px 8px 6px 16px;\n  text-decoration: none;\n  font-size: 20px;\n  color: #818181;\n  display: block;\n  border: none;\n  background: none;\n  width: 100%;\n  text-align: left;\n  cursor: pointer;\n  outline: none;\n}\n\n/* On mouse-over */\n.sidenav a:hover, .dropdown-btn:hover {\n  color: #f1f1f1;\n}\n\n\n\n.titleBtn {\n  background-color: #f44336; /* Red */\n  border: none;\n  color: white;\n  padding: 15px 32px;\n  text-align: center;\n  text-decoration: none;\n  display: inline-block;\n  font-size: 16px;\n  margin: 4px 2px;\n  cursor: pointer;\n}\n\n\n.title {\n    color: white;\n    display: flex;\n    justify-content: space-between;\n\n}\n\n/* On mouse-over */\n.title:hover {\n  color: #f1f1f1;\n}\n\n.dropbtn {\n  background-color: #ffad33;\n  color: white;\n  padding: 16px;\n  font-size: 16px;\n  border: none;\n  cursor: pointer;\n}\n\n.dropdown {\n  position: relative;\n  display: inline-block;\n}\n\n.dropdown-content {\n  display: none;\n  position: absolute;\n  background-color: #f9f9f9;\n  min-width: 160px;\n  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n  z-index: 1;\n}\n\n.dropdown-content a {\n  color: black;\n  padding: 12px 16px;\n  text-decoration: none;\n  display: block;\n}\n\n.dropdown-content a:hover {background-color: #f1f1f1}\n\n.dropdown:hover .dropdown-content {\n  display: block;\n}\n\n.dropdown:hover .dropbtn {\n  background-color: #3e8e41;\n}\n\n\n\n#table {\n  font-family: Arial, Helvetica, sans-serif;\n  border-collapse: collapse;\n  width: 100%;\n}\n\n#table td, #table th {\n  border: 2px solid #ddd;\n  padding: 8px;\n\n\n}\n\n#table tr:nth-child(even){background-color: #f2f2f2;}\n\n#table tr:hover {background-color: #ddd;}\n\n#table th {\n  padding-top: 12px;\n  padding-bottom: 12px;\n  text-align: left;\n  background-color: #ffad33;\n  color: white;\n}\na {\n    color: black;\n    text-decoration: none;\n}\n","output":"str","x":330,"y":4640,"wires":[["b60eef95.8d97c"]]},{"id":"168ce276.9799de","type":"http in","z":"c0a64af3.88a468","name":"market template","url":"/market_template.css","method":"get","upload":false,"swaggerDoc":"","x":120,"y":4640,"wires":[["9a550890.307598"]]},{"id":"9bc36b30.4298c8","type":"MySQLdatabase","z":"","host":"127.0.0.1","port":"3306","db":"sdd","tz":""}]
